2025-05-24 10:26:19,688 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:26:19,688 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 10:26:19,709 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-24 10:26:19,709 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-24 10:26:19,716 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-24 10:26:32,066 - phase-viz - INFO - plot_metric:148 - User input: metrics
2025-05-24 10:26:32,091 - phase-viz - INFO - plot_metric:186 - Added metric: L2 Norm
2025-05-24 10:26:36,750 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-24 10:26:36,750 - phase-viz - INFO - plot_metric:210 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 10:26:36,750 - phase-viz - INFO - compute_metrics_over_checkpoints:243 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 10:26:40,140 - phase-viz - ERROR - _process_checkpoint_cpu:145 - Worker error on ../checkpoints\model_0_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 135, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 10:26:40,140 - phase-viz - ERROR - _process_checkpoint_cpu:145 - Worker error on ../checkpoints\model_1_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 135, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 10:26:40,148 - phase-viz - ERROR - _process_checkpoint_cpu:145 - Worker error on ../checkpoints\model_2_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 135, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 10:26:40,148 - phase-viz - ERROR - _process_checkpoint_cpu:145 - Worker error on ../checkpoints\model_3_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 135, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 10:26:40,720 - phase-viz - INFO - plot_metric:250 - Successfully computed all metrics
2025-05-24 10:26:40,788 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-24 10:26:40,788 - phase-viz - INFO - plot_metric:268 - Saved metrics data to state
2025-05-24 10:26:40,791 - phase-viz - INFO - plot_metric:284 - Generating interactive plot
2025-05-24 10:26:40,793 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_102640_aa9szj4w.html
2025-05-24 10:26:40,809 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_102640_aa9szj4w.html
2025-05-24 10:26:40,809 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_102640_aa9szj4w.html
2025-05-24 10:26:40,809 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_102640_aa9szj4w.html
2025-05-24 10:26:46,562 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_102640_aa9szj4w.html
2025-05-24 10:26:46,562 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_102640_aa9szj4w.html
2025-05-24 10:26:46,562 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_102640_aa9szj4w.html
2025-05-24 10:26:46,562 - phase-viz - INFO - plot_metric:290 - Plot generation completed
2025-05-24 10:28:30,972 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:28:45,689 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:29:05,334 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:29:53,050 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:30:02,618 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:30:02,618 - phase-viz - INFO - load_dir:61 - Loading directory: checkpoints
2025-05-24 10:30:02,618 - phase-viz - INFO - load_dir:62 - Model file: arithmetic.py
2025-05-24 10:30:02,618 - phase-viz - INFO - load_dir:63 - Class name: ArithmeticNet
2025-05-24 10:30:02,618 - phase-viz - ERROR - load_dir:70 - The path 'checkpoints' is not a directory.
2025-05-24 10:30:16,978 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:30:16,978 - phase-viz - INFO - load_dir:61 - Loading directory: ./checkpoints
2025-05-24 10:30:16,978 - phase-viz - INFO - load_dir:62 - Model file: arithmetic.py
2025-05-24 10:30:16,978 - phase-viz - INFO - load_dir:63 - Class name: ArithmeticNet
2025-05-24 10:30:16,978 - phase-viz - ERROR - load_dir:70 - The path './checkpoints' is not a directory.
2025-05-24 10:30:25,518 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:30:25,518 - phase-viz - INFO - load_dir:61 - Loading directory: ../checkpoints
2025-05-24 10:30:25,518 - phase-viz - INFO - load_dir:62 - Model file: arithmetic.py
2025-05-24 10:30:25,518 - phase-viz - INFO - load_dir:63 - Class name: ArithmeticNet
2025-05-24 10:30:25,518 - phase-viz - INFO - load_dir:76 - Found 4 checkpoints
2025-05-24 10:30:25,518 - phase-viz - INFO - load_dir:89 - State saved successfully
2025-05-24 10:30:56,513 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:30:56,521 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 10:30:56,533 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-24 10:30:56,533 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-24 10:30:56,535 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-24 10:30:57,701 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-24 10:30:57,701 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-24 10:30:58,594 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-24 10:30:58,594 - phase-viz - INFO - plot_metric:210 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 10:30:58,594 - phase-viz - INFO - compute_metrics_over_checkpoints:243 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 10:31:01,799 - phase-viz - ERROR - _process_checkpoint_cpu:145 - Worker error on ../checkpoints\model_0_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 135, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 10:31:01,799 - phase-viz - ERROR - _process_checkpoint_cpu:145 - Worker error on ../checkpoints\model_1_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 135, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 10:31:01,799 - phase-viz - ERROR - _process_checkpoint_cpu:145 - Worker error on ../checkpoints\model_2_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 135, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 10:31:01,799 - phase-viz - ERROR - _process_checkpoint_cpu:145 - Worker error on ../checkpoints\model_3_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 135, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 10:31:02,333 - phase-viz - INFO - plot_metric:250 - Successfully computed all metrics
2025-05-24 10:31:02,424 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-24 10:31:02,424 - phase-viz - INFO - plot_metric:268 - Saved metrics data to state
2025-05-24 10:31:02,427 - phase-viz - INFO - plot_metric:284 - Generating interactive plot
2025-05-24 10:31:02,427 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103102_55nhuy3a.html
2025-05-24 10:31:02,427 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103102_55nhuy3a.html
2025-05-24 10:31:02,427 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103102_55nhuy3a.html
2025-05-24 10:31:02,429 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103102_55nhuy3a.html
2025-05-24 10:31:19,046 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103102_55nhuy3a.html
2025-05-24 10:31:19,046 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103102_55nhuy3a.html
2025-05-24 10:31:19,046 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103102_55nhuy3a.html
2025-05-24 10:31:19,046 - phase-viz - INFO - plot_metric:290 - Plot generation completed
2025-05-24 10:37:12,194 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:37:45,638 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:38:10,008 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:38:10,008 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=False
2025-05-24 10:38:10,008 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-24 10:38:10,008 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-24 10:38:10,024 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-24 10:38:11,562 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-24 10:38:11,562 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-24 10:38:12,088 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-24 10:38:12,088 - phase-viz - INFO - plot_metric:210 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 10:38:12,095 - phase-viz - INFO - compute_metrics_over_checkpoints:279 - Processing checkpoints sequentially
2025-05-24 10:38:12,254 - phase-viz - INFO - plot_metric:250 - Successfully computed all metrics
2025-05-24 10:38:12,298 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-24 10:38:12,299 - phase-viz - INFO - plot_metric:268 - Saved metrics data to state
2025-05-24 10:38:12,302 - phase-viz - INFO - plot_metric:284 - Generating interactive plot
2025-05-24 10:38:12,302 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103812_qe3t819v.html
2025-05-24 10:38:12,302 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103812_qe3t819v.html
2025-05-24 10:38:12,302 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103812_qe3t819v.html
2025-05-24 10:38:12,302 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103812_qe3t819v.html
2025-05-24 10:38:21,146 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103812_qe3t819v.html
2025-05-24 10:38:21,146 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103812_qe3t819v.html
2025-05-24 10:38:21,146 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_103812_qe3t819v.html
2025-05-24 10:38:21,146 - phase-viz - INFO - plot_metric:290 - Plot generation completed
2025-05-24 10:40:11,121 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:40:11,121 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=False
2025-05-24 10:40:11,137 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-24 10:40:11,137 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-24 10:40:11,137 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-24 10:40:32,017 - phase-viz - INFO - plot_metric:148 - User input: custom-metrics
2025-05-24 10:40:32,017 - phase-viz - WARNING - plot_metric:205 - Unknown metric: custom-metrics
2025-05-24 10:40:36,049 - phase-viz - INFO - plot_metric:148 - User input: custom-metrics.py
2025-05-24 10:40:36,049 - phase-viz - WARNING - plot_metric:205 - Unknown metric: custom-metrics.py
2025-05-24 10:40:43,195 - phase-viz - INFO - plot_metric:148 - User input: custom_metrics.py
2025-05-24 10:40:43,207 - phase-viz - INFO - plot_metric:186 - Added metric: Parameter Variance
2025-05-24 10:40:43,209 - phase-viz - INFO - plot_metric:186 - Added metric: Layer Wise Norm Ratio
2025-05-24 10:40:43,209 - phase-viz - INFO - plot_metric:186 - Added metric: Activation Capacity
2025-05-24 10:40:43,211 - phase-viz - INFO - plot_metric:186 - Added metric: Dead Neuron Percentage
2025-05-24 10:40:43,211 - phase-viz - INFO - plot_metric:186 - Added metric: Weight Rank
2025-05-24 10:40:43,212 - phase-viz - INFO - plot_metric:186 - Added metric: Gradient Flow Score
2025-05-24 10:40:45,025 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-24 10:40:45,026 - phase-viz - INFO - plot_metric:210 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 10:40:45,026 - phase-viz - INFO - compute_metrics_over_checkpoints:279 - Processing checkpoints sequentially
2025-05-24 10:40:45,234 - phase-viz - INFO - plot_metric:250 - Successfully computed all metrics
2025-05-24 10:40:45,331 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-24 10:40:45,333 - phase-viz - INFO - plot_metric:268 - Saved metrics data to state
2025-05-24 10:40:45,333 - phase-viz - INFO - plot_metric:284 - Generating interactive plot
2025-05-24 10:40:45,337 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104045_c3hg6f6z.html
2025-05-24 10:40:45,338 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104045_c3hg6f6z.html
2025-05-24 10:40:45,338 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104045_c3hg6f6z.html
2025-05-24 10:40:45,338 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104045_c3hg6f6z.html
2025-05-24 10:42:28,058 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104045_c3hg6f6z.html
2025-05-24 10:42:28,058 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104045_c3hg6f6z.html
2025-05-24 10:42:28,058 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104045_c3hg6f6z.html
2025-05-24 10:42:28,058 - phase-viz - INFO - plot_metric:290 - Plot generation completed
2025-05-24 10:43:44,787 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:43:44,787 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=False
2025-05-24 10:43:44,803 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-24 10:43:44,803 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-24 10:43:44,804 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-24 10:43:51,015 - phase-viz - INFO - plot_metric:148 - User input: custom_metrics.py
2025-05-24 10:43:51,015 - phase-viz - INFO - plot_metric:186 - Added metric: Parameter Variance
2025-05-24 10:43:51,015 - phase-viz - INFO - plot_metric:186 - Added metric: Layer Wise Norm Ratio
2025-05-24 10:43:51,015 - phase-viz - INFO - plot_metric:186 - Added metric: Activation Capacity
2025-05-24 10:43:51,015 - phase-viz - INFO - plot_metric:186 - Added metric: Dead Neuron Percentage
2025-05-24 10:43:51,015 - phase-viz - INFO - plot_metric:186 - Added metric: Weight Rank
2025-05-24 10:43:51,024 - phase-viz - INFO - plot_metric:186 - Added metric: Gradient Flow Score
2025-05-24 10:43:51,940 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-24 10:43:51,940 - phase-viz - INFO - plot_metric:210 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 10:43:51,943 - phase-viz - INFO - compute_metrics_over_checkpoints:279 - Processing checkpoints sequentially
2025-05-24 10:43:52,052 - phase-viz - INFO - plot_metric:250 - Successfully computed all metrics
2025-05-24 10:43:52,145 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-24 10:43:52,145 - phase-viz - INFO - plot_metric:268 - Saved metrics data to state
2025-05-24 10:43:52,151 - phase-viz - INFO - plot_metric:284 - Generating interactive plot
2025-05-24 10:43:52,151 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104352_sz7xr3tb.html
2025-05-24 10:43:52,157 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104352_sz7xr3tb.html
2025-05-24 10:43:52,157 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104352_sz7xr3tb.html
2025-05-24 10:43:52,157 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104352_sz7xr3tb.html
2025-05-24 10:44:07,637 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104352_sz7xr3tb.html
2025-05-24 10:44:07,637 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104352_sz7xr3tb.html
2025-05-24 10:44:07,638 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_104352_sz7xr3tb.html
2025-05-24 10:44:07,638 - phase-viz - INFO - plot_metric:290 - Plot generation completed
2025-05-24 10:53:11,505 - phase-viz - INFO - <module>:304 - Starting phase-viz CLI
2025-05-24 10:53:11,505 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=False
2025-05-24 10:53:11,505 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-24 10:53:11,505 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-24 10:53:11,505 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-24 10:53:16,383 - phase-viz - INFO - plot_metric:148 - User input: custom_metrics.py
2025-05-24 10:53:16,392 - phase-viz - INFO - plot_metric:186 - Added metric: Parameter Variance
2025-05-24 10:53:16,392 - phase-viz - INFO - plot_metric:186 - Added metric: Layer Wise Norm Ratio
2025-05-24 10:53:16,392 - phase-viz - INFO - plot_metric:186 - Added metric: Activation Capacity
2025-05-24 10:53:16,392 - phase-viz - INFO - plot_metric:186 - Added metric: Dead Neuron Percentage
2025-05-24 10:53:16,397 - phase-viz - INFO - plot_metric:186 - Added metric: Weight Rank
2025-05-24 10:53:16,398 - phase-viz - INFO - plot_metric:186 - Added metric: Gradient Flow Score
2025-05-24 10:53:18,606 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-24 10:53:18,606 - phase-viz - INFO - plot_metric:210 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 10:53:18,606 - phase-viz - INFO - compute_metrics_over_checkpoints:279 - Processing checkpoints sequentially
2025-05-24 10:53:18,724 - phase-viz - INFO - plot_metric:250 - Successfully computed all metrics
2025-05-24 10:53:18,816 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-24 10:53:18,816 - phase-viz - INFO - plot_metric:268 - Saved metrics data to state
2025-05-24 10:53:18,823 - phase-viz - INFO - plot_metric:284 - Generating interactive plot
2025-05-24 10:53:18,823 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_105318_bicd4h04.html
2025-05-24 10:53:18,824 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_105318_bicd4h04.html
2025-05-24 10:53:18,824 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_105318_bicd4h04.html
2025-05-24 10:53:18,826 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_105318_bicd4h04.html
2025-05-24 10:54:12,670 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_105318_bicd4h04.html
2025-05-24 10:54:12,670 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_105318_bicd4h04.html
2025-05-24 10:54:12,670 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_105318_bicd4h04.html
2025-05-24 10:54:12,670 - phase-viz - INFO - plot_metric:290 - Plot generation completed
2025-05-24 11:18:37,844 - phase-viz - INFO - <module>:306 - Starting phase-viz CLI
2025-05-24 11:18:37,850 - phase-viz - INFO - plot_metric:106 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:18:37,850 - phase-viz - INFO - plot_metric:110 - State loaded successfully
2025-05-24 11:18:37,850 - phase-viz - WARNING - plot_metric:119 - CUDA requested but not available, falling back to CPU
2025-05-24 11:18:37,850 - phase-viz - INFO - plot_metric:130 - Running on CPU
2025-05-24 11:18:48,467 - phase-viz - INFO - plot_metric:150 - User input: custom_metrics.py
2025-05-24 11:18:48,467 - phase-viz - INFO - plot_metric:188 - Added metric: Parameter Variance
2025-05-24 11:18:48,467 - phase-viz - INFO - plot_metric:188 - Added metric: Layer Wise Norm Ratio
2025-05-24 11:18:48,482 - phase-viz - INFO - plot_metric:188 - Added metric: Activation Capacity
2025-05-24 11:18:48,482 - phase-viz - INFO - plot_metric:188 - Added metric: Dead Neuron Percentage
2025-05-24 11:18:48,484 - phase-viz - INFO - plot_metric:188 - Added metric: Weight Rank
2025-05-24 11:18:48,485 - phase-viz - INFO - plot_metric:188 - Added metric: Gradient Flow Score
2025-05-24 11:18:55,668 - phase-viz - INFO - plot_metric:150 - User input: done
2025-05-24 11:18:55,668 - phase-viz - INFO - plot_metric:212 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 11:18:55,674 - phase-viz - INFO - compute_metrics_over_checkpoints:251 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:18:59,149 - phase-viz - ERROR - compute_metrics_over_checkpoints:283 - Error in parallel processing: too many values to unpack (expected 4)
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 127, in _process_checkpoint_cpu
    idx, path, metric_names, device = args
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 4)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 264, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
ValueError: too many values to unpack (expected 4)
2025-05-24 11:18:59,166 - phase-viz - ERROR - compute_metrics_over_checkpoints:283 - Error in parallel processing: too many values to unpack (expected 4)
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 127, in _process_checkpoint_cpu
    idx, path, metric_names, device = args
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 4)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 264, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
ValueError: too many values to unpack (expected 4)
2025-05-24 11:18:59,166 - phase-viz - ERROR - compute_metrics_over_checkpoints:283 - Error in parallel processing: too many values to unpack (expected 4)
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 127, in _process_checkpoint_cpu
    idx, path, metric_names, device = args
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 4)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 264, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
ValueError: too many values to unpack (expected 4)
2025-05-24 11:18:59,166 - phase-viz - ERROR - compute_metrics_over_checkpoints:283 - Error in parallel processing: too many values to unpack (expected 4)
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 127, in _process_checkpoint_cpu
    idx, path, metric_names, device = args
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 4)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 264, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
ValueError: too many values to unpack (expected 4)
2025-05-24 11:18:59,765 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-24 11:18:59,812 - phase-viz - INFO - plot_metric:265 - Cleared model and metric caches
2025-05-24 11:18:59,812 - phase-viz - INFO - plot_metric:270 - Saved metrics data to state
2025-05-24 11:18:59,815 - phase-viz - INFO - plot_metric:286 - Generating interactive plot
2025-05-24 11:18:59,815 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_111859_lkzmzlqi.html
2025-05-24 11:18:59,818 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_111859_lkzmzlqi.html
2025-05-24 11:18:59,818 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_111859_lkzmzlqi.html
2025-05-24 11:18:59,818 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_111859_lkzmzlqi.html
2025-05-24 11:19:11,400 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_111859_lkzmzlqi.html
2025-05-24 11:19:11,400 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_111859_lkzmzlqi.html
2025-05-24 11:19:11,400 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_111859_lkzmzlqi.html
2025-05-24 11:19:11,400 - phase-viz - INFO - plot_metric:292 - Plot generation completed
2025-05-24 11:23:25,842 - phase-viz - INFO - <module>:306 - Starting phase-viz CLI
2025-05-24 11:23:25,858 - phase-viz - INFO - plot_metric:106 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:23:25,870 - phase-viz - INFO - plot_metric:110 - State loaded successfully
2025-05-24 11:23:25,870 - phase-viz - WARNING - plot_metric:119 - CUDA requested but not available, falling back to CPU
2025-05-24 11:23:25,874 - phase-viz - INFO - plot_metric:130 - Running on CPU
2025-05-24 11:23:38,808 - phase-viz - INFO - plot_metric:150 - User input: custom_metrics.py
2025-05-24 11:23:38,808 - phase-viz - INFO - plot_metric:188 - Added metric: Parameter Variance
2025-05-24 11:23:38,808 - phase-viz - INFO - plot_metric:188 - Added metric: Layer Wise Norm Ratio
2025-05-24 11:23:38,824 - phase-viz - INFO - plot_metric:188 - Added metric: Activation Capacity
2025-05-24 11:23:38,826 - phase-viz - INFO - plot_metric:188 - Added metric: Dead Neuron Percentage
2025-05-24 11:23:38,828 - phase-viz - INFO - plot_metric:188 - Added metric: Weight Rank
2025-05-24 11:23:38,828 - phase-viz - INFO - plot_metric:188 - Added metric: Gradient Flow Score
2025-05-24 11:23:40,829 - phase-viz - INFO - plot_metric:150 - User input: done
2025-05-24 11:23:40,829 - phase-viz - INFO - plot_metric:212 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 11:23:40,841 - phase-viz - INFO - compute_metrics_over_checkpoints:251 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:23:43,932 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_0_base adam_results.pt: No metric functions resolved inside worker.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 138, in _process_checkpoint_cpu
    raise RuntimeError("No metric functions resolved inside worker.")
RuntimeError: No metric functions resolved inside worker.
2025-05-24 11:23:43,932 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_2_pgd_results.pt: No metric functions resolved inside worker.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 138, in _process_checkpoint_cpu
    raise RuntimeError("No metric functions resolved inside worker.")
RuntimeError: No metric functions resolved inside worker.
2025-05-24 11:23:43,932 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_1_base adam_results.pt: No metric functions resolved inside worker.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 138, in _process_checkpoint_cpu
    raise RuntimeError("No metric functions resolved inside worker.")
RuntimeError: No metric functions resolved inside worker.
2025-05-24 11:23:43,932 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_3_pgd_results.pt: No metric functions resolved inside worker.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 138, in _process_checkpoint_cpu
    raise RuntimeError("No metric functions resolved inside worker.")
RuntimeError: No metric functions resolved inside worker.
2025-05-24 11:23:44,375 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-24 11:23:44,470 - phase-viz - INFO - plot_metric:265 - Cleared model and metric caches
2025-05-24 11:23:44,470 - phase-viz - INFO - plot_metric:270 - Saved metrics data to state
2025-05-24 11:23:44,474 - phase-viz - INFO - plot_metric:286 - Generating interactive plot
2025-05-24 11:23:44,476 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112344_61iqx48w.html
2025-05-24 11:23:44,477 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112344_61iqx48w.html
2025-05-24 11:23:44,477 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112344_61iqx48w.html
2025-05-24 11:23:44,478 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112344_61iqx48w.html
2025-05-24 11:23:48,491 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112344_61iqx48w.html
2025-05-24 11:23:48,492 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112344_61iqx48w.html
2025-05-24 11:23:48,492 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112344_61iqx48w.html
2025-05-24 11:23:48,493 - phase-viz - INFO - plot_metric:292 - Plot generation completed
2025-05-24 11:26:29,567 - phase-viz - INFO - <module>:306 - Starting phase-viz CLI
2025-05-24 11:26:29,567 - phase-viz - INFO - plot_metric:106 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:26:29,583 - phase-viz - INFO - plot_metric:110 - State loaded successfully
2025-05-24 11:26:29,583 - phase-viz - WARNING - plot_metric:119 - CUDA requested but not available, falling back to CPU
2025-05-24 11:26:29,583 - phase-viz - INFO - plot_metric:130 - Running on CPU
2025-05-24 11:26:30,218 - phase-viz - INFO - plot_metric:150 - User input: l2
2025-05-24 11:26:30,218 - phase-viz - INFO - plot_metric:202 - Added metric: L2 Norm
2025-05-24 11:26:39,067 - phase-viz - INFO - plot_metric:150 - User input: done
2025-05-24 11:26:39,067 - phase-viz - INFO - plot_metric:212 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 11:26:39,071 - phase-viz - INFO - compute_metrics_over_checkpoints:251 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:26:41,998 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_0_base adam_results.pt: name 'device' is not defined
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                                                                  ^^^^^^
NameError: name 'device' is not defined. Did you mean: 'devic'?
2025-05-24 11:26:41,998 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_1_base adam_results.pt: name 'device' is not defined
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                                                                  ^^^^^^
NameError: name 'device' is not defined. Did you mean: 'devic'?
2025-05-24 11:26:42,000 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_2_pgd_results.pt: name 'device' is not defined
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                                                                  ^^^^^^
NameError: name 'device' is not defined. Did you mean: 'devic'?
2025-05-24 11:26:42,000 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_3_pgd_results.pt: name 'device' is not defined
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                                                                  ^^^^^^
NameError: name 'device' is not defined. Did you mean: 'devic'?
2025-05-24 11:26:42,462 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-24 11:26:42,495 - phase-viz - INFO - plot_metric:265 - Cleared model and metric caches
2025-05-24 11:26:42,495 - phase-viz - INFO - plot_metric:270 - Saved metrics data to state
2025-05-24 11:26:42,495 - phase-viz - INFO - plot_metric:286 - Generating interactive plot
2025-05-24 11:26:42,495 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112642_bd5ac8hq.html
2025-05-24 11:26:42,499 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112642_bd5ac8hq.html
2025-05-24 11:26:42,499 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112642_bd5ac8hq.html
2025-05-24 11:26:42,499 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112642_bd5ac8hq.html
2025-05-24 11:27:48,111 - phase-viz - INFO - <module>:306 - Starting phase-viz CLI
2025-05-24 11:27:54,970 - phase-viz - INFO - <module>:306 - Starting phase-viz CLI
2025-05-24 11:27:54,970 - phase-viz - INFO - plot_metric:106 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:27:54,980 - phase-viz - INFO - plot_metric:110 - State loaded successfully
2025-05-24 11:27:54,980 - phase-viz - WARNING - plot_metric:119 - CUDA requested but not available, falling back to CPU
2025-05-24 11:27:54,980 - phase-viz - INFO - plot_metric:130 - Running on CPU
2025-05-24 11:27:56,432 - phase-viz - INFO - plot_metric:150 - User input: l2
2025-05-24 11:27:56,432 - phase-viz - INFO - plot_metric:202 - Added metric: L2 Norm
2025-05-24 11:27:56,853 - phase-viz - INFO - plot_metric:150 - User input: done
2025-05-24 11:27:56,853 - phase-viz - INFO - plot_metric:212 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 11:27:56,861 - phase-viz - INFO - compute_metrics_over_checkpoints:251 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:27:59,749 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_0_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:27:59,749 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_1_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:27:59,749 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_3_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:27:59,749 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_2_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:28:00,234 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-24 11:28:00,287 - phase-viz - INFO - plot_metric:265 - Cleared model and metric caches
2025-05-24 11:28:00,287 - phase-viz - INFO - plot_metric:270 - Saved metrics data to state
2025-05-24 11:28:00,293 - phase-viz - INFO - plot_metric:286 - Generating interactive plot
2025-05-24 11:28:00,293 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112800_otlfeha5.html
2025-05-24 11:28:00,293 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112800_otlfeha5.html
2025-05-24 11:28:00,293 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112800_otlfeha5.html
2025-05-24 11:28:00,295 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_112800_otlfeha5.html
2025-05-24 11:31:19,775 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 11:31:19,775 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:31:19,775 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 11:31:19,775 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 11:31:19,775 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 11:31:20,802 - phase-viz - INFO - plot_metric:151 - User input: l2
2025-05-24 11:31:20,802 - phase-viz - INFO - plot_metric:204 - Added metric: L2 Norm
2025-05-24 11:31:21,444 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 11:31:21,444 - phase-viz - INFO - plot_metric:214 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 11:31:21,447 - phase-viz - INFO - compute_metrics_over_checkpoints:251 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:31:24,307 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_0_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:31:24,307 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_2_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:31:24,307 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_1_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:31:24,307 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_3_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:31:24,796 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 11:31:24,871 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 11:31:24,873 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 11:31:24,878 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 11:31:24,878 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113124_9n3pcz1v.html
2025-05-24 11:31:24,879 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113124_9n3pcz1v.html
2025-05-24 11:31:24,879 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113124_9n3pcz1v.html
2025-05-24 11:31:24,880 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113124_9n3pcz1v.html
2025-05-24 11:31:26,874 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113124_9n3pcz1v.html
2025-05-24 11:31:26,874 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113124_9n3pcz1v.html
2025-05-24 11:31:26,874 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113124_9n3pcz1v.html
2025-05-24 11:31:26,874 - phase-viz - INFO - plot_metric:295 - Plot generation completed
2025-05-24 11:39:49,079 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 11:39:49,079 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:39:49,079 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 11:39:49,079 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 11:39:49,079 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 11:39:53,621 - phase-viz - INFO - plot_metric:151 - User input: l2
2025-05-24 11:39:53,621 - phase-viz - INFO - plot_metric:204 - Added metric: L2 Norm
2025-05-24 11:39:54,176 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 11:39:54,176 - phase-viz - INFO - plot_metric:214 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 11:39:54,179 - phase-viz - INFO - compute_metrics_over_checkpoints:251 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:39:57,104 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_0_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:39:57,105 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_2_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:39:57,105 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_3_pgd_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:39:57,105 - phase-viz - ERROR - _process_checkpoint_cpu:151 - Worker error on ../checkpoints\model_1_base adam_results.pt: Model class not loaded. Call load_model_class first.
Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 141, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 102, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\load_models.py", line 169, in load_model_from_checkpoint
    raise RuntimeError("Model class not loaded. Call load_model_class first.")
RuntimeError: Model class not loaded. Call load_model_class first.
2025-05-24 11:39:57,573 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 11:39:57,602 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 11:39:57,603 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 11:39:57,607 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 11:39:57,608 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113957_ea5gdjb9.html
2025-05-24 11:39:57,608 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113957_ea5gdjb9.html
2025-05-24 11:39:57,608 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113957_ea5gdjb9.html
2025-05-24 11:39:57,609 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113957_ea5gdjb9.html
2025-05-24 11:39:59,811 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113957_ea5gdjb9.html
2025-05-24 11:39:59,811 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113957_ea5gdjb9.html
2025-05-24 11:39:59,811 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_113957_ea5gdjb9.html
2025-05-24 11:39:59,811 - phase-viz - INFO - plot_metric:295 - Plot generation completed
2025-05-24 11:49:37,034 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 11:49:37,036 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:49:37,037 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 11:49:37,037 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 11:49:37,039 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 11:49:38,711 - phase-viz - INFO - plot_metric:151 - User input: l2
2025-05-24 11:49:38,711 - phase-viz - INFO - plot_metric:204 - Added metric: L2 Norm
2025-05-24 11:49:39,250 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 11:49:39,251 - phase-viz - INFO - plot_metric:214 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 11:49:39,252 - phase-viz - INFO - compute_metrics_over_checkpoints:254 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:49:42,557 - phase-viz - ERROR - compute_metrics_over_checkpoints:286 - Error in parallel processing: cannot access local variable '_model_class' where it is not associated with a value
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 129, in _process_checkpoint_cpu
    if _model_class is None:
       ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 267, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
2025-05-24 11:49:42,560 - phase-viz - ERROR - compute_metrics_over_checkpoints:286 - Error in parallel processing: cannot access local variable '_model_class' where it is not associated with a value
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 129, in _process_checkpoint_cpu
    if _model_class is None:
       ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 267, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
2025-05-24 11:49:42,561 - phase-viz - ERROR - compute_metrics_over_checkpoints:286 - Error in parallel processing: cannot access local variable '_model_class' where it is not associated with a value
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 129, in _process_checkpoint_cpu
    if _model_class is None:
       ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 267, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
2025-05-24 11:49:42,561 - phase-viz - ERROR - compute_metrics_over_checkpoints:286 - Error in parallel processing: cannot access local variable '_model_class' where it is not associated with a value
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 129, in _process_checkpoint_cpu
    if _model_class is None:
       ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 267, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
2025-05-24 11:49:43,169 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 11:49:43,177 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 11:49:43,178 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 11:49:43,181 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 11:49:43,182 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_114943_5tramvx4.html
2025-05-24 11:49:43,183 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_114943_5tramvx4.html
2025-05-24 11:49:43,183 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_114943_5tramvx4.html
2025-05-24 11:49:43,184 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_114943_5tramvx4.html
2025-05-24 11:51:27,438 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 11:51:34,511 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 11:51:34,511 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:51:34,527 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 11:51:34,527 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 11:51:34,527 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 11:51:36,399 - phase-viz - INFO - plot_metric:151 - User input: l2
2025-05-24 11:51:36,399 - phase-viz - INFO - plot_metric:204 - Added metric: L2 Norm
2025-05-24 11:51:37,243 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 11:51:37,243 - phase-viz - INFO - plot_metric:214 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 11:51:37,246 - phase-viz - INFO - compute_metrics_over_checkpoints:255 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:51:40,552 - phase-viz - ERROR - compute_metrics_over_checkpoints:287 - Error in parallel processing: cannot access local variable '_model_class' where it is not associated with a value
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 129, in _process_checkpoint_cpu
    if _model_class is None:
       ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 268, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
2025-05-24 11:51:40,554 - phase-viz - ERROR - compute_metrics_over_checkpoints:287 - Error in parallel processing: cannot access local variable '_model_class' where it is not associated with a value
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 129, in _process_checkpoint_cpu
    if _model_class is None:
       ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 268, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
2025-05-24 11:51:40,554 - phase-viz - ERROR - compute_metrics_over_checkpoints:287 - Error in parallel processing: cannot access local variable '_model_class' where it is not associated with a value
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 129, in _process_checkpoint_cpu
    if _model_class is None:
       ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 268, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
2025-05-24 11:51:40,555 - phase-viz - ERROR - compute_metrics_over_checkpoints:287 - Error in parallel processing: cannot access local variable '_model_class' where it is not associated with a value
concurrent.futures.process._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\process.py", line 263, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 129, in _process_checkpoint_cpu
    if _model_class is None:
       ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\samue\Documents\phase_viz\src\metrics.py", line 268, in compute_metrics_over_checkpoints
    result = future.result()
             ^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\samue\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
UnboundLocalError: cannot access local variable '_model_class' where it is not associated with a value
2025-05-24 11:51:41,071 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 11:51:41,073 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 11:51:41,075 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 11:51:41,079 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 11:51:41,079 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115141_x3h7nb4k.html
2025-05-24 11:51:41,080 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115141_x3h7nb4k.html
2025-05-24 11:51:41,080 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115141_x3h7nb4k.html
2025-05-24 11:51:41,081 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115141_x3h7nb4k.html
2025-05-24 11:51:43,736 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115141_x3h7nb4k.html
2025-05-24 11:51:43,736 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115141_x3h7nb4k.html
2025-05-24 11:51:43,736 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115141_x3h7nb4k.html
2025-05-24 11:51:43,736 - phase-viz - INFO - plot_metric:295 - Plot generation completed
2025-05-24 11:53:39,099 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 11:53:39,099 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:53:39,107 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 11:53:39,107 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 11:53:39,107 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 11:53:39,767 - phase-viz - INFO - plot_metric:151 - User input: l2
2025-05-24 11:53:39,767 - phase-viz - INFO - plot_metric:204 - Added metric: L2 Norm
2025-05-24 11:53:40,611 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 11:53:40,611 - phase-viz - INFO - plot_metric:214 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 11:53:40,611 - phase-viz - INFO - compute_metrics_over_checkpoints:258 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:53:44,660 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 11:53:44,759 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 11:53:44,760 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 11:53:44,764 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 11:53:44,764 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115344_tk81xo8i.html
2025-05-24 11:53:44,764 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115344_tk81xo8i.html
2025-05-24 11:53:44,764 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115344_tk81xo8i.html
2025-05-24 11:53:44,764 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115344_tk81xo8i.html
2025-05-24 11:53:54,659 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115344_tk81xo8i.html
2025-05-24 11:53:54,659 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115344_tk81xo8i.html
2025-05-24 11:53:54,659 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115344_tk81xo8i.html
2025-05-24 11:53:54,659 - phase-viz - INFO - plot_metric:295 - Plot generation completed
2025-05-24 11:54:10,736 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 11:54:10,738 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 11:54:10,750 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 11:54:10,750 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 11:54:10,750 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 11:54:13,660 - phase-viz - INFO - plot_metric:151 - User input: custom_metrics
2025-05-24 11:54:13,660 - phase-viz - INFO - plot_metric:190 - Added metric: Parameter Variance
2025-05-24 11:54:13,660 - phase-viz - INFO - plot_metric:190 - Added metric: Layer Wise Norm Ratio
2025-05-24 11:54:13,660 - phase-viz - INFO - plot_metric:190 - Added metric: Activation Capacity
2025-05-24 11:54:13,660 - phase-viz - INFO - plot_metric:190 - Added metric: Dead Neuron Percentage
2025-05-24 11:54:13,660 - phase-viz - INFO - plot_metric:190 - Added metric: Weight Rank
2025-05-24 11:54:13,668 - phase-viz - INFO - plot_metric:190 - Added metric: Gradient Flow Score
2025-05-24 11:54:14,309 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 11:54:14,309 - phase-viz - INFO - plot_metric:214 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 11:54:14,316 - phase-viz - INFO - compute_metrics_over_checkpoints:258 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 11:54:18,209 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 11:54:18,245 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 11:54:18,246 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 11:54:18,249 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 11:54:18,251 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115418_sol2gr2g.html
2025-05-24 11:54:18,252 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115418_sol2gr2g.html
2025-05-24 11:54:18,252 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115418_sol2gr2g.html
2025-05-24 11:54:18,254 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115418_sol2gr2g.html
2025-05-24 11:54:33,531 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115418_sol2gr2g.html
2025-05-24 11:54:33,531 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115418_sol2gr2g.html
2025-05-24 11:54:33,531 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for C:\Users\samue\Documents\phase_viz\src\metrics_over_checkpoints_20250524_115418_sol2gr2g.html
2025-05-24 11:54:33,533 - phase-viz - INFO - plot_metric:295 - Plot generation completed
2025-05-24 17:05:42,142 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:05:42,143 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:05:42,143 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 17:05:42,284 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 17:05:42,284 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 17:06:03,436 - phase-viz - INFO - plot_metric:151 - User input: custom-metrics.py
2025-05-24 17:06:03,436 - phase-viz - WARNING - plot_metric:209 - Unknown metric: custom-metrics.py
2025-05-24 17:06:09,011 - phase-viz - INFO - plot_metric:151 - User input: custom_metrics.py
2025-05-24 17:06:09,013 - phase-viz - INFO - plot_metric:190 - Added metric: Parameter Variance
2025-05-24 17:06:09,013 - phase-viz - INFO - plot_metric:190 - Added metric: Layer Wise Norm Ratio
2025-05-24 17:06:09,013 - phase-viz - INFO - plot_metric:190 - Added metric: Activation Capacity
2025-05-24 17:06:09,013 - phase-viz - INFO - plot_metric:190 - Added metric: Dead Neuron Percentage
2025-05-24 17:06:09,013 - phase-viz - INFO - plot_metric:190 - Added metric: Weight Rank
2025-05-24 17:06:09,013 - phase-viz - INFO - plot_metric:190 - Added metric: Gradient Flow Score
2025-05-24 17:06:11,483 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 17:06:11,483 - phase-viz - INFO - plot_metric:214 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 17:06:11,484 - phase-viz - INFO - compute_metrics_over_checkpoints:258 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:06:12,441 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 17:06:12,489 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 17:06:12,490 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 17:06:12,490 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 17:06:12,490 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170612_qa2wtjjq.html
2025-05-24 17:06:12,490 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170612_qa2wtjjq.html
2025-05-24 17:06:12,490 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170612_qa2wtjjq.html
2025-05-24 17:06:12,490 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170612_qa2wtjjq.html
2025-05-24 17:07:10,746 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170612_qa2wtjjq.html
2025-05-24 17:07:10,746 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170612_qa2wtjjq.html
2025-05-24 17:07:10,746 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170612_qa2wtjjq.html
2025-05-24 17:07:10,746 - phase-viz - INFO - plot_metric:295 - Plot generation completed
2025-05-24 17:07:24,176 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:07:24,177 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:07:24,177 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 17:07:24,316 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 17:07:24,316 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 17:07:29,172 - phase-viz - INFO - plot_metric:151 - User input: l2
2025-05-24 17:07:29,172 - phase-viz - INFO - plot_metric:204 - Added metric: L2 Norm
2025-05-24 17:07:32,380 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 17:07:32,380 - phase-viz - INFO - plot_metric:214 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 17:07:32,380 - phase-viz - INFO - compute_metrics_over_checkpoints:258 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:07:32,425 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 17:07:32,480 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 17:07:32,481 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 17:07:32,481 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 17:07:32,481 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170732_f0b7hiui.html
2025-05-24 17:07:32,481 - phase-viz - INFO - start:236 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170732_f0b7hiui.html
2025-05-24 17:07:32,481 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170732_f0b7hiui.html
2025-05-24 17:07:32,481 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170732_f0b7hiui.html
2025-05-24 17:07:47,107 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170732_f0b7hiui.html
2025-05-24 17:07:47,107 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170732_f0b7hiui.html
2025-05-24 17:07:47,107 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170732_f0b7hiui.html
2025-05-24 17:07:47,107 - phase-viz - INFO - plot_metric:295 - Plot generation completed
2025-05-24 17:08:39,789 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:08:47,997 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:08:52,772 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:08:57,141 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:09:03,924 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:09:03,925 - phase-viz - INFO - load_dir:63 - Loading directory: ../checkpoints
2025-05-24 17:09:03,925 - phase-viz - INFO - load_dir:64 - Model file: arithmetic.py
2025-05-24 17:09:03,925 - phase-viz - INFO - load_dir:65 - Class name: ArithmeticNet
2025-05-24 17:09:03,925 - phase-viz - INFO - load_dir:78 - Found 4 checkpoints
2025-05-24 17:09:03,926 - phase-viz - INFO - load_dir:91 - State saved successfully
2025-05-24 17:09:15,868 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:09:15,868 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:09:15,868 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 17:09:16,007 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 17:09:16,008 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 17:09:18,129 - phase-viz - INFO - plot_metric:151 - User input: l2
2025-05-24 17:09:18,129 - phase-viz - INFO - plot_metric:204 - Added metric: L2 Norm
2025-05-24 17:09:19,067 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 17:09:19,067 - phase-viz - INFO - plot_metric:214 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-24 17:09:19,067 - phase-viz - INFO - compute_metrics_over_checkpoints:258 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:09:19,113 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 17:09:19,167 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 17:09:19,168 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 17:09:19,168 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 17:09:19,168 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170919_d5wwc5e9.html
2025-05-24 17:09:19,168 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170919_d5wwc5e9.html
2025-05-24 17:09:19,168 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170919_d5wwc5e9.html
2025-05-24 17:09:19,168 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170919_d5wwc5e9.html
2025-05-24 17:09:28,360 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 17:09:28,360 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170919_d5wwc5e9.html
2025-05-24 17:09:32,143 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:09:32,144 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:09:32,144 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 17:09:32,284 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 17:09:32,284 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 17:09:36,920 - phase-viz - INFO - plot_metric:151 - User input: custom_metrics.py
2025-05-24 17:09:36,921 - phase-viz - INFO - plot_metric:190 - Added metric: Parameter Variance
2025-05-24 17:09:36,921 - phase-viz - INFO - plot_metric:190 - Added metric: Layer Wise Norm Ratio
2025-05-24 17:09:36,921 - phase-viz - INFO - plot_metric:190 - Added metric: Activation Capacity
2025-05-24 17:09:36,921 - phase-viz - INFO - plot_metric:190 - Added metric: Dead Neuron Percentage
2025-05-24 17:09:36,921 - phase-viz - INFO - plot_metric:190 - Added metric: Weight Rank
2025-05-24 17:09:36,921 - phase-viz - INFO - plot_metric:190 - Added metric: Gradient Flow Score
2025-05-24 17:09:38,050 - phase-viz - INFO - plot_metric:151 - User input: done
2025-05-24 17:09:38,050 - phase-viz - INFO - plot_metric:214 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 17:09:38,050 - phase-viz - INFO - compute_metrics_over_checkpoints:258 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:09:38,939 - phase-viz - INFO - plot_metric:255 - Successfully computed all metrics
2025-05-24 17:09:38,958 - phase-viz - INFO - plot_metric:268 - Cleared model and metric caches
2025-05-24 17:09:38,959 - phase-viz - INFO - plot_metric:273 - Saved metrics data to state
2025-05-24 17:09:38,959 - phase-viz - INFO - plot_metric:289 - Generating interactive plot
2025-05-24 17:09:38,959 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170938_zprhxf4y.html
2025-05-24 17:09:38,959 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170938_zprhxf4y.html
2025-05-24 17:09:38,959 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170938_zprhxf4y.html
2025-05-24 17:09:38,959 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170938_zprhxf4y.html
2025-05-24 17:12:19,112 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170938_zprhxf4y.html
2025-05-24 17:12:19,112 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170938_zprhxf4y.html
2025-05-24 17:12:19,112 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_170938_zprhxf4y.html
2025-05-24 17:12:19,112 - phase-viz - INFO - plot_metric:295 - Plot generation completed
2025-05-24 17:17:18,815 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:18:05,540 - phase-viz - INFO - <module>:309 - Starting phase-viz CLI
2025-05-24 17:18:05,541 - phase-viz - INFO - plot_metric:107 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:18:05,541 - phase-viz - INFO - plot_metric:111 - State loaded successfully
2025-05-24 17:18:05,678 - phase-viz - WARNING - plot_metric:120 - CUDA requested but not available, falling back to CPU
2025-05-24 17:18:05,678 - phase-viz - INFO - plot_metric:131 - Running on CPU
2025-05-24 17:18:07,245 - phase-viz - INFO - plot_metric:151 - User input: exit
2025-05-24 17:18:07,245 - phase-viz - INFO - plot_metric:161 - User exited
2025-05-24 17:35:00,364 - phase-viz - INFO - <module>:335 - Starting phase-viz CLI
2025-05-24 17:35:00,364 - phase-viz - INFO - plot_metric:106 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:35:00,365 - phase-viz - INFO - plot_metric:110 - State loaded successfully
2025-05-24 17:35:00,503 - phase-viz - WARNING - plot_metric:119 - CUDA requested but not available, falling back to CPU
2025-05-24 17:35:00,503 - phase-viz - INFO - plot_metric:130 - Running on CPU
2025-05-24 17:35:03,059 - phase-viz - INFO - plot_metric:150 - User input: metrics
2025-05-24 17:35:03,060 - phase-viz - INFO - plot_metric:189 - Added metric: L2 Norm
2025-05-24 17:35:03,060 - phase-viz - INFO - plot_metric:189 - Added metric: Weight Entropy
2025-05-24 17:35:03,060 - phase-viz - INFO - plot_metric:189 - Added metric: Layer Connectivity
2025-05-24 17:35:31,588 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 17:35:34,057 - phase-viz - INFO - <module>:334 - Starting phase-viz CLI
2025-05-24 17:35:34,058 - phase-viz - INFO - plot_metric:106 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:35:34,058 - phase-viz - INFO - plot_metric:110 - State loaded successfully
2025-05-24 17:35:34,195 - phase-viz - WARNING - plot_metric:119 - CUDA requested but not available, falling back to CPU
2025-05-24 17:35:34,195 - phase-viz - INFO - plot_metric:130 - Running on CPU
2025-05-24 17:35:37,135 - phase-viz - INFO - plot_metric:150 - User input: metrics
2025-05-24 17:35:37,135 - phase-viz - INFO - plot_metric:189 - Added metric: L2 Norm
2025-05-24 17:35:37,135 - phase-viz - INFO - plot_metric:189 - Added metric: Weight Entropy
2025-05-24 17:35:37,135 - phase-viz - INFO - plot_metric:189 - Added metric: Layer Connectivity
2025-05-24 17:36:58,494 - phase-viz - INFO - plot_metric:150 - User input: done
2025-05-24 17:36:58,494 - phase-viz - INFO - plot_metric:239 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-24 17:36:58,494 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:36:58,548 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,550 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,550 - phase-viz - ERROR - compute_metric_batch:183 - Error calculating Weight Entropy: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,550 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,551 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,551 - phase-viz - ERROR - compute_metric_batch:183 - Error calculating Layer Connectivity: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,553 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,554 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,555 - phase-viz - ERROR - compute_metric_batch:183 - Error calculating Weight Entropy: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,555 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,556 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,556 - phase-viz - ERROR - compute_metric_batch:183 - Error calculating Layer Connectivity: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,557 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,558 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,558 - phase-viz - ERROR - compute_metric_batch:183 - Error calculating Weight Entropy: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,559 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,559 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,558 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,559 - phase-viz - ERROR - compute_metric_batch:183 - Error calculating Layer Connectivity: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,559 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,560 - phase-viz - ERROR - compute_metric_batch:183 - Error calculating Weight Entropy: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 121, in weight_entropy_of_model
    normalized_entropy = entropy / np.log(num_bins)
                                   ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,560 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,561 - phase-viz - ERROR - wrapper:42 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,561 - phase-viz - ERROR - compute_metric_batch:183 - Error calculating Layer Connectivity: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 33, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 147, in layer_connectivity_of_model
    return float(np.mean(layer_weights))
                 ^^
NameError: name 'np' is not defined
2025-05-24 17:36:58,572 - phase-viz - INFO - plot_metric:280 - Successfully computed all metrics
2025-05-24 17:36:58,594 - phase-viz - INFO - plot_metric:293 - Cleared model and metric caches
2025-05-24 17:36:58,595 - phase-viz - INFO - plot_metric:298 - Saved metrics data to state
2025-05-24 17:36:58,595 - phase-viz - INFO - plot_metric:314 - Generating interactive plot
2025-05-24 17:36:58,595 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_173658_za3t2vhk.html
2025-05-24 17:36:58,595 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_173658_za3t2vhk.html
2025-05-24 17:36:58,595 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_173658_za3t2vhk.html
2025-05-24 17:36:58,595 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_173658_za3t2vhk.html
2025-05-24 17:37:06,868 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_173658_za3t2vhk.html
2025-05-24 17:37:06,868 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_173658_za3t2vhk.html
2025-05-24 17:37:06,868 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_173658_za3t2vhk.html
2025-05-24 17:37:06,868 - phase-viz - INFO - plot_metric:320 - Plot generation completed
2025-05-24 17:37:11,244 - phase-viz - INFO - <module>:334 - Starting phase-viz CLI
2025-05-24 17:37:11,245 - phase-viz - INFO - plot_metric:106 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:37:11,245 - phase-viz - INFO - plot_metric:110 - State loaded successfully
2025-05-24 17:37:11,384 - phase-viz - WARNING - plot_metric:119 - CUDA requested but not available, falling back to CPU
2025-05-24 17:37:11,384 - phase-viz - INFO - plot_metric:130 - Running on CPU
2025-05-24 17:37:13,748 - phase-viz - INFO - plot_metric:150 - User input: metrics
2025-05-24 17:37:13,749 - phase-viz - INFO - plot_metric:189 - Added metric: L2 Norm
2025-05-24 17:37:13,749 - phase-viz - INFO - plot_metric:189 - Added metric: Weight Entropy
2025-05-24 17:37:13,749 - phase-viz - INFO - plot_metric:189 - Added metric: Layer Connectivity
2025-05-24 17:37:55,776 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 17:38:23,716 - phase-viz - INFO - <module>:334 - Starting phase-viz CLI
2025-05-24 17:38:23,717 - phase-viz - INFO - plot_metric:106 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:38:23,717 - phase-viz - INFO - plot_metric:110 - State loaded successfully
2025-05-24 17:38:23,854 - phase-viz - WARNING - plot_metric:119 - CUDA requested but not available, falling back to CPU
2025-05-24 17:38:23,854 - phase-viz - INFO - plot_metric:130 - Running on CPU
2025-05-24 17:38:25,195 - phase-viz - INFO - plot_metric:150 - User input: metrics
2025-05-24 17:38:34,939 - phase-viz - INFO - plot_metric:150 - User input: entropy
2025-05-24 17:38:34,939 - phase-viz - INFO - plot_metric:219 - Added metric: Weight Entropy
2025-05-24 17:39:46,425 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 17:39:46,426 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:39:46,426 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 17:39:46,562 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 17:39:46,562 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 17:39:48,688 - phase-viz - INFO - plot_metric:153 - User input: entropy
2025-05-24 17:39:48,688 - phase-viz - INFO - plot_metric:222 - Added metric: Weight Entropy
2025-05-24 17:39:57,922 - phase-viz - INFO - plot_metric:153 - User input: metrics
2025-05-24 17:40:01,113 - phase-viz - INFO - plot_metric:153 - User input: connectivity
2025-05-24 17:40:01,113 - phase-viz - INFO - plot_metric:232 - Added metric: Layer Connectivity
2025-05-24 17:40:02,389 - phase-viz - INFO - plot_metric:153 - User input: l2
2025-05-24 17:40:02,389 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-24 17:40:03,290 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 17:40:03,290 - phase-viz - INFO - plot_metric:242 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-24 17:40:03,290 - phase-viz - INFO - compute_metrics_over_checkpoints:326 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:40:03,337 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 17:40:03,391 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 17:40:03,391 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 17:40:03,391 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 17:40:03,391 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174003_19r1ja39.html
2025-05-24 17:40:03,391 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174003_19r1ja39.html
2025-05-24 17:40:03,391 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174003_19r1ja39.html
2025-05-24 17:40:03,392 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174003_19r1ja39.html
2025-05-24 17:40:19,803 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 17:40:19,804 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174003_19r1ja39.html
2025-05-24 17:40:32,259 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 17:40:32,260 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=False
2025-05-24 17:40:32,260 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 17:40:32,404 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 17:40:32,404 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 17:40:37,849 - phase-viz - INFO - plot_metric:153 - User input: entropy
2025-05-24 17:40:37,849 - phase-viz - INFO - plot_metric:222 - Added metric: Weight Entropy
2025-05-24 17:40:38,630 - phase-viz - INFO - plot_metric:153 - User input: l2
2025-05-24 17:40:38,630 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-24 17:40:39,013 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 17:40:39,013 - phase-viz - INFO - plot_metric:242 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-24 17:40:39,013 - phase-viz - INFO - compute_metrics_over_checkpoints:362 - Processing checkpoints sequentially
2025-05-24 17:40:39,024 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 17:40:39,114 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 17:40:39,114 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 17:40:39,114 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 17:40:39,114 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174039_gqziv8se.html
2025-05-24 17:40:39,114 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174039_gqziv8se.html
2025-05-24 17:40:39,114 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174039_gqziv8se.html
2025-05-24 17:40:39,115 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174039_gqziv8se.html
2025-05-24 17:40:39,703 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174039_gqziv8se.html
2025-05-24 17:40:39,703 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174039_gqziv8se.html
2025-05-24 17:40:39,703 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174039_gqziv8se.html
2025-05-24 17:40:39,703 - phase-viz - INFO - plot_metric:323 - Plot generation completed
2025-05-24 17:40:53,090 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 17:40:53,091 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=False
2025-05-24 17:40:53,091 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 17:40:53,230 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 17:40:53,230 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 17:40:54,785 - phase-viz - INFO - plot_metric:153 - User input: entropy
2025-05-24 17:40:54,785 - phase-viz - INFO - plot_metric:222 - Added metric: Weight Entropy
2025-05-24 17:40:56,451 - phase-viz - INFO - plot_metric:153 - User input: connectivity
2025-05-24 17:40:56,451 - phase-viz - INFO - plot_metric:232 - Added metric: Layer Connectivity
2025-05-24 17:40:57,707 - phase-viz - INFO - plot_metric:153 - User input: l2
2025-05-24 17:40:57,707 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-24 17:40:58,163 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 17:40:58,163 - phase-viz - INFO - plot_metric:242 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-24 17:40:58,163 - phase-viz - INFO - compute_metrics_over_checkpoints:362 - Processing checkpoints sequentially
2025-05-24 17:40:58,174 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 17:40:58,264 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 17:40:58,264 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 17:40:58,264 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 17:40:58,264 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174058_xcryywr7.html
2025-05-24 17:40:58,264 - phase-viz - INFO - start:236 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174058_xcryywr7.html
2025-05-24 17:40:58,264 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174058_xcryywr7.html
2025-05-24 17:40:58,265 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174058_xcryywr7.html
2025-05-24 17:41:23,427 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 17:41:23,427 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174058_xcryywr7.html
2025-05-24 17:41:25,650 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 17:41:25,651 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:41:25,651 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 17:41:25,789 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 17:41:25,789 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 17:41:40,301 - phase-viz - INFO - plot_metric:153 - User input: custom-metrics.py
2025-05-24 17:41:40,301 - phase-viz - WARNING - plot_metric:237 - Unknown metric: custom-metrics.py
2025-05-24 17:41:43,100 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 17:41:47,224 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 17:41:47,225 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:41:47,225 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 17:41:47,367 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 17:41:47,367 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 17:41:49,896 - phase-viz - INFO - plot_metric:153 - User input: custom_metrics.py
2025-05-24 17:41:49,896 - phase-viz - INFO - plot_metric:192 - Added metric: Parameter Variance
2025-05-24 17:41:49,897 - phase-viz - INFO - plot_metric:192 - Added metric: Layer Wise Norm Ratio
2025-05-24 17:41:49,897 - phase-viz - INFO - plot_metric:192 - Added metric: Activation Capacity
2025-05-24 17:41:49,897 - phase-viz - INFO - plot_metric:192 - Added metric: Dead Neuron Percentage
2025-05-24 17:41:49,897 - phase-viz - INFO - plot_metric:192 - Added metric: Weight Rank
2025-05-24 17:41:49,897 - phase-viz - INFO - plot_metric:192 - Added metric: Gradient Flow Score
2025-05-24 17:41:50,529 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 17:41:50,529 - phase-viz - INFO - plot_metric:242 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 17:41:50,529 - phase-viz - INFO - compute_metrics_over_checkpoints:326 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:41:51,332 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 17:41:51,337 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 17:41:51,338 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 17:41:51,338 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 17:41:51,338 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174151_pyrajxpl.html
2025-05-24 17:41:51,338 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174151_pyrajxpl.html
2025-05-24 17:41:51,338 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174151_pyrajxpl.html
2025-05-24 17:41:51,338 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174151_pyrajxpl.html
2025-05-24 17:43:59,612 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 17:43:59,612 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174151_pyrajxpl.html
2025-05-24 17:44:05,245 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 17:44:05,246 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:44:05,246 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 17:44:05,386 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 17:44:05,386 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 17:44:06,894 - phase-viz - INFO - plot_metric:153 - User input: l2
2025-05-24 17:44:06,894 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-24 17:44:12,601 - phase-viz - INFO - plot_metric:153 - User input: entropy
2025-05-24 17:44:12,601 - phase-viz - INFO - plot_metric:222 - Added metric: Weight Entropy
2025-05-24 17:44:13,067 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 17:44:13,067 - phase-viz - INFO - plot_metric:242 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-24 17:44:13,068 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:44:13,139 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 17:44:13,168 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 17:44:13,168 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 17:44:13,168 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 17:44:13,169 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174413_9eourcth.html
2025-05-24 17:44:13,169 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174413_9eourcth.html
2025-05-24 17:44:13,169 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174413_9eourcth.html
2025-05-24 17:44:13,169 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174413_9eourcth.html
2025-05-24 17:44:36,797 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 17:44:36,798 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174413_9eourcth.html
2025-05-24 17:44:39,372 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 17:44:39,373 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 17:44:39,373 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 17:44:39,515 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 17:44:39,516 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 17:44:41,500 - phase-viz - INFO - plot_metric:153 - User input: eentropy
2025-05-24 17:44:41,500 - phase-viz - WARNING - plot_metric:237 - Unknown metric: eentropy
2025-05-24 17:44:44,882 - phase-viz - INFO - plot_metric:153 - User input: entropy
2025-05-24 17:44:44,882 - phase-viz - INFO - plot_metric:222 - Added metric: Weight Entropy
2025-05-24 17:44:49,604 - phase-viz - INFO - plot_metric:153 - User input: connectivity
2025-05-24 17:44:49,604 - phase-viz - INFO - plot_metric:232 - Added metric: Layer Connectivity
2025-05-24 17:44:50,773 - phase-viz - INFO - plot_metric:153 - User input: l2
2025-05-24 17:44:50,773 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-24 17:44:51,316 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 17:44:51,317 - phase-viz - INFO - plot_metric:242 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-24 17:44:51,317 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 17:44:51,388 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 17:44:51,417 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 17:44:51,417 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 17:44:51,418 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 17:44:51,418 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174451_bmmfl6gz.html
2025-05-24 17:44:51,418 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174451_bmmfl6gz.html
2025-05-24 17:44:51,418 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174451_bmmfl6gz.html
2025-05-24 17:44:51,418 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174451_bmmfl6gz.html
2025-05-24 17:44:51,992 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174451_bmmfl6gz.html
2025-05-24 17:44:51,992 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174451_bmmfl6gz.html
2025-05-24 17:44:51,992 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_174451_bmmfl6gz.html
2025-05-24 17:44:51,992 - phase-viz - INFO - plot_metric:323 - Plot generation completed
2025-05-24 20:00:14,242 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 20:00:14,242 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:00:14,243 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 20:00:14,385 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 20:00:14,386 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 20:00:34,216 - phase-viz - INFO - plot_metric:153 - User input: custom_metrics.py
2025-05-24 20:00:34,217 - phase-viz - INFO - plot_metric:192 - Added metric: Parameter Variance
2025-05-24 20:00:34,217 - phase-viz - INFO - plot_metric:192 - Added metric: Layer Wise Norm Ratio
2025-05-24 20:00:34,217 - phase-viz - INFO - plot_metric:192 - Added metric: Activation Capacity
2025-05-24 20:00:34,217 - phase-viz - INFO - plot_metric:192 - Added metric: Dead Neuron Percentage
2025-05-24 20:00:34,217 - phase-viz - INFO - plot_metric:192 - Added metric: Weight Rank
2025-05-24 20:00:34,217 - phase-viz - INFO - plot_metric:192 - Added metric: Gradient Flow Score
2025-05-24 20:00:35,341 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 20:00:35,341 - phase-viz - INFO - plot_metric:242 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 20:00:35,341 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 20:00:36,136 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 20:00:36,150 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 20:00:36,150 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 20:00:36,150 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 20:00:36,151 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200036_n37g9gwj.html
2025-05-24 20:00:36,151 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200036_n37g9gwj.html
2025-05-24 20:00:36,151 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200036_n37g9gwj.html
2025-05-24 20:00:36,151 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200036_n37g9gwj.html
2025-05-24 20:06:38,126 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200036_n37g9gwj.html
2025-05-24 20:06:38,126 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200036_n37g9gwj.html
2025-05-24 20:06:38,127 - phase-viz - INFO - plot_metric_interactive:1677 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200036_n37g9gwj.html
2025-05-24 20:06:38,127 - phase-viz - INFO - plot_metric:323 - Plot generation completed
2025-05-24 20:06:42,732 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 20:06:42,733 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:06:42,733 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 20:06:42,874 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 20:06:42,874 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 20:06:49,823 - phase-viz - INFO - plot_metric:153 - User input: custom-metrics.py
2025-05-24 20:06:49,824 - phase-viz - WARNING - plot_metric:237 - Unknown metric: custom-metrics.py
2025-05-24 20:06:55,767 - phase-viz - INFO - plot_metric:153 - User input: custom_metrics.py
2025-05-24 20:06:55,767 - phase-viz - INFO - plot_metric:192 - Added metric: Parameter Variance
2025-05-24 20:06:55,767 - phase-viz - INFO - plot_metric:192 - Added metric: Layer Wise Norm Ratio
2025-05-24 20:06:55,767 - phase-viz - INFO - plot_metric:192 - Added metric: Activation Capacity
2025-05-24 20:06:55,767 - phase-viz - INFO - plot_metric:192 - Added metric: Dead Neuron Percentage
2025-05-24 20:06:55,767 - phase-viz - INFO - plot_metric:192 - Added metric: Weight Rank
2025-05-24 20:06:55,767 - phase-viz - INFO - plot_metric:192 - Added metric: Gradient Flow Score
2025-05-24 20:06:56,276 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 20:06:56,276 - phase-viz - INFO - plot_metric:242 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 20:06:56,276 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 20:06:56,886 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 20:06:56,888 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 20:06:56,888 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 20:06:56,888 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 20:06:56,888 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200656_7kmmj5jw.html
2025-05-24 20:06:56,888 - phase-viz - INFO - start:236 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200656_7kmmj5jw.html
2025-05-24 20:06:56,888 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200656_7kmmj5jw.html
2025-05-24 20:06:56,889 - phase-viz - INFO - plot_metric_interactive:1668 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200656_7kmmj5jw.html
2025-05-24 20:19:21,943 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 20:19:21,943 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_200656_7kmmj5jw.html
2025-05-24 20:19:24,858 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 20:19:24,859 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:19:24,859 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 20:19:24,996 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 20:19:24,996 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 20:19:32,902 - phase-viz - INFO - plot_metric:153 - User input: custom_metrics
2025-05-24 20:19:32,902 - phase-viz - INFO - plot_metric:192 - Added metric: Parameter Variance
2025-05-24 20:19:32,902 - phase-viz - INFO - plot_metric:192 - Added metric: Layer Wise Norm Ratio
2025-05-24 20:19:32,902 - phase-viz - INFO - plot_metric:192 - Added metric: Activation Capacity
2025-05-24 20:19:32,902 - phase-viz - INFO - plot_metric:192 - Added metric: Dead Neuron Percentage
2025-05-24 20:19:32,902 - phase-viz - INFO - plot_metric:192 - Added metric: Weight Rank
2025-05-24 20:19:32,902 - phase-viz - INFO - plot_metric:192 - Added metric: Gradient Flow Score
2025-05-24 20:19:33,950 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 20:19:33,950 - phase-viz - INFO - plot_metric:242 - Starting calculation of 6 metrics across 4 checkpoints
2025-05-24 20:19:33,951 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 20:19:34,524 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 20:19:34,558 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 20:19:34,558 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 20:19:34,558 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 20:19:34,559 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_201934_spc8vuv2.html
2025-05-24 20:19:34,559 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_201934_spc8vuv2.html
2025-05-24 20:19:34,559 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_201934_spc8vuv2.html
2025-05-24 20:19:34,559 - phase-viz - INFO - plot_metric_interactive:1721 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_201934_spc8vuv2.html
2025-05-24 20:41:45,256 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 20:41:45,256 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_201934_spc8vuv2.html
2025-05-24 20:41:49,052 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 20:41:49,053 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:41:49,053 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 20:41:49,192 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 20:41:49,192 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 20:41:55,364 - phase-viz - INFO - plot_metric:153 - User input: geo_met_test.py
2025-05-24 20:41:55,365 - phase-viz - ERROR - _err:331 - Fatal error: Failed importing metric functions from /home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py: Failed importing /home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py: name 'torch' is not defined
2025-05-24 20:42:18,428 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 20:42:18,429 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:42:18,429 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 20:42:18,568 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 20:42:18,568 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 20:42:24,678 - phase-viz - INFO - plot_metric:153 - User input: geo_met_test.py
2025-05-24 20:42:25,060 - phase-viz - INFO - plot_metric:192 - Added metric: Effective Rank
2025-05-24 20:42:25,060 - phase-viz - INFO - plot_metric:192 - Added metric: Avg Condition Number
2025-05-24 20:42:25,060 - phase-viz - INFO - plot_metric:192 - Added metric: Mean Weight
2025-05-24 20:42:25,060 - phase-viz - INFO - plot_metric:192 - Added metric: Isotropy
2025-05-24 20:42:26,755 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 20:42:26,755 - phase-viz - INFO - plot_metric:242 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-24 20:42:26,755 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 20:42:27,694 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 20, in effective_rank_of_model
    return np.mean(ranks) if ranks else 0.0
           ^^
NameError: name 'np' is not defined
2025-05-24 20:42:27,701 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Effective Rank: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 20, in effective_rank_of_model
    return np.mean(ranks) if ranks else 0.0
           ^^
NameError: name 'np' is not defined
2025-05-24 20:42:27,805 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 20, in effective_rank_of_model
    return np.mean(ranks) if ranks else 0.0
           ^^
NameError: name 'np' is not defined
2025-05-24 20:42:27,807 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Effective Rank: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 20, in effective_rank_of_model
    return np.mean(ranks) if ranks else 0.0
           ^^
NameError: name 'np' is not defined
2025-05-24 20:42:27,860 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 20, in effective_rank_of_model
    return np.mean(ranks) if ranks else 0.0
           ^^
NameError: name 'np' is not defined
2025-05-24 20:42:27,862 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Effective Rank: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 20, in effective_rank_of_model
    return np.mean(ranks) if ranks else 0.0
           ^^
NameError: name 'np' is not defined
2025-05-24 20:42:27,874 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 20, in effective_rank_of_model
    return np.mean(ranks) if ranks else 0.0
           ^^
NameError: name 'np' is not defined
2025-05-24 20:42:27,876 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Effective Rank: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 20, in effective_rank_of_model
    return np.mean(ranks) if ranks else 0.0
           ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,518 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 33, in avg_condition_number_of_model
    return float(np.mean(condition_numbers)) if condition_numbers else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,519 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Avg Condition Number: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 33, in avg_condition_number_of_model
    return float(np.mean(condition_numbers)) if condition_numbers else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,596 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 58, in isotropy_of_model
    return float(np.mean(isotropies)) if isotropies else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,596 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Isotropy: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 58, in isotropy_of_model
    return float(np.mean(isotropies)) if isotropies else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,707 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 33, in avg_condition_number_of_model
    return float(np.mean(condition_numbers)) if condition_numbers else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,708 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Avg Condition Number: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 33, in avg_condition_number_of_model
    return float(np.mean(condition_numbers)) if condition_numbers else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,780 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 58, in isotropy_of_model
    return float(np.mean(isotropies)) if isotropies else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,781 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Isotropy: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 58, in isotropy_of_model
    return float(np.mean(isotropies)) if isotropies else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,818 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 33, in avg_condition_number_of_model
    return float(np.mean(condition_numbers)) if condition_numbers else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,820 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Avg Condition Number: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 33, in avg_condition_number_of_model
    return float(np.mean(condition_numbers)) if condition_numbers else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,829 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 58, in isotropy_of_model
    return float(np.mean(isotropies)) if isotropies else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,830 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Isotropy: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 58, in isotropy_of_model
    return float(np.mean(isotropies)) if isotropies else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,834 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 33, in avg_condition_number_of_model
    return float(np.mean(condition_numbers)) if condition_numbers else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,835 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Avg Condition Number: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 33, in avg_condition_number_of_model
    return float(np.mean(condition_numbers)) if condition_numbers else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,836 - phase-viz - ERROR - wrapper:45 - Error calculating metric: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 58, in isotropy_of_model
    return float(np.mean(isotropies)) if isotropies else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,836 - phase-viz - ERROR - compute_metric_batch:186 - Error calculating Isotropy: name 'np' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 178, in compute_metric_batch
    value = func(model)
            ^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 36, in wrapper
    result = func(model, *args, **kw)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/geo_met_test.py", line 58, in isotropy_of_model
    return float(np.mean(isotropies)) if isotropies else 0.0
                 ^^
NameError: name 'np' is not defined
2025-05-24 20:42:28,848 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 20:42:28,867 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 20:42:28,868 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 20:42:28,868 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 20:42:28,868 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204228_gsbovvy4.html
2025-05-24 20:42:28,868 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204228_gsbovvy4.html
2025-05-24 20:42:28,868 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204228_gsbovvy4.html
2025-05-24 20:42:28,868 - phase-viz - INFO - plot_metric_interactive:1721 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204228_gsbovvy4.html
2025-05-24 20:43:08,302 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 20:43:08,302 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204228_gsbovvy4.html
2025-05-24 20:43:10,793 - phase-viz - INFO - <module>:337 - Starting phase-viz CLI
2025-05-24 20:43:10,794 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:43:10,794 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-24 20:43:10,934 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-24 20:43:10,934 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-24 20:43:26,940 - phase-viz - INFO - plot_metric:153 - User input: geo_met_test.py
2025-05-24 20:43:27,139 - phase-viz - INFO - plot_metric:192 - Added metric: Effective Rank
2025-05-24 20:43:27,139 - phase-viz - INFO - plot_metric:192 - Added metric: Avg Condition Number
2025-05-24 20:43:27,139 - phase-viz - INFO - plot_metric:192 - Added metric: Mean Weight
2025-05-24 20:43:27,139 - phase-viz - INFO - plot_metric:192 - Added metric: Isotropy
2025-05-24 20:43:29,241 - phase-viz - INFO - plot_metric:153 - User input: done
2025-05-24 20:43:29,241 - phase-viz - INFO - plot_metric:242 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-24 20:43:29,242 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 20:43:31,115 - phase-viz - INFO - plot_metric:283 - Successfully computed all metrics
2025-05-24 20:43:31,154 - phase-viz - INFO - plot_metric:296 - Cleared model and metric caches
2025-05-24 20:43:31,155 - phase-viz - INFO - plot_metric:301 - Saved metrics data to state
2025-05-24 20:43:31,155 - phase-viz - INFO - plot_metric:317 - Generating interactive plot
2025-05-24 20:43:31,155 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204331_nwkzz7er.html
2025-05-24 20:43:31,155 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204331_nwkzz7er.html
2025-05-24 20:43:31,155 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204331_nwkzz7er.html
2025-05-24 20:43:31,155 - phase-viz - INFO - plot_metric_interactive:1721 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204331_nwkzz7er.html
2025-05-24 20:43:31,998 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204331_nwkzz7er.html
2025-05-24 20:43:31,998 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204331_nwkzz7er.html
2025-05-24 20:43:31,998 - phase-viz - INFO - plot_metric_interactive:1730 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204331_nwkzz7er.html
2025-05-24 20:43:31,998 - phase-viz - INFO - plot_metric:323 - Plot generation completed
2025-05-24 20:48:18,948 - phase-viz - INFO - <module>:339 - Starting phase-viz CLI
2025-05-24 20:48:18,949 - phase-viz - INFO - plot_metric:111 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:48:18,950 - phase-viz - INFO - plot_metric:115 - State loaded successfully
2025-05-24 20:48:19,087 - phase-viz - WARNING - plot_metric:124 - CUDA requested but not available, falling back to CPU
2025-05-24 20:48:19,087 - phase-viz - INFO - plot_metric:135 - Running on CPU
2025-05-24 20:48:25,911 - phase-viz - INFO - plot_metric:155 - User input: geo_met_test.py
2025-05-24 20:48:26,110 - phase-viz - INFO - plot_metric:194 - Added metric: Effective Rank
2025-05-24 20:48:26,111 - phase-viz - INFO - plot_metric:194 - Added metric: Avg Condition Number
2025-05-24 20:48:26,111 - phase-viz - INFO - plot_metric:194 - Added metric: Mean Weight
2025-05-24 20:48:26,111 - phase-viz - INFO - plot_metric:194 - Added metric: Isotropy
2025-05-24 20:48:26,775 - phase-viz - INFO - plot_metric:155 - User input: done
2025-05-24 20:48:26,775 - phase-viz - INFO - plot_metric:244 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-24 20:48:26,775 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 20:48:28,072 - phase-viz - INFO - plot_metric:285 - Successfully computed all metrics
2025-05-24 20:48:28,090 - phase-viz - INFO - plot_metric:298 - Cleared model and metric caches
2025-05-24 20:48:28,090 - phase-viz - INFO - plot_metric:303 - Saved metrics data to state
2025-05-24 20:48:28,090 - phase-viz - INFO - plot_metric:319 - Generating interactive plot
2025-05-24 20:48:28,091 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204828_p1q6rhnc.html
2025-05-24 20:48:28,091 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204828_p1q6rhnc.html
2025-05-24 20:48:28,091 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204828_p1q6rhnc.html
2025-05-24 20:48:28,091 - phase-viz - INFO - plot_metric_interactive:1720 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204828_p1q6rhnc.html
2025-05-24 20:48:53,752 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204828_p1q6rhnc.html
2025-05-24 20:48:53,752 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204828_p1q6rhnc.html
2025-05-24 20:48:53,752 - phase-viz - INFO - plot_metric_interactive:1729 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204828_p1q6rhnc.html
2025-05-24 20:48:53,752 - phase-viz - INFO - plot_metric:325 - Plot generation completed
2025-05-24 20:49:13,938 - phase-viz - INFO - <module>:339 - Starting phase-viz CLI
2025-05-24 20:49:13,939 - phase-viz - INFO - plot_metric:111 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:49:13,939 - phase-viz - INFO - plot_metric:115 - State loaded successfully
2025-05-24 20:49:14,080 - phase-viz - WARNING - plot_metric:124 - CUDA requested but not available, falling back to CPU
2025-05-24 20:49:14,080 - phase-viz - INFO - plot_metric:135 - Running on CPU
2025-05-24 20:49:20,148 - phase-viz - INFO - plot_metric:155 - User input: geo_met_test.py
2025-05-24 20:49:20,347 - phase-viz - INFO - plot_metric:194 - Added metric: Effective Rank
2025-05-24 20:49:20,347 - phase-viz - INFO - plot_metric:194 - Added metric: Avg Condition Number
2025-05-24 20:49:20,347 - phase-viz - INFO - plot_metric:194 - Added metric: Mean Weight
2025-05-24 20:49:20,347 - phase-viz - INFO - plot_metric:194 - Added metric: Isotropy
2025-05-24 20:49:21,615 - phase-viz - INFO - plot_metric:155 - User input: done
2025-05-24 20:49:21,615 - phase-viz - INFO - plot_metric:244 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-24 20:49:21,615 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 20:49:22,912 - phase-viz - INFO - plot_metric:285 - Successfully computed all metrics
2025-05-24 20:49:22,923 - phase-viz - INFO - plot_metric:298 - Cleared model and metric caches
2025-05-24 20:49:22,923 - phase-viz - INFO - plot_metric:303 - Saved metrics data to state
2025-05-24 20:49:22,923 - phase-viz - INFO - plot_metric:319 - Generating interactive plot
2025-05-24 20:49:22,923 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204922_dd5q3aqi.html
2025-05-24 20:49:22,923 - phase-viz - INFO - start:236 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204922_dd5q3aqi.html
2025-05-24 20:49:22,923 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204922_dd5q3aqi.html
2025-05-24 20:49:22,924 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204922_dd5q3aqi.html
2025-05-24 20:49:54,798 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 20:49:54,798 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_204922_dd5q3aqi.html
2025-05-24 20:49:57,178 - phase-viz - INFO - <module>:339 - Starting phase-viz CLI
2025-05-24 20:49:57,179 - phase-viz - INFO - plot_metric:111 - Starting plot-metric command with device=cuda, parallel=True
2025-05-24 20:49:57,179 - phase-viz - INFO - plot_metric:115 - State loaded successfully
2025-05-24 20:49:57,317 - phase-viz - WARNING - plot_metric:124 - CUDA requested but not available, falling back to CPU
2025-05-24 20:49:57,317 - phase-viz - INFO - plot_metric:135 - Running on CPU
2025-05-24 20:50:01,126 - phase-viz - INFO - plot_metric:155 - User input: geo_met_test.py
2025-05-24 20:50:01,326 - phase-viz - INFO - plot_metric:194 - Added metric: Effective Rank
2025-05-24 20:50:01,326 - phase-viz - INFO - plot_metric:194 - Added metric: Avg Condition Number
2025-05-24 20:50:01,326 - phase-viz - INFO - plot_metric:194 - Added metric: Mean Weight
2025-05-24 20:50:01,326 - phase-viz - INFO - plot_metric:194 - Added metric: Isotropy
2025-05-24 20:50:02,588 - phase-viz - INFO - plot_metric:155 - User input: done
2025-05-24 20:50:02,588 - phase-viz - INFO - plot_metric:244 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-24 20:50:02,589 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-24 20:50:03,991 - phase-viz - INFO - plot_metric:285 - Successfully computed all metrics
2025-05-24 20:50:04,004 - phase-viz - INFO - plot_metric:298 - Cleared model and metric caches
2025-05-24 20:50:04,004 - phase-viz - INFO - plot_metric:303 - Saved metrics data to state
2025-05-24 20:50:04,004 - phase-viz - INFO - plot_metric:319 - Generating interactive plot
2025-05-24 20:50:04,005 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_205004_7kv311ft.html
2025-05-24 20:50:04,005 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_205004_7kv311ft.html
2025-05-24 20:50:04,005 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_205004_7kv311ft.html
2025-05-24 20:50:04,005 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_205004_7kv311ft.html
2025-05-24 20:50:14,146 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-24 20:50:14,146 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250524_205004_7kv311ft.html
2025-05-25 11:24:01,444 - phase-viz - INFO - <module>:517 - Starting phase-viz CLI
2025-05-25 11:24:08,625 - phase-viz - INFO - <module>:517 - Starting phase-viz CLI
2025-05-25 11:24:17,163 - phase-viz - INFO - <module>:517 - Starting phase-viz CLI
2025-05-25 11:24:19,435 - phase-viz - INFO - <module>:517 - Starting phase-viz CLI
2025-05-25 11:24:19,436 - phase-viz - INFO - plot_metric:109 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:24:19,441 - phase-viz - INFO - plot_metric:113 - State loaded successfully
2025-05-25 11:24:19,583 - phase-viz - WARNING - plot_metric:122 - CUDA requested but not available, falling back to CPU
2025-05-25 11:24:19,583 - phase-viz - INFO - plot_metric:133 - Running on CPU
2025-05-25 11:24:23,365 - phase-viz - INFO - plot_metric:153 - User input: l2
2025-05-25 11:24:23,365 - phase-viz - INFO - plot_metric:230 - Added metric: L2 Norm
2025-05-25 11:24:37,360 - phase-viz - INFO - plot_metric:153 - User input: variance
2025-05-25 11:24:37,360 - phase-viz - INFO - plot_metric:260 - Added metric: Parameter Variance
2025-05-25 11:25:45,407 - phase-viz - INFO - <module>:531 - Starting phase-viz CLI
2025-05-25 11:25:45,407 - phase-viz - INFO - plot_metric:123 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:25:45,408 - phase-viz - INFO - plot_metric:127 - State loaded successfully
2025-05-25 11:25:45,548 - phase-viz - WARNING - plot_metric:136 - CUDA requested but not available, falling back to CPU
2025-05-25 11:25:45,548 - phase-viz - INFO - plot_metric:147 - Running on CPU
2025-05-25 11:25:46,762 - phase-viz - INFO - plot_metric:167 - User input: variance
2025-05-25 11:25:46,762 - phase-viz - INFO - plot_metric:274 - Added metric: Parameter Variance
2025-05-25 11:29:03,140 - phase-viz - INFO - <module>:531 - Starting phase-viz CLI
2025-05-25 11:29:03,141 - phase-viz - INFO - plot_metric:123 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:29:03,141 - phase-viz - INFO - plot_metric:127 - State loaded successfully
2025-05-25 11:29:03,280 - phase-viz - WARNING - plot_metric:136 - CUDA requested but not available, falling back to CPU
2025-05-25 11:29:03,280 - phase-viz - INFO - plot_metric:147 - Running on CPU
2025-05-25 11:29:05,798 - phase-viz - INFO - plot_metric:167 - User input: variance
2025-05-25 11:29:05,798 - phase-viz - INFO - plot_metric:274 - Added metric: Parameter Variance
2025-05-25 11:29:07,938 - phase-viz - INFO - plot_metric:167 - User input: done
2025-05-25 11:29:07,938 - phase-viz - INFO - plot_metric:436 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-25 11:29:07,938 - phase-viz - ERROR - plot_metric:479 - Error calculating metrics: name 'compute_metrics_over_checkpoints' is not defined
2025-05-25 11:29:08,039 - phase-viz - ERROR - _err:525 - Fatal error: Error calculating metrics: name 'compute_metrics_over_checkpoints' is not defined
2025-05-25 11:29:54,798 - phase-viz - INFO - <module>:531 - Starting phase-viz CLI
2025-05-25 11:29:54,798 - phase-viz - INFO - plot_metric:123 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:29:54,798 - phase-viz - INFO - plot_metric:127 - State loaded successfully
2025-05-25 11:29:54,939 - phase-viz - WARNING - plot_metric:136 - CUDA requested but not available, falling back to CPU
2025-05-25 11:29:54,939 - phase-viz - INFO - plot_metric:147 - Running on CPU
2025-05-25 11:29:55,898 - phase-viz - INFO - plot_metric:167 - User input: variance
2025-05-25 11:29:55,898 - phase-viz - INFO - plot_metric:274 - Added metric: Parameter Variance
2025-05-25 11:29:56,435 - phase-viz - INFO - plot_metric:167 - User input: done
2025-05-25 11:29:56,435 - phase-viz - INFO - plot_metric:436 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-25 11:29:56,435 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:29:56,491 - phase-viz - INFO - plot_metric:477 - Successfully computed all metrics
2025-05-25 11:30:11,549 - phase-viz - INFO - <module>:531 - Starting phase-viz CLI
2025-05-25 11:30:11,550 - phase-viz - INFO - plot_metric:123 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:30:11,550 - phase-viz - INFO - plot_metric:127 - State loaded successfully
2025-05-25 11:30:11,690 - phase-viz - WARNING - plot_metric:136 - CUDA requested but not available, falling back to CPU
2025-05-25 11:30:11,690 - phase-viz - INFO - plot_metric:147 - Running on CPU
2025-05-25 11:30:15,761 - phase-viz - INFO - plot_metric:167 - User input: variance
2025-05-25 11:30:15,761 - phase-viz - INFO - plot_metric:274 - Added metric: Parameter Variance
2025-05-25 11:30:16,247 - phase-viz - INFO - plot_metric:167 - User input: done
2025-05-25 11:30:16,247 - phase-viz - INFO - plot_metric:436 - Starting calculation of 1 metrics across 4 checkpoints
2025-05-25 11:30:16,247 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:30:16,290 - phase-viz - INFO - plot_metric:477 - Successfully computed all metrics
2025-05-25 11:30:16,348 - phase-viz - INFO - plot_metric:490 - Cleared model and metric caches
2025-05-25 11:30:16,348 - phase-viz - INFO - plot_metric:495 - Saved metrics data to state
2025-05-25 11:30:16,348 - phase-viz - INFO - plot_metric:511 - Generating interactive plot
2025-05-25 11:30:16,348 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113016_b474qr1p.html
2025-05-25 11:30:16,348 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113016_b474qr1p.html
2025-05-25 11:30:16,348 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113016_b474qr1p.html
2025-05-25 11:30:16,349 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113016_b474qr1p.html
2025-05-25 11:30:43,391 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-25 11:30:43,391 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113016_b474qr1p.html
2025-05-25 11:30:45,694 - phase-viz - INFO - <module>:531 - Starting phase-viz CLI
2025-05-25 11:30:45,695 - phase-viz - INFO - plot_metric:123 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:30:45,695 - phase-viz - INFO - plot_metric:127 - State loaded successfully
2025-05-25 11:30:45,831 - phase-viz - WARNING - plot_metric:136 - CUDA requested but not available, falling back to CPU
2025-05-25 11:30:45,831 - phase-viz - INFO - plot_metric:147 - Running on CPU
2025-05-25 11:30:49,544 - phase-viz - INFO - plot_metric:167 - User input: variance
2025-05-25 11:30:49,544 - phase-viz - INFO - plot_metric:274 - Added metric: Parameter Variance
2025-05-25 11:30:50,145 - phase-viz - INFO - plot_metric:167 - User input: l2
2025-05-25 11:30:50,145 - phase-viz - INFO - plot_metric:244 - Added metric: L2 Norm
2025-05-25 11:31:07,583 - phase-viz - INFO - plot_metric:167 - User input: entropy
2025-05-25 11:31:07,584 - phase-viz - INFO - plot_metric:254 - Added metric: Weight Entropy
2025-05-25 11:31:08,823 - phase-viz - INFO - plot_metric:167 - User input: done
2025-05-25 11:31:08,823 - phase-viz - INFO - plot_metric:436 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-25 11:31:08,824 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:31:08,905 - phase-viz - INFO - plot_metric:477 - Successfully computed all metrics
2025-05-25 11:31:08,924 - phase-viz - INFO - plot_metric:490 - Cleared model and metric caches
2025-05-25 11:31:08,924 - phase-viz - INFO - plot_metric:495 - Saved metrics data to state
2025-05-25 11:31:08,924 - phase-viz - INFO - plot_metric:511 - Generating interactive plot
2025-05-25 11:31:08,924 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113108_7t45a9rr.html
2025-05-25 11:31:08,925 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113108_7t45a9rr.html
2025-05-25 11:31:08,925 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113108_7t45a9rr.html
2025-05-25 11:31:08,925 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113108_7t45a9rr.html
2025-05-25 11:31:09,480 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113108_7t45a9rr.html
2025-05-25 11:31:09,480 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113108_7t45a9rr.html
2025-05-25 11:31:09,480 - phase-viz - INFO - plot_metric_interactive:1731 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113108_7t45a9rr.html
2025-05-25 11:31:09,480 - phase-viz - INFO - plot_metric:517 - Plot generation completed
2025-05-25 11:36:12,619 - phase-viz - INFO - <module>:565 - Starting phase-viz CLI
2025-05-25 11:36:12,620 - phase-viz - INFO - plot_metric:148 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:36:12,620 - phase-viz - INFO - plot_metric:152 - State loaded successfully
2025-05-25 11:36:12,759 - phase-viz - WARNING - plot_metric:161 - CUDA requested but not available, falling back to CPU
2025-05-25 11:36:12,759 - phase-viz - INFO - plot_metric:172 - Running on CPU
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:192 - User input: all
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: L2 Norm
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Weight Entropy
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Layer Connectivity
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Parameter Variance
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Layer Wise Norm Ratio
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Activation Capacity
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Dead Neuron Percentage
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Weight Rank
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Gradient Flow Score
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Effective Rank
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Avg Condition Number
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Flatness Proxy
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Mean Weight
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Weight Skew
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Weight Kurtosis
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Isotropy
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Weight Norm
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Spectral Norm
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Participation Ratio
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Sparsity
2025-05-25 11:36:15,153 - phase-viz - INFO - plot_metric:269 - Added metric: Max Activation
2025-05-25 11:36:17,511 - phase-viz - INFO - plot_metric:192 - User input: done
2025-05-25 11:36:17,511 - phase-viz - INFO - plot_metric:470 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 11:36:17,511 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:36:22,325 - phase-viz - INFO - plot_metric:511 - Successfully computed all metrics
2025-05-25 11:36:22,341 - phase-viz - INFO - plot_metric:524 - Cleared model and metric caches
2025-05-25 11:36:22,341 - phase-viz - INFO - plot_metric:529 - Saved metrics data to state
2025-05-25 11:36:22,341 - phase-viz - INFO - plot_metric:545 - Generating interactive plot
2025-05-25 11:36:22,341 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113622_1mqfquii.html
2025-05-25 11:36:22,341 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113622_1mqfquii.html
2025-05-25 11:36:22,341 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113622_1mqfquii.html
2025-05-25 11:36:22,342 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113622_1mqfquii.html
2025-05-25 11:37:33,846 - phase-viz - INFO - _signal_handler:148 - Received signal 2, cleaning up...
2025-05-25 11:37:33,846 - phase-viz - INFO - cleanup_all_html_files:139 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_113622_1mqfquii.html
2025-05-25 11:37:39,381 - phase-viz - INFO - <module>:565 - Starting phase-viz CLI
2025-05-25 11:37:39,382 - phase-viz - INFO - plot_metric:148 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:37:39,382 - phase-viz - INFO - plot_metric:152 - State loaded successfully
2025-05-25 11:37:39,524 - phase-viz - WARNING - plot_metric:161 - CUDA requested but not available, falling back to CPU
2025-05-25 11:37:39,524 - phase-viz - INFO - plot_metric:172 - Running on CPU
2025-05-25 11:37:45,107 - phase-viz - INFO - plot_metric:192 - User input: help
2025-05-25 11:37:45,108 - phase-viz - WARNING - plot_metric:465 - Unknown metric: help
2025-05-25 11:37:48,361 - phase-viz - INFO - plot_metric:192 - User input: metrics
2025-05-25 11:41:28,526 - phase-viz - INFO - plot_metric:192 - User input: exit
2025-05-25 11:41:28,526 - phase-viz - INFO - plot_metric:202 - User exited
2025-05-25 11:41:48,027 - phase-viz - INFO - <module>:393 - Starting phase-viz CLI
2025-05-25 11:41:48,027 - phase-viz - INFO - plot_metric:148 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:41:48,027 - phase-viz - INFO - plot_metric:152 - State loaded successfully
2025-05-25 11:41:48,168 - phase-viz - WARNING - plot_metric:161 - CUDA requested but not available, falling back to CPU
2025-05-25 11:41:48,168 - phase-viz - INFO - plot_metric:172 - Running on CPU
2025-05-25 11:41:51,658 - phase-viz - INFO - plot_metric:192 - User input: help
2025-05-25 11:41:51,658 - phase-viz - WARNING - plot_metric:293 - Unknown metric: help
2025-05-25 11:41:54,148 - phase-viz - INFO - plot_metric:192 - User input: metrics
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:192 - User input: all
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: L2 Norm
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Weight Entropy
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Layer Connectivity
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Parameter Variance
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Layer Wise Norm Ratio
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Activation Capacity
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Dead Neuron Percentage
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Weight Rank
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Gradient Flow Score
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Effective Rank
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Avg Condition Number
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Flatness Proxy
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Mean Weight
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Weight Skew
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Weight Kurtosis
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Isotropy
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Weight Norm
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Spectral Norm
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Participation Ratio
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Sparsity
2025-05-25 11:41:58,856 - phase-viz - INFO - plot_metric:271 - Added metric: Max Activation
2025-05-25 11:42:00,437 - phase-viz - INFO - plot_metric:192 - User input: done
2025-05-25 11:42:00,437 - phase-viz - INFO - plot_metric:298 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 11:42:00,437 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:42:03,875 - phase-viz - INFO - plot_metric:339 - Successfully computed all metrics
2025-05-25 11:42:03,962 - phase-viz - INFO - plot_metric:352 - Cleared model and metric caches
2025-05-25 11:42:03,963 - phase-viz - INFO - plot_metric:357 - Saved metrics data to state
2025-05-25 11:42:03,963 - phase-viz - INFO - plot_metric:373 - Generating interactive plot
2025-05-25 11:42:03,963 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114203_eqtg0e5m.html
2025-05-25 11:42:03,963 - phase-viz - INFO - start:236 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114203_eqtg0e5m.html
2025-05-25 11:42:03,963 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114203_eqtg0e5m.html
2025-05-25 11:42:03,963 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114203_eqtg0e5m.html
2025-05-25 11:42:19,022 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114203_eqtg0e5m.html
2025-05-25 11:42:19,023 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114203_eqtg0e5m.html
2025-05-25 11:42:19,023 - phase-viz - INFO - plot_metric_interactive:1731 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114203_eqtg0e5m.html
2025-05-25 11:42:19,023 - phase-viz - INFO - plot_metric:379 - Plot generation completed
2025-05-25 11:42:23,778 - phase-viz - INFO - <module>:393 - Starting phase-viz CLI
2025-05-25 11:42:23,779 - phase-viz - INFO - plot_metric:148 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:42:23,779 - phase-viz - INFO - plot_metric:152 - State loaded successfully
2025-05-25 11:42:23,920 - phase-viz - WARNING - plot_metric:161 - CUDA requested but not available, falling back to CPU
2025-05-25 11:42:23,920 - phase-viz - INFO - plot_metric:172 - Running on CPU
2025-05-25 11:42:26,036 - phase-viz - INFO - plot_metric:192 - User input: entropy
2025-05-25 11:42:26,036 - phase-viz - INFO - plot_metric:285 - Added metric: Weight Entropy
2025-05-25 11:42:27,295 - phase-viz - INFO - plot_metric:192 - User input: l2
2025-05-25 11:42:27,295 - phase-viz - INFO - plot_metric:285 - Added metric: L2 Norm
2025-05-25 11:42:33,747 - phase-viz - INFO - plot_metric:192 - User input: spectral
2025-05-25 11:42:33,747 - phase-viz - INFO - plot_metric:285 - Added metric: Spectral Norm
2025-05-25 11:42:37,251 - phase-viz - INFO - plot_metric:192 - User input: sparsity
2025-05-25 11:42:37,251 - phase-viz - INFO - plot_metric:285 - Added metric: Sparsity
2025-05-25 11:42:38,517 - phase-viz - INFO - plot_metric:192 - User input: done
2025-05-25 11:42:38,517 - phase-viz - INFO - plot_metric:298 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-25 11:42:38,518 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:42:40,534 - phase-viz - INFO - plot_metric:339 - Successfully computed all metrics
2025-05-25 11:42:40,627 - phase-viz - INFO - plot_metric:352 - Cleared model and metric caches
2025-05-25 11:42:40,627 - phase-viz - INFO - plot_metric:357 - Saved metrics data to state
2025-05-25 11:42:40,627 - phase-viz - INFO - plot_metric:373 - Generating interactive plot
2025-05-25 11:42:40,627 - phase-viz - INFO - register_html_for_cleanup:122 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114240_l9jkbqsl.html
2025-05-25 11:42:40,627 - phase-viz - INFO - start:236 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114240_l9jkbqsl.html
2025-05-25 11:42:40,627 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114240_l9jkbqsl.html
2025-05-25 11:42:40,628 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114240_l9jkbqsl.html
2025-05-25 11:42:47,781 - phase-viz - INFO - unregister_html_from_cleanup:129 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114240_l9jkbqsl.html
2025-05-25 11:42:47,781 - phase-viz - INFO - do_POST:187 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114240_l9jkbqsl.html
2025-05-25 11:42:47,781 - phase-viz - INFO - plot_metric_interactive:1731 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114240_l9jkbqsl.html
2025-05-25 11:42:47,781 - phase-viz - INFO - plot_metric:379 - Plot generation completed
2025-05-25 11:44:58,922 - phase-viz - INFO - <module>:370 - Starting phase-viz CLI
2025-05-25 11:44:58,923 - phase-viz - INFO - plot_metric:125 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:44:58,923 - phase-viz - INFO - plot_metric:129 - State loaded successfully
2025-05-25 11:44:59,063 - phase-viz - WARNING - plot_metric:138 - CUDA requested but not available, falling back to CPU
2025-05-25 11:44:59,063 - phase-viz - INFO - plot_metric:149 - Running on CPU
2025-05-25 11:45:00,503 - phase-viz - INFO - plot_metric:169 - User input: all
2025-05-25 11:45:00,503 - phase-viz - INFO - plot_metric:248 - Added metric: L2 Norm
2025-05-25 11:45:00,503 - phase-viz - INFO - plot_metric:248 - Added metric: Weight Entropy
2025-05-25 11:45:00,503 - phase-viz - INFO - plot_metric:248 - Added metric: Layer Connectivity
2025-05-25 11:45:00,503 - phase-viz - INFO - plot_metric:248 - Added metric: Parameter Variance
2025-05-25 11:45:00,503 - phase-viz - INFO - plot_metric:248 - Added metric: Layer Wise Norm Ratio
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Activation Capacity
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Dead Neuron Percentage
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Weight Rank
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Gradient Flow Score
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Effective Rank
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Avg Condition Number
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Flatness Proxy
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Mean Weight
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Weight Skew
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Weight Kurtosis
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Isotropy
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Weight Norm
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Spectral Norm
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Participation Ratio
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Sparsity
2025-05-25 11:45:00,504 - phase-viz - INFO - plot_metric:248 - Added metric: Max Activation
2025-05-25 11:45:02,444 - phase-viz - INFO - plot_metric:169 - User input: done
2025-05-25 11:45:02,445 - phase-viz - INFO - plot_metric:275 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 11:45:02,445 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:45:06,132 - phase-viz - INFO - plot_metric:316 - Successfully computed all metrics
2025-05-25 11:45:06,166 - phase-viz - INFO - plot_metric:329 - Cleared model and metric caches
2025-05-25 11:45:06,166 - phase-viz - INFO - plot_metric:334 - Saved metrics data to state
2025-05-25 11:45:06,166 - phase-viz - INFO - plot_metric:350 - Generating interactive plot
2025-05-25 11:45:06,166 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114506_p1ksv0wx.html
2025-05-25 11:45:06,167 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114506_p1ksv0wx.html
2025-05-25 11:45:06,167 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114506_p1ksv0wx.html
2025-05-25 11:45:06,167 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114506_p1ksv0wx.html
2025-05-25 11:45:44,713 - phase-viz - INFO - _signal_handler:172 - Received signal 2, cleaning up...
2025-05-25 11:45:44,713 - phase-viz - INFO - cleanup_all_html_files:163 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114506_p1ksv0wx.html
2025-05-25 11:45:47,853 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 11:45:47,854 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:45:47,854 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 11:45:47,993 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 11:45:47,993 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 11:45:49,391 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 11:45:50,108 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 11:45:50,108 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 11:45:50,108 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:45:56,431 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 11:45:56,451 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 11:45:56,451 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 11:45:56,452 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 11:45:56,452 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114556_dxdymi3j.html
2025-05-25 11:45:56,452 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114556_dxdymi3j.html
2025-05-25 11:45:56,452 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114556_dxdymi3j.html
2025-05-25 11:45:56,452 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114556_dxdymi3j.html
2025-05-25 11:45:57,034 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114556_dxdymi3j.html
2025-05-25 11:45:57,034 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114556_dxdymi3j.html
2025-05-25 11:45:57,034 - phase-viz - INFO - plot_metric_interactive:1731 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_114556_dxdymi3j.html
2025-05-25 11:45:57,034 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 11:50:18,520 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 11:50:18,521 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 11:50:18,521 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 11:50:18,660 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 11:50:18,660 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 11:50:19,741 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 11:50:19,741 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 11:50:19,741 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 11:50:19,741 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 11:50:19,741 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 11:50:19,741 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 11:50:19,741 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 11:50:19,742 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 11:50:20,245 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 11:50:20,245 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 11:50:20,246 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 11:50:23,965 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 11:50:23,975 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 11:50:23,975 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 11:50:23,976 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 11:50:23,976 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_115023_w4kadjw0.html
2025-05-25 11:50:23,976 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_115023_w4kadjw0.html
2025-05-25 11:50:23,976 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_115023_w4kadjw0.html
2025-05-25 11:50:23,976 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_115023_w4kadjw0.html
2025-05-25 11:50:29,338 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_115023_w4kadjw0.html
2025-05-25 11:50:29,338 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_115023_w4kadjw0.html
2025-05-25 11:50:29,339 - phase-viz - INFO - plot_metric_interactive:1731 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_115023_w4kadjw0.html
2025-05-25 11:50:29,339 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 12:08:16,473 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:08:16,474 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:08:16,474 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:08:16,614 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:08:16,614 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:08:18,542 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:08:18,542 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:08:18,547 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:08:18,547 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:08:18,547 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:08:18,547 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:08:18,548 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:08:19,146 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:08:19,146 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:08:19,146 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:08:22,776 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:08:22,871 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:08:22,871 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:08:22,871 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:08:22,872 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_120822_8aubtzwb.html
2025-05-25 12:08:22,872 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_120822_8aubtzwb.html
2025-05-25 12:08:22,872 - phase-viz - INFO - plot_metric_interactive:77 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_120822_8aubtzwb.html
2025-05-25 12:08:22,872 - phase-viz - INFO - plot_metric_interactive:1722 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_120822_8aubtzwb.html
2025-05-25 12:08:25,736 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_120822_8aubtzwb.html
2025-05-25 12:08:25,736 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_120822_8aubtzwb.html
2025-05-25 12:08:25,736 - phase-viz - INFO - plot_metric_interactive:1731 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_120822_8aubtzwb.html
2025-05-25 12:08:25,737 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 12:11:24,621 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:11:24,622 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:11:24,622 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:11:24,762 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:11:24,762 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:11:26,662 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:11:27,334 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:11:27,334 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:11:27,335 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:11:29,472 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:11:29,551 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:11:29,551 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:11:29,551 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:11:29,551 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121129_0fszwyqr.html
2025-05-25 12:11:29,551 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121129_0fszwyqr.html
2025-05-25 12:11:29,551 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121129_0fszwyqr.html
2025-05-25 12:11:29,551 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121129_0fszwyqr.html
2025-05-25 12:11:38,299 - phase-viz - INFO - _signal_handler:172 - Received signal 2, cleaning up...
2025-05-25 12:11:38,300 - phase-viz - INFO - cleanup_all_html_files:163 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121129_0fszwyqr.html
2025-05-25 12:11:40,911 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:11:40,912 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:11:40,912 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:11:41,051 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:11:41,051 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:11:42,905 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:11:43,778 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:11:43,778 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:11:43,778 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:11:46,147 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:11:46,195 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:11:46,196 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:11:46,196 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:11:46,196 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121146_pmw42hfy.html
2025-05-25 12:11:46,196 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121146_pmw42hfy.html
2025-05-25 12:11:46,196 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121146_pmw42hfy.html
2025-05-25 12:11:46,196 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121146_pmw42hfy.html
2025-05-25 12:11:46,743 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121146_pmw42hfy.html
2025-05-25 12:11:46,743 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121146_pmw42hfy.html
2025-05-25 12:11:46,743 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121146_pmw42hfy.html
2025-05-25 12:11:46,743 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 12:12:25,032 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:12:25,032 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:12:25,032 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:12:25,175 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:12:25,175 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:12:26,363 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:12:27,769 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:12:27,769 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:12:27,769 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:12:33,014 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:12:33,100 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:12:33,100 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:12:33,100 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:12:33,101 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121233_0t8kwj7o.html
2025-05-25 12:12:33,101 - phase-viz - INFO - start:260 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121233_0t8kwj7o.html
2025-05-25 12:12:33,101 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121233_0t8kwj7o.html
2025-05-25 12:12:33,101 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121233_0t8kwj7o.html
2025-05-25 12:12:38,998 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121233_0t8kwj7o.html
2025-05-25 12:12:38,998 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121233_0t8kwj7o.html
2025-05-25 12:12:38,998 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121233_0t8kwj7o.html
2025-05-25 12:12:38,998 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 12:13:50,428 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:13:50,429 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:13:50,429 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:13:50,573 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:13:50,573 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:13:52,142 - phase-viz - INFO - plot_metric:147 - User input: al
2025-05-25 12:13:52,142 - phase-viz - WARNING - plot_metric:248 - Unknown metric: al
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:13:53,517 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:13:54,014 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:13:54,014 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:13:54,014 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:13:56,157 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:13:56,233 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:13:56,233 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:13:56,233 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:13:56,234 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121356_65jkro3p.html
2025-05-25 12:13:56,234 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121356_65jkro3p.html
2025-05-25 12:13:56,234 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121356_65jkro3p.html
2025-05-25 12:13:56,234 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121356_65jkro3p.html
2025-05-25 12:14:01,093 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121356_65jkro3p.html
2025-05-25 12:14:01,093 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121356_65jkro3p.html
2025-05-25 12:14:01,094 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121356_65jkro3p.html
2025-05-25 12:14:01,094 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 12:14:15,074 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:14:15,074 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:14:15,074 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:14:15,215 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:14:15,215 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:14:17,610 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:14:17,610 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:14:17,610 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:14:17,610 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:14:17,610 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:14:17,610 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:14:17,610 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:14:17,610 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:14:17,611 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:14:18,096 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:14:18,096 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:14:18,097 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:14:21,914 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:14:21,915 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:14:21,915 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:14:21,915 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:14:21,915 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121421_ept2aq2m.html
2025-05-25 12:14:21,915 - phase-viz - INFO - start:260 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121421_ept2aq2m.html
2025-05-25 12:14:21,915 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121421_ept2aq2m.html
2025-05-25 12:14:21,916 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121421_ept2aq2m.html
2025-05-25 12:14:35,304 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121421_ept2aq2m.html
2025-05-25 12:14:35,304 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121421_ept2aq2m.html
2025-05-25 12:14:35,304 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121421_ept2aq2m.html
2025-05-25 12:14:35,304 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 12:14:38,205 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:14:38,206 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:14:38,206 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:14:38,348 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:14:38,348 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:14:39,803 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:14:39,804 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:14:39,804 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:14:39,804 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:14:39,804 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:14:39,804 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:14:39,804 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:14:40,237 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:14:40,237 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:14:40,237 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:14:44,217 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:14:44,257 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:14:44,257 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:14:44,257 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:14:44,257 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121444_mvsdlcob.html
2025-05-25 12:14:44,258 - phase-viz - INFO - start:260 - Started cleanup server on port 8002 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121444_mvsdlcob.html
2025-05-25 12:14:44,258 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8002 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121444_mvsdlcob.html
2025-05-25 12:14:44,258 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_121444_mvsdlcob.html
2025-05-25 12:22:51,425 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:22:51,426 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:22:51,426 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:22:51,569 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:22:51,569 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:22:53,223 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:22:53,650 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:22:53,652 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:22:53,652 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:22:56,569 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:22:56,578 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:22:56,579 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:22:56,579 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:22:56,579 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122256_9mdx92ul.html
2025-05-25 12:22:56,579 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122256_9mdx92ul.html
2025-05-25 12:22:56,579 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122256_9mdx92ul.html
2025-05-25 12:22:56,579 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122256_9mdx92ul.html
2025-05-25 12:23:04,634 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122256_9mdx92ul.html
2025-05-25 12:23:04,634 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122256_9mdx92ul.html
2025-05-25 12:23:04,634 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122256_9mdx92ul.html
2025-05-25 12:23:04,634 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 12:23:12,792 - phase-viz - INFO - <module>:348 - Starting phase-viz CLI
2025-05-25 12:23:12,792 - phase-viz - INFO - plot_metric:103 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:23:12,792 - phase-viz - INFO - plot_metric:107 - State loaded successfully
2025-05-25 12:23:12,933 - phase-viz - WARNING - plot_metric:116 - CUDA requested but not available, falling back to CPU
2025-05-25 12:23:12,934 - phase-viz - INFO - plot_metric:127 - Running on CPU
2025-05-25 12:23:14,442 - phase-viz - INFO - plot_metric:147 - User input: all
2025-05-25 12:23:14,442 - phase-viz - INFO - plot_metric:226 - Added metric: L2 Norm
2025-05-25 12:23:14,442 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Entropy
2025-05-25 12:23:14,442 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Connectivity
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Parameter Variance
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Activation Capacity
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Dead Neuron Percentage
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Rank
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Gradient Flow Score
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Effective Rank
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Avg Condition Number
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Flatness Proxy
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Mean Weight
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Skew
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Kurtosis
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Isotropy
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Weight Norm
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Spectral Norm
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Participation Ratio
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Sparsity
2025-05-25 12:23:14,443 - phase-viz - INFO - plot_metric:226 - Added metric: Max Activation
2025-05-25 12:23:14,946 - phase-viz - INFO - plot_metric:147 - User input: done
2025-05-25 12:23:14,946 - phase-viz - INFO - plot_metric:253 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:23:14,946 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:23:18,991 - phase-viz - INFO - plot_metric:294 - Successfully computed all metrics
2025-05-25 12:23:19,077 - phase-viz - INFO - plot_metric:307 - Cleared model and metric caches
2025-05-25 12:23:19,077 - phase-viz - INFO - plot_metric:312 - Saved metrics data to state
2025-05-25 12:23:19,077 - phase-viz - INFO - plot_metric:328 - Generating interactive plot
2025-05-25 12:23:19,077 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122319_wp8aptae.html
2025-05-25 12:23:19,078 - phase-viz - INFO - start:260 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122319_wp8aptae.html
2025-05-25 12:23:19,078 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122319_wp8aptae.html
2025-05-25 12:23:19,078 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122319_wp8aptae.html
2025-05-25 12:23:23,599 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122319_wp8aptae.html
2025-05-25 12:23:23,599 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122319_wp8aptae.html
2025-05-25 12:23:23,599 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122319_wp8aptae.html
2025-05-25 12:23:23,599 - phase-viz - INFO - plot_metric:334 - Plot generation completed
2025-05-25 12:24:47,330 - phase-viz - INFO - <module>:351 - Starting phase-viz CLI
2025-05-25 12:24:47,331 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:24:47,331 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 12:24:47,477 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 12:24:47,477 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:148 - User input: all
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: L2 Norm
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Entropy
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Layer Connectivity
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Parameter Variance
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Activation Capacity
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Dead Neuron Percentage
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Rank
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Gradient Flow Score
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Effective Rank
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Avg Condition Number
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Flatness Proxy
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Mean Weight
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Skew
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Kurtosis
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Isotropy
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Norm
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Spectral Norm
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Participation Ratio
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Sparsity
2025-05-25 12:24:49,066 - phase-viz - INFO - plot_metric:228 - Added metric: Max Activation
2025-05-25 12:24:49,549 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 12:24:49,549 - phase-viz - INFO - plot_metric:255 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:24:49,549 - phase-viz - ERROR - plot_metric:299 - Error calculating metrics: compute_metrics_over_checkpoints() got an unexpected keyword argument 'all_metrics'
2025-05-25 12:24:49,649 - phase-viz - ERROR - _err:345 - Fatal error: Error calculating metrics: compute_metrics_over_checkpoints() got an unexpected keyword argument 'all_metrics'
2025-05-25 12:25:42,686 - phase-viz - INFO - <module>:351 - Starting phase-viz CLI
2025-05-25 12:25:42,686 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:25:42,687 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 12:25:42,827 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 12:25:42,827 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 12:25:43,941 - phase-viz - INFO - plot_metric:148 - User input: all
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: L2 Norm
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Entropy
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Layer Connectivity
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Parameter Variance
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Activation Capacity
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Dead Neuron Percentage
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Rank
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Gradient Flow Score
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Effective Rank
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Avg Condition Number
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Flatness Proxy
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Mean Weight
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Skew
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Kurtosis
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Isotropy
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Norm
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Spectral Norm
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Participation Ratio
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Sparsity
2025-05-25 12:25:43,942 - phase-viz - INFO - plot_metric:228 - Added metric: Max Activation
2025-05-25 12:25:44,483 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 12:25:44,483 - phase-viz - INFO - plot_metric:255 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:25:44,484 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:25:49,520 - phase-viz - INFO - plot_metric:296 - Successfully computed all metrics
2025-05-25 12:25:49,617 - phase-viz - INFO - plot_metric:309 - Cleared model and metric caches
2025-05-25 12:25:49,617 - phase-viz - INFO - plot_metric:314 - Saved metrics data to state
2025-05-25 12:25:49,617 - phase-viz - INFO - plot_metric:330 - Generating interactive plot
2025-05-25 12:25:49,617 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122549_1lsuah5y.html
2025-05-25 12:25:49,617 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122549_1lsuah5y.html
2025-05-25 12:25:49,617 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122549_1lsuah5y.html
2025-05-25 12:25:49,618 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122549_1lsuah5y.html
2025-05-25 12:25:53,230 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122549_1lsuah5y.html
2025-05-25 12:25:53,230 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122549_1lsuah5y.html
2025-05-25 12:25:53,230 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122549_1lsuah5y.html
2025-05-25 12:25:53,231 - phase-viz - INFO - plot_metric:337 - Plot generation completed
2025-05-25 12:25:56,057 - phase-viz - INFO - <module>:351 - Starting phase-viz CLI
2025-05-25 12:25:56,058 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:25:56,058 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 12:25:56,197 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 12:25:56,197 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 12:25:57,477 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 12:25:57,477 - phase-viz - INFO - plot_metric:242 - Added metric: Weight Entropy
2025-05-25 12:25:59,967 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 12:25:59,967 - phase-viz - INFO - plot_metric:242 - Added metric: L2 Norm
2025-05-25 12:26:00,973 - phase-viz - INFO - plot_metric:148 - User input: spectral
2025-05-25 12:26:00,974 - phase-viz - INFO - plot_metric:242 - Added metric: Spectral Norm
2025-05-25 12:26:01,896 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 12:26:01,896 - phase-viz - INFO - plot_metric:255 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-25 12:26:01,896 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:26:03,249 - phase-viz - INFO - plot_metric:296 - Successfully computed all metrics
2025-05-25 12:26:03,311 - phase-viz - INFO - plot_metric:309 - Cleared model and metric caches
2025-05-25 12:26:03,311 - phase-viz - INFO - plot_metric:314 - Saved metrics data to state
2025-05-25 12:26:03,311 - phase-viz - INFO - plot_metric:330 - Generating interactive plot
2025-05-25 12:26:03,311 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122603_vix34qls.html
2025-05-25 12:26:03,311 - phase-viz - INFO - start:260 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122603_vix34qls.html
2025-05-25 12:26:03,311 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122603_vix34qls.html
2025-05-25 12:26:03,312 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122603_vix34qls.html
2025-05-25 12:26:05,795 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122603_vix34qls.html
2025-05-25 12:26:05,796 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122603_vix34qls.html
2025-05-25 12:26:05,796 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122603_vix34qls.html
2025-05-25 12:26:05,796 - phase-viz - INFO - plot_metric:337 - Plot generation completed
2025-05-25 12:26:19,760 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 12:26:19,761 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:26:19,761 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 12:26:19,903 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 12:26:19,903 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 12:26:22,835 - phase-viz - INFO - plot_metric:148 - User input: all
2025-05-25 12:26:22,835 - phase-viz - INFO - plot_metric:228 - Added metric: L2 Norm
2025-05-25 12:26:48,168 - phase-viz - INFO - _signal_handler:172 - Received signal 2, cleaning up...
2025-05-25 12:26:53,126 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 12:26:53,127 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:26:53,127 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 12:26:53,268 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 12:26:53,268 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:148 - User input: all
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: L2 Norm
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Entropy
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Layer Connectivity
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Parameter Variance
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Layer Wise Norm Ratio
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Activation Capacity
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Dead Neuron Percentage
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Rank
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Gradient Flow Score
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Effective Rank
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Avg Condition Number
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Flatness Proxy
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Mean Weight
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Skew
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Kurtosis
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Isotropy
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Norm
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Spectral Norm
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Participation Ratio
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Sparsity
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:228 - Added metric: Max Activation
2025-05-25 12:26:54,205 - phase-viz - INFO - plot_metric:256 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 12:26:54,205 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:26:58,316 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 12:26:58,326 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 12:26:58,326 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 12:26:58,326 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 12:26:58,326 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122658_i0k06lcs.html
2025-05-25 12:26:58,327 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122658_i0k06lcs.html
2025-05-25 12:26:58,327 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122658_i0k06lcs.html
2025-05-25 12:26:58,327 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122658_i0k06lcs.html
2025-05-25 12:27:01,460 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122658_i0k06lcs.html
2025-05-25 12:27:01,460 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122658_i0k06lcs.html
2025-05-25 12:27:01,460 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122658_i0k06lcs.html
2025-05-25 12:27:01,460 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 12:27:09,269 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 12:27:09,270 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 12:27:09,270 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 12:27:09,411 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 12:27:09,411 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 12:27:10,518 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 12:27:10,518 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 12:27:11,703 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 12:27:11,703 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 12:27:15,477 - phase-viz - INFO - plot_metric:148 - User input: sparsity
2025-05-25 12:27:15,477 - phase-viz - INFO - plot_metric:243 - Added metric: Sparsity
2025-05-25 12:27:16,198 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 12:27:16,198 - phase-viz - INFO - plot_metric:256 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-25 12:27:16,198 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 12:27:16,300 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 12:27:16,399 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 12:27:16,399 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 12:27:16,399 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 12:27:16,399 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122716_en8wlqk1.html
2025-05-25 12:27:16,399 - phase-viz - INFO - start:260 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122716_en8wlqk1.html
2025-05-25 12:27:16,399 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122716_en8wlqk1.html
2025-05-25 12:27:16,399 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122716_en8wlqk1.html
2025-05-25 12:27:19,022 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122716_en8wlqk1.html
2025-05-25 12:27:19,022 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122716_en8wlqk1.html
2025-05-25 12:27:19,022 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_122716_en8wlqk1.html
2025-05-25 12:27:19,022 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 15:44:56,476 - phase-viz - INFO - <module>:353 - Starting phase-viz CLI
2025-05-25 15:44:56,477 - phase-viz - INFO - plot_metric:105 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 15:44:56,477 - phase-viz - INFO - plot_metric:109 - State loaded successfully
2025-05-25 15:44:56,619 - phase-viz - WARNING - plot_metric:118 - CUDA requested but not available, falling back to CPU
2025-05-25 15:44:56,619 - phase-viz - INFO - plot_metric:129 - Running on CPU
2025-05-25 15:44:59,715 - phase-viz - INFO - plot_metric:149 - User input: metrics
2025-05-25 15:45:03,637 - phase-viz - INFO - plot_metric:149 - User input: l2
2025-05-25 15:45:03,637 - phase-viz - INFO - plot_metric:244 - Added metric: L2 Norm
2025-05-25 15:45:04,925 - phase-viz - INFO - plot_metric:149 - User input: rank
2025-05-25 15:45:04,925 - phase-viz - INFO - plot_metric:244 - Added metric: Weight Rank
2025-05-25 15:45:06,316 - phase-viz - INFO - plot_metric:149 - User input: condition
2025-05-25 15:45:06,316 - phase-viz - INFO - plot_metric:244 - Added metric: Avg Condition Number
2025-05-25 15:45:09,148 - phase-viz - INFO - plot_metric:149 - User input: skew
2025-05-25 15:45:09,148 - phase-viz - INFO - plot_metric:244 - Added metric: Weight Skew
2025-05-25 15:45:09,848 - phase-viz - INFO - plot_metric:149 - User input: mean
2025-05-25 15:45:09,848 - phase-viz - INFO - plot_metric:244 - Added metric: Mean Weight
2025-05-25 15:45:16,301 - phase-viz - INFO - plot_metric:149 - User input: spectral
2025-05-25 15:45:16,301 - phase-viz - INFO - plot_metric:244 - Added metric: Spectral Norm
2025-05-25 15:45:19,025 - phase-viz - INFO - plot_metric:149 - User input: sparsity
2025-05-25 15:45:19,025 - phase-viz - INFO - plot_metric:244 - Added metric: Sparsity
2025-05-25 15:45:20,703 - phase-viz - INFO - plot_metric:149 - User input: isotropy
2025-05-25 15:45:20,703 - phase-viz - INFO - plot_metric:244 - Added metric: Isotropy
2025-05-25 15:45:25,925 - phase-viz - INFO - plot_metric:149 - User input: done
2025-05-25 15:45:25,925 - phase-viz - INFO - plot_metric:257 - Starting calculation of 8 metrics across 4 checkpoints
2025-05-25 15:45:25,925 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 15:45:28,922 - phase-viz - INFO - plot_metric:298 - Successfully computed all metrics
2025-05-25 15:45:28,947 - phase-viz - INFO - plot_metric:311 - Cleared model and metric caches
2025-05-25 15:45:28,947 - phase-viz - INFO - plot_metric:316 - Saved metrics data to state
2025-05-25 15:45:28,947 - phase-viz - INFO - plot_metric:332 - Generating interactive plot
2025-05-25 15:45:28,948 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154528_tqkblz1b.html
2025-05-25 15:45:28,948 - phase-viz - INFO - start:260 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154528_tqkblz1b.html
2025-05-25 15:45:28,948 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154528_tqkblz1b.html
2025-05-25 15:45:28,948 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154528_tqkblz1b.html
2025-05-25 15:45:36,763 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154528_tqkblz1b.html
2025-05-25 15:45:36,763 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154528_tqkblz1b.html
2025-05-25 15:45:36,763 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154528_tqkblz1b.html
2025-05-25 15:45:36,763 - phase-viz - INFO - plot_metric:339 - Plot generation completed
2025-05-25 15:45:40,765 - phase-viz - INFO - <module>:353 - Starting phase-viz CLI
2025-05-25 15:45:40,766 - phase-viz - INFO - plot_metric:105 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 15:45:40,766 - phase-viz - INFO - plot_metric:109 - State loaded successfully
2025-05-25 15:45:40,907 - phase-viz - WARNING - plot_metric:118 - CUDA requested but not available, falling back to CPU
2025-05-25 15:45:40,907 - phase-viz - INFO - plot_metric:129 - Running on CPU
2025-05-25 15:45:43,241 - phase-viz - INFO - plot_metric:149 - User input: sparsity
2025-05-25 15:45:43,241 - phase-viz - INFO - plot_metric:244 - Added metric: Sparsity
2025-05-25 15:45:45,130 - phase-viz - INFO - plot_metric:149 - User input: mean
2025-05-25 15:45:45,130 - phase-viz - INFO - plot_metric:244 - Added metric: Mean Weight
2025-05-25 15:45:46,813 - phase-viz - INFO - plot_metric:149 - User input: isotropy
2025-05-25 15:45:46,813 - phase-viz - INFO - plot_metric:244 - Added metric: Isotropy
2025-05-25 15:45:49,496 - phase-viz - INFO - plot_metric:149 - User input: kurtosis
2025-05-25 15:45:49,496 - phase-viz - INFO - plot_metric:244 - Added metric: Weight Kurtosis
2025-05-25 15:45:52,001 - phase-viz - INFO - plot_metric:149 - User input: l2
2025-05-25 15:45:52,001 - phase-viz - INFO - plot_metric:244 - Added metric: L2 Norm
2025-05-25 15:45:53,096 - phase-viz - INFO - plot_metric:149 - User input: done
2025-05-25 15:45:53,096 - phase-viz - INFO - plot_metric:257 - Starting calculation of 5 metrics across 4 checkpoints
2025-05-25 15:45:53,096 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 15:45:53,313 - phase-viz - INFO - plot_metric:298 - Successfully computed all metrics
2025-05-25 15:45:53,399 - phase-viz - INFO - plot_metric:311 - Cleared model and metric caches
2025-05-25 15:45:53,400 - phase-viz - INFO - plot_metric:316 - Saved metrics data to state
2025-05-25 15:45:53,400 - phase-viz - INFO - plot_metric:332 - Generating interactive plot
2025-05-25 15:45:53,400 - phase-viz - INFO - register_html_for_cleanup:146 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154553_7d5a3g8x.html
2025-05-25 15:45:53,400 - phase-viz - INFO - start:260 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154553_7d5a3g8x.html
2025-05-25 15:45:53,400 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154553_7d5a3g8x.html
2025-05-25 15:45:53,400 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154553_7d5a3g8x.html
2025-05-25 15:46:02,944 - phase-viz - INFO - unregister_html_from_cleanup:153 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154553_7d5a3g8x.html
2025-05-25 15:46:02,945 - phase-viz - INFO - do_POST:211 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154553_7d5a3g8x.html
2025-05-25 15:46:02,945 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154553_7d5a3g8x.html
2025-05-25 15:46:02,945 - phase-viz - INFO - plot_metric:339 - Plot generation completed
2025-05-25 15:49:39,887 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 15:49:39,888 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 15:49:39,888 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 15:49:40,030 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 15:49:40,030 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 15:49:41,463 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 15:49:41,463 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 15:49:42,780 - phase-viz - INFO - plot_metric:148 - User input: sparsity
2025-05-25 15:49:42,780 - phase-viz - INFO - plot_metric:243 - Added metric: Sparsity
2025-05-25 15:49:45,917 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 15:49:45,917 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 15:49:47,322 - phase-viz - INFO - plot_metric:148 - User input: variance
2025-05-25 15:49:47,322 - phase-viz - INFO - plot_metric:243 - Added metric: Parameter Variance
2025-05-25 15:49:48,247 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 15:49:48,247 - phase-viz - INFO - plot_metric:256 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-25 15:49:48,248 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 15:49:48,355 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 15:49:48,448 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 15:49:48,448 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 15:49:48,449 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 15:49:48,449 - phase-viz - INFO - register_html_for_cleanup:147 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154948_bvnv89zu.html
2025-05-25 15:49:48,449 - phase-viz - INFO - start:261 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154948_bvnv89zu.html
2025-05-25 15:49:48,449 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154948_bvnv89zu.html
2025-05-25 15:49:48,449 - phase-viz - INFO - plot_metric_interactive:1725 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154948_bvnv89zu.html
2025-05-25 15:49:57,158 - phase-viz - INFO - unregister_html_from_cleanup:154 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154948_bvnv89zu.html
2025-05-25 15:49:57,158 - phase-viz - INFO - do_POST:212 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154948_bvnv89zu.html
2025-05-25 15:49:57,158 - phase-viz - INFO - plot_metric_interactive:1734 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_154948_bvnv89zu.html
2025-05-25 15:49:57,158 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 16:00:36,359 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:00:36,360 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:00:36,360 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:00:36,498 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:00:36,498 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:00:41,141 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:00:41,142 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:00:43,718 - phase-viz - INFO - plot_metric:148 - User input: sparsity
2025-05-25 16:00:43,718 - phase-viz - INFO - plot_metric:243 - Added metric: Sparsity
2025-05-25 16:00:44,882 - phase-viz - INFO - plot_metric:148 - User input: variance
2025-05-25 16:00:44,882 - phase-viz - INFO - plot_metric:243 - Added metric: Parameter Variance
2025-05-25 16:00:48,245 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:00:48,245 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:00:48,767 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:00:48,767 - phase-viz - INFO - plot_metric:256 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-25 16:00:48,768 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:00:48,863 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:00:48,868 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:00:48,868 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:00:48,868 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:00:48,868 - phase-viz - ERROR - plot_metric:340 - Error generating plot: plot_metric_interactive() got an unexpected keyword argument 'all_metrics'
2025-05-25 16:00:48,868 - phase-viz - ERROR - _err:346 - Fatal error: Error generating plot: plot_metric_interactive() got an unexpected keyword argument 'all_metrics'
2025-05-25 16:07:22,529 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:07:22,530 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:07:22,530 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:07:22,672 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:07:22,672 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:07:24,356 - phase-viz - INFO - plot_metric:148 - User input: all
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: L2 Norm
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Entropy
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Layer Connectivity
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Parameter Variance
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Layer Wise Norm Ratio
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Activation Capacity
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Dead Neuron Percentage
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Rank
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Gradient Flow Score
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Effective Rank
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Avg Condition Number
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Flatness Proxy
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Mean Weight
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Skew
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Kurtosis
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Isotropy
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Weight Norm
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Spectral Norm
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Participation Ratio
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Sparsity
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:228 - Added metric: Max Activation
2025-05-25 16:07:24,357 - phase-viz - INFO - plot_metric:256 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-25 16:07:24,357 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:07:29,496 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:07:29,592 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:07:29,592 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:07:29,592 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:07:29,593 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160729_qcgxdqk6.html
2025-05-25 16:07:29,593 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160729_qcgxdqk6.html
2025-05-25 16:07:29,593 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160729_qcgxdqk6.html
2025-05-25 16:07:29,593 - phase-viz - INFO - plot_metric_interactive:1827 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160729_qcgxdqk6.html
2025-05-25 16:07:39,749 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160729_qcgxdqk6.html
2025-05-25 16:07:39,749 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160729_qcgxdqk6.html
2025-05-25 16:07:39,749 - phase-viz - INFO - plot_metric_interactive:1836 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160729_qcgxdqk6.html
2025-05-25 16:07:39,749 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 16:07:46,658 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:07:46,659 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:07:46,659 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:07:46,798 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:07:46,798 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:07:48,675 - phase-viz - INFO - plot_metric:148 - User input: isotropy
2025-05-25 16:07:48,675 - phase-viz - INFO - plot_metric:243 - Added metric: Isotropy
2025-05-25 16:07:54,352 - phase-viz - INFO - plot_metric:148 - User input: sparsity
2025-05-25 16:07:54,352 - phase-viz - INFO - plot_metric:243 - Added metric: Sparsity
2025-05-25 16:07:58,760 - phase-viz - INFO - plot_metric:148 - User input: weight rank
2025-05-25 16:07:58,760 - phase-viz - WARNING - plot_metric:251 - Unknown metric: weight rank
2025-05-25 16:08:00,363 - phase-viz - INFO - plot_metric:148 - User input: rank
2025-05-25 16:08:00,363 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Rank
2025-05-25 16:08:04,884 - phase-viz - INFO - plot_metric:148 - User input: gradient_flow
2025-05-25 16:08:04,884 - phase-viz - INFO - plot_metric:243 - Added metric: Gradient Flow Score
2025-05-25 16:08:06,139 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:08:06,140 - phase-viz - INFO - plot_metric:256 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-25 16:08:06,140 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:08:07,350 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:08:07,354 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:08:07,354 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:08:07,355 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:08:07,355 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160807_m7a0gy74.html
2025-05-25 16:08:07,355 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160807_m7a0gy74.html
2025-05-25 16:08:07,355 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160807_m7a0gy74.html
2025-05-25 16:08:07,355 - phase-viz - INFO - plot_metric_interactive:1827 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160807_m7a0gy74.html
2025-05-25 16:11:03,461 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-25 16:11:03,461 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_160807_m7a0gy74.html
2025-05-25 16:11:06,502 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:11:06,503 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:11:06,503 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:11:06,640 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:11:06,640 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:11:11,434 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:11:11,434 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:11:13,962 - phase-viz - INFO - plot_metric:148 - User input: spectral
2025-05-25 16:11:13,962 - phase-viz - INFO - plot_metric:243 - Added metric: Spectral Norm
2025-05-25 16:11:16,594 - phase-viz - INFO - plot_metric:148 - User input: weight_rank
2025-05-25 16:11:16,594 - phase-viz - WARNING - plot_metric:251 - Unknown metric: weight_rank
2025-05-25 16:11:18,542 - phase-viz - INFO - plot_metric:148 - User input: rank
2025-05-25 16:11:18,542 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Rank
2025-05-25 16:11:19,386 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:11:19,386 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:11:19,806 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:11:19,806 - phase-viz - INFO - plot_metric:256 - Starting calculation of 4 metrics across 4 checkpoints
2025-05-25 16:11:19,806 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:11:21,715 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:11:21,728 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:11:21,728 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:11:21,728 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:11:21,728 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161121_11bc4irb.html
2025-05-25 16:11:21,728 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161121_11bc4irb.html
2025-05-25 16:11:21,728 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161121_11bc4irb.html
2025-05-25 16:11:21,729 - phase-viz - INFO - plot_metric_interactive:1827 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161121_11bc4irb.html
2025-05-25 16:11:51,810 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161121_11bc4irb.html
2025-05-25 16:11:51,810 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161121_11bc4irb.html
2025-05-25 16:11:51,810 - phase-viz - INFO - plot_metric_interactive:1836 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161121_11bc4irb.html
2025-05-25 16:11:51,810 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 16:12:51,889 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:12:51,890 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:12:51,890 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:12:52,030 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:12:52,031 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:12:54,275 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:12:54,275 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:12:56,637 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:12:56,637 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:12:57,860 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:12:57,860 - phase-viz - INFO - plot_metric:256 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-25 16:12:57,861 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:12:57,940 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:12:57,961 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:12:57,961 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:12:57,961 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:12:57,962 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161257_7davar9w.html
2025-05-25 16:12:57,962 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161257_7davar9w.html
2025-05-25 16:12:57,962 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161257_7davar9w.html
2025-05-25 16:12:57,962 - phase-viz - INFO - plot_metric_interactive:1827 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161257_7davar9w.html
2025-05-25 16:13:13,742 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161257_7davar9w.html
2025-05-25 16:13:13,742 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161257_7davar9w.html
2025-05-25 16:13:13,742 - phase-viz - INFO - plot_metric_interactive:1836 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161257_7davar9w.html
2025-05-25 16:13:13,742 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 16:16:24,716 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:16:24,717 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:16:24,717 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:16:24,855 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:16:24,856 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:16:26,978 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:16:26,978 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:16:28,742 - phase-viz - INFO - plot_metric:148 - User input: weight_rank
2025-05-25 16:16:28,742 - phase-viz - WARNING - plot_metric:251 - Unknown metric: weight_rank
2025-05-25 16:16:30,712 - phase-viz - INFO - plot_metric:148 - User input: rank
2025-05-25 16:16:30,713 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Rank
2025-05-25 16:16:31,524 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:16:31,524 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:16:32,826 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:16:32,826 - phase-viz - INFO - plot_metric:256 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-25 16:16:32,826 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:16:33,531 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:16:33,632 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:16:33,632 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:16:33,632 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:16:33,632 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161633_xqtfissz.html
2025-05-25 16:16:33,632 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161633_xqtfissz.html
2025-05-25 16:16:33,632 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161633_xqtfissz.html
2025-05-25 16:16:33,633 - phase-viz - INFO - plot_metric_interactive:1838 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161633_xqtfissz.html
2025-05-25 16:17:01,247 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-25 16:17:01,247 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161633_xqtfissz.html
2025-05-25 16:17:03,837 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:17:03,837 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:17:03,837 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:17:03,976 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:17:03,977 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:17:05,288 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:17:05,288 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:17:08,226 - phase-viz - INFO - plot_metric:148 - User input: rank
2025-05-25 16:17:08,226 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Rank
2025-05-25 16:17:09,092 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:17:09,092 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:17:09,514 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:17:09,514 - phase-viz - INFO - plot_metric:256 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-25 16:17:09,514 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:17:10,309 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:17:10,331 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:17:10,331 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:17:10,331 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:17:10,331 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161710_ototnk2a.html
2025-05-25 16:17:10,332 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161710_ototnk2a.html
2025-05-25 16:17:10,332 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161710_ototnk2a.html
2025-05-25 16:17:10,332 - phase-viz - INFO - plot_metric_interactive:1838 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161710_ototnk2a.html
2025-05-25 16:17:24,919 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-25 16:17:24,919 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161710_ototnk2a.html
2025-05-25 16:17:26,972 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:17:26,972 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:17:26,972 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:17:27,112 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:17:27,113 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:17:28,327 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:17:28,327 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:17:29,008 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:17:29,008 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:17:32,719 - phase-viz - INFO - plot_metric:148 - User input: rank
2025-05-25 16:17:32,719 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Rank
2025-05-25 16:17:33,109 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:17:33,109 - phase-viz - INFO - plot_metric:256 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-25 16:17:33,109 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:17:34,340 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:17:34,416 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:17:34,416 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:17:34,416 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:17:34,417 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161734_nu1y719q.html
2025-05-25 16:17:34,417 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161734_nu1y719q.html
2025-05-25 16:17:34,417 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161734_nu1y719q.html
2025-05-25 16:17:34,417 - phase-viz - INFO - plot_metric_interactive:1838 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161734_nu1y719q.html
2025-05-25 16:18:12,408 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-25 16:18:12,408 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161734_nu1y719q.html
2025-05-25 16:18:15,602 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:18:15,603 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:18:15,603 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:18:15,742 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:18:15,743 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:18:17,140 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:18:17,140 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:18:18,801 - phase-viz - INFO - plot_metric:148 - User input: weight_rank
2025-05-25 16:18:18,801 - phase-viz - WARNING - plot_metric:251 - Unknown metric: weight_rank
2025-05-25 16:18:20,794 - phase-viz - INFO - plot_metric:148 - User input: rank
2025-05-25 16:18:20,794 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Rank
2025-05-25 16:18:21,141 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:18:21,141 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:18:21,621 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:18:21,622 - phase-viz - INFO - plot_metric:256 - Starting calculation of 3 metrics across 4 checkpoints
2025-05-25 16:18:21,622 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:18:22,223 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:18:22,229 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:18:22,230 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:18:22,230 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:18:22,230 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161822_ptxq7pf3.html
2025-05-25 16:18:22,231 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161822_ptxq7pf3.html
2025-05-25 16:18:22,231 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161822_ptxq7pf3.html
2025-05-25 16:18:22,231 - phase-viz - INFO - plot_metric_interactive:1827 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161822_ptxq7pf3.html
2025-05-25 16:18:23,024 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161822_ptxq7pf3.html
2025-05-25 16:18:23,024 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161822_ptxq7pf3.html
2025-05-25 16:18:23,025 - phase-viz - INFO - plot_metric_interactive:1836 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161822_ptxq7pf3.html
2025-05-25 16:18:23,025 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 16:19:01,253 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:19:01,253 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:19:01,253 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:19:01,391 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:19:01,392 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:19:03,012 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:19:03,012 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:19:03,747 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:19:03,747 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:19:04,104 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:19:04,104 - phase-viz - INFO - plot_metric:256 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-25 16:19:04,105 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:19:04,187 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:19:04,205 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:19:04,206 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:19:04,206 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:19:04,206 - phase-viz - ERROR - plot_metric:340 - Error generating plot: plot_metric_interactive() got an unexpected keyword argument 'many_metrics'
2025-05-25 16:19:04,206 - phase-viz - ERROR - _err:346 - Fatal error: Error generating plot: plot_metric_interactive() got an unexpected keyword argument 'many_metrics'
2025-05-25 16:19:26,055 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:19:26,056 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:19:26,056 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:19:26,198 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:19:26,198 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:19:26,645 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:19:26,646 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:19:27,158 - phase-viz - INFO - plot_metric:148 - User input: rank
2025-05-25 16:19:27,159 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Rank
2025-05-25 16:19:27,508 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:19:27,508 - phase-viz - INFO - plot_metric:256 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-25 16:19:27,509 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:19:28,617 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:19:28,621 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:19:28,621 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:19:28,621 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:19:28,622 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161928_b9l0h4ek.html
2025-05-25 16:19:28,622 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161928_b9l0h4ek.html
2025-05-25 16:19:28,622 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161928_b9l0h4ek.html
2025-05-25 16:19:28,622 - phase-viz - INFO - plot_metric_interactive:1827 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161928_b9l0h4ek.html
2025-05-25 16:20:08,642 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161928_b9l0h4ek.html
2025-05-25 16:20:08,642 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161928_b9l0h4ek.html
2025-05-25 16:20:08,642 - phase-viz - INFO - plot_metric_interactive:1836 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_161928_b9l0h4ek.html
2025-05-25 16:20:08,643 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 16:48:37,798 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:48:37,799 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:48:37,799 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:48:37,940 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:48:37,940 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:48:38,906 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:48:38,906 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:48:40,230 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:48:40,230 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:48:41,020 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:48:41,020 - phase-viz - INFO - plot_metric:256 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-25 16:48:41,020 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:48:41,105 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:48:41,121 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:48:41,121 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:48:41,121 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:48:41,121 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164841_e5jib3az.html
2025-05-25 16:48:41,122 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164841_e5jib3az.html
2025-05-25 16:48:41,122 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164841_e5jib3az.html
2025-05-25 16:48:41,122 - phase-viz - INFO - plot_metric_interactive:1830 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164841_e5jib3az.html
2025-05-25 16:49:00,184 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-25 16:49:00,185 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164841_e5jib3az.html
2025-05-25 16:49:05,894 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:49:05,895 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:49:05,895 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:49:06,038 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:49:06,038 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:49:07,324 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:49:07,325 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:49:08,387 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:49:08,388 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:49:08,922 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:49:08,922 - phase-viz - INFO - plot_metric:256 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-25 16:49:08,922 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:49:09,006 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:49:09,022 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:49:09,023 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:49:09,023 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:49:09,023 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164909_qmotgonh.html
2025-05-25 16:49:09,023 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164909_qmotgonh.html
2025-05-25 16:49:09,023 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164909_qmotgonh.html
2025-05-25 16:49:09,023 - phase-viz - INFO - plot_metric_interactive:1829 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164909_qmotgonh.html
2025-05-25 16:49:29,647 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164909_qmotgonh.html
2025-05-25 16:49:29,647 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164909_qmotgonh.html
2025-05-25 16:49:29,648 - phase-viz - INFO - plot_metric_interactive:1838 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_164909_qmotgonh.html
2025-05-25 16:49:29,648 - phase-viz - INFO - plot_metric:338 - Plot generation completed
2025-05-25 16:50:11,344 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:50:11,345 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:50:11,345 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:50:11,485 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:50:11,485 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:50:12,481 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:50:12,481 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:50:13,341 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:50:13,341 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:50:13,789 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:50:13,789 - phase-viz - INFO - plot_metric:256 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-25 16:50:13,790 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:50:13,874 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:50:13,890 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:50:13,890 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:50:13,891 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:50:13,891 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165013_a5e67c1d.html
2025-05-25 16:50:13,891 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165013_a5e67c1d.html
2025-05-25 16:50:13,891 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165013_a5e67c1d.html
2025-05-25 16:50:13,891 - phase-viz - INFO - plot_metric_interactive:1827 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165013_a5e67c1d.html
2025-05-25 16:50:38,594 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-25 16:50:38,594 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165013_a5e67c1d.html
2025-05-25 16:50:41,192 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:50:41,193 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:50:41,193 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:50:41,335 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:50:41,335 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:50:42,127 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:50:42,127 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:50:43,090 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:50:43,090 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:50:43,430 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:50:43,430 - phase-viz - INFO - plot_metric:256 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-25 16:50:43,431 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:50:43,513 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:50:43,531 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:50:43,531 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:50:43,531 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:50:43,532 - phase-viz - ERROR - plot_metric:340 - Error generating plot: plot_metric_interactive() got an unexpected keyword argument 'many_metrics'
2025-05-25 16:50:43,532 - phase-viz - ERROR - _err:346 - Fatal error: Error generating plot: plot_metric_interactive() got an unexpected keyword argument 'many_metrics'
2025-05-25 16:51:05,086 - phase-viz - INFO - <module>:352 - Starting phase-viz CLI
2025-05-25 16:51:05,087 - phase-viz - INFO - plot_metric:104 - Starting plot-metric command with device=cuda, parallel=True
2025-05-25 16:51:05,087 - phase-viz - INFO - plot_metric:108 - State loaded successfully
2025-05-25 16:51:05,224 - phase-viz - WARNING - plot_metric:117 - CUDA requested but not available, falling back to CPU
2025-05-25 16:51:05,224 - phase-viz - INFO - plot_metric:128 - Running on CPU
2025-05-25 16:51:06,016 - phase-viz - INFO - plot_metric:148 - User input: l2
2025-05-25 16:51:06,016 - phase-viz - INFO - plot_metric:243 - Added metric: L2 Norm
2025-05-25 16:51:08,338 - phase-viz - INFO - plot_metric:148 - User input: norm
2025-05-25 16:51:08,338 - phase-viz - WARNING - plot_metric:251 - Unknown metric: norm
2025-05-25 16:51:11,867 - phase-viz - INFO - plot_metric:148 - User input: entropy
2025-05-25 16:51:11,868 - phase-viz - INFO - plot_metric:243 - Added metric: Weight Entropy
2025-05-25 16:51:12,496 - phase-viz - INFO - plot_metric:148 - User input: done
2025-05-25 16:51:12,496 - phase-viz - INFO - plot_metric:256 - Starting calculation of 2 metrics across 4 checkpoints
2025-05-25 16:51:12,497 - phase-viz - INFO - compute_metrics_over_checkpoints:325 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-25 16:51:12,585 - phase-viz - INFO - plot_metric:297 - Successfully computed all metrics
2025-05-25 16:51:12,597 - phase-viz - INFO - plot_metric:310 - Cleared model and metric caches
2025-05-25 16:51:12,597 - phase-viz - INFO - plot_metric:315 - Saved metrics data to state
2025-05-25 16:51:12,597 - phase-viz - INFO - plot_metric:331 - Generating interactive plot
2025-05-25 16:51:12,598 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165112_wx664pnb.html
2025-05-25 16:51:12,598 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165112_wx664pnb.html
2025-05-25 16:51:12,598 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165112_wx664pnb.html
2025-05-25 16:51:12,598 - phase-viz - INFO - plot_metric_interactive:1827 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165112_wx664pnb.html
2025-05-25 16:52:27,485 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-25 16:52:27,485 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250525_165112_wx664pnb.html
