2025-05-27 08:03:11,682 - phase-viz - INFO - load_dir:54 - Model file: examples/grokking.py
2025-05-27 08:03:11,682 - phase-viz - INFO - load_dir:55 - Class name: MLP
2025-05-27 08:03:11,683 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:03:11,683 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:03:14,242 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:03:14,243 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:03:14,243 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:03:14,386 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:03:14,386 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:03:15,376 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 08:03:15,377 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:03:16,063 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:03:16,088 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:03:16,088 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:03:16,088 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:03:16,088 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:03:16,089 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:03:16,089 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:03:16,089 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:05:34,265 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:05:34,266 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:05:34,266 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:05:34,266 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:10:51,974 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:53 - Loading directory: examples/DLN_checkpoints
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:54 - Model file: examples/DLN.py
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:55 - Class name: DLN
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:10:55,423 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:10:55,424 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:10:55,424 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:10:55,562 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:10:55,562 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 08:10:57,368 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,424 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:10:57,468 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:10:57,468 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:10:57,469 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:10:57,469 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:10:57,469 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:10:57,469 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:10:57,469 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:11:04,602 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:11:04,602 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:11:04,602 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:11:04,603 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:13:14,387 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:13:14,388 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:13:14,388 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:13:14,527 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:13:14,527 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:13:15,252 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:13:15,253 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:13:18,895 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:13:18,895 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:13:18,895 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,947 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:13:18,995 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:13:18,996 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:13:18,996 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:13:18,996 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:18,996 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:18,996 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:18,997 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:21,511 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:21,511 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:21,511 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:21,511 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:14:46,911 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:14:46,912 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:14:46,912 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:14:47,051 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:14:47,052 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:14:48,008 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:14:48,008 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:14:48,548 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:14:48,548 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:14:48,548 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,597 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:14:48,648 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:14:48,648 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:14:48,649 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:14:48,649 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:14:48,649 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:14:48,649 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:14:48,649 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:15:25,199 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 08:15:25,199 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:15:27,335 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:15:27,335 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:15:27,335 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:15:27,474 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:15:27,475 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:15:28,816 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:15:28,816 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:15:29,508 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:15:29,508 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:15:29,508 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,568 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:15:29,609 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:15:29,609 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:15:29,609 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:15:29,609 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:29,609 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:29,609 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:29,610 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:30,194 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:30,194 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:30,194 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:30,194 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:34:48,829 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:53 - Loading directory: examples/DLN_checkpoints
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:54 - Model file: examples/DLN.py
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:55 - Class name: DLN
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:34:51,050 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:34:51,050 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:34:51,050 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:34:51,189 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:34:51,189 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:34:51,949 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:34:51,949 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:34:52,554 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:34:52,554 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:34:52,555 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:34:52,591 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,591 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,591 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,591 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,592 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,602 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:34:52,655 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:34:52,655 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:34:52,655 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:34:52,655 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:34:52,655 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:34:52,655 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:34:52,656 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:35:40,921 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 08:35:40,921 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:35:43,970 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:53 - Loading directory: examples/DLN_checkpoints
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:54 - Model file: examples/DLN.py
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:55 - Class name: DLN
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:35:46,572 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:35:46,572 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:35:46,572 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:35:46,713 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:35:46,714 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:35:49,390 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:35:49,390 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:35:49,913 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:35:49,913 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:35:49,913 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:35:49,975 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:35:50,013 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:35:50,013 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:35:50,014 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:35:50,014 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,014 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,014 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,014 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,604 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,604 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,604 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,604 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:36:02,681 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:36:02,682 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:36:02,682 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:36:02,817 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:36:02,817 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 08:36:03,831 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:36:06,542 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:36:06,544 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:36:06,545 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:36:06,545 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:36:06,545 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:06,545 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:06,545 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:06,545 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:15,424 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:15,425 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:15,425 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:15,425 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:36:24,361 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:53 - Loading directory: examples/grokking_checkpoints
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:54 - Model file: examples/grokking.py
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:55 - Class name: MLP
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:36:26,855 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:36:26,856 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:36:26,856 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:36:26,998 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:36:26,998 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 08:36:28,161 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:36:28,822 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:36:28,871 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:36:28,871 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:36:28,871 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:36:28,871 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:28,872 - phase-viz - INFO - start:240 - Started cleanup server on port 8002 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:28,872 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8002 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:28,872 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:37,624 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:37,624 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:37,624 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:37,624 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:37:48,209 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:37:54,806 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:37:54,806 - phase-viz - INFO - load_dir:53 - Loading directory: ../checkpoints
2025-05-27 08:37:54,807 - phase-viz - INFO - load_dir:54 - Model file: arithemtic.py
2025-05-27 08:37:54,807 - phase-viz - INFO - load_dir:55 - Class name: ArithmeticNet
2025-05-27 08:38:08,513 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:53 - Loading directory: ../checkpoints
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:54 - Model file: arithmetic.py
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:55 - Class name: ArithmeticNet
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:68 - Found 4 checkpoints
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:38:11,388 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:38:11,389 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:38:11,389 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:38:11,530 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:38:11,530 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-27 08:38:12,882 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-27 08:38:18,049 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:38:18,102 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:38:18,102 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:38:18,102 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:38:18,102 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:18,102 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:18,102 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:18,103 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:25,527 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:25,527 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:25,528 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:25,528 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 13:08:17,970 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:08:17,971 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:08:17,971 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:08:17,971 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:08:29,342 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:08:29,343 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:08:29,343 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:08:29,343 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:08:29,482 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:08:29,483 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:08:44,379 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:08:44,379 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:08:44,379 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:08:44,518 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:08:44,518 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:08:46,060 - phase-viz - INFO - plot_metric:128 - User input: l2
2025-05-27 13:08:46,060 - phase-viz - INFO - plot_metric:211 - Added metric: L2 Norm
2025-05-27 13:08:47,586 - phase-viz - INFO - plot_metric:128 - User input: done
2025-05-27 13:08:47,586 - phase-viz - INFO - plot_metric:220 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 13:08:47,587 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/20000.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/0.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/40000.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/final.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/30000.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,639 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:08:47,687 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:08:47,687 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:08:47,687 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:08:47,687 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:08:47,688 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:08:47,688 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:08:47,688 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:09:22,415 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:09:22,415 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:09:22,415 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:09:22,415 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 13:13:16,871 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:13:16,871 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:13:16,871 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:13:16,871 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:13:17,010 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:13:17,010 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:13:23,164 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:13:23,164 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:13:23,165 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:13:23,302 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:13:23,302 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:13:24,578 - phase-viz - INFO - plot_metric:128 - User input: l3
2025-05-27 13:13:24,578 - phase-viz - WARNING - plot_metric:216 - Unknown metric: l3
2025-05-27 13:13:25,691 - phase-viz - INFO - plot_metric:128 - User input: l2
2025-05-27 13:13:25,692 - phase-viz - INFO - plot_metric:211 - Added metric: L2 Norm
2025-05-27 13:13:27,157 - phase-viz - INFO - plot_metric:128 - User input: done
2025-05-27 13:13:27,157 - phase-viz - INFO - plot_metric:220 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 13:13:27,157 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:13:27,208 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:13:27,257 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:13:27,258 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:13:27,258 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:13:27,258 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:27,258 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:27,258 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:27,258 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:48,371 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:48,371 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:48,372 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:48,372 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 13:20:57,295 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:20:57,296 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:20:57,296 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:20:57,296 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:20:57,297 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:20:57,297 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:21:04,351 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:21:04,352 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:21:04,352 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:21:04,490 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:21:04,490 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:21:05,034 - phase-viz - INFO - plot_metric:128 - User input: l2
2025-05-27 13:21:05,034 - phase-viz - INFO - plot_metric:211 - Added metric: L2 Norm
2025-05-27 13:21:06,604 - phase-viz - INFO - plot_metric:128 - User input: done
2025-05-27 13:21:06,604 - phase-viz - INFO - plot_metric:220 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 13:21:06,605 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:21:06,743 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:21:06,810 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:21:06,811 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:21:06,811 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:21:06,811 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:06,811 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:06,811 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:06,811 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:12,458 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:12,459 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:12,459 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:12,459 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 13:21:19,349 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:21:19,349 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:21:19,349 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:21:19,349 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:21:19,350 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:21:19,350 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:21:24,862 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:21:24,863 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:21:24,863 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:21:25,003 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:21:25,003 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:128 - User input: all
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: L2 Norm
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Entropy
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Layer Connectivity
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Parameter Variance
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Layer Wise Norm Ratio
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Activation Capacity
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Dead Neuron Percentage
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Rank
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Gradient Flow Score
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Effective Rank
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Avg Condition Number
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Flatness Proxy
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Mean Weight
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Skew
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Kurtosis
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Isotropy
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Norm
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Spectral Norm
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Participation Ratio
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Sparsity
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Max Activation
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:220 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 13:21:25,957 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:21:26,452 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:21:26,464 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:21:26,464 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:21:26,465 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:21:26,465 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:21:26,465 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:21:26,465 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:21:26,465 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:22:25,184 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:22:25,185 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:22:25,185 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:22:25,185 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 13:51:12,859 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:51:12,860 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:51:12,860 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:51:12,860 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:51:12,860 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:51:12,860 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:51:18,731 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:51:18,732 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:51:18,732 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:51:18,872 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:51:18,872 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:51:19,538 - phase-viz - INFO - plot_metric:128 - User input: l2
2025-05-27 13:51:19,538 - phase-viz - INFO - plot_metric:211 - Added metric: L2 Norm
2025-05-27 13:51:20,186 - phase-viz - INFO - plot_metric:128 - User input: done
2025-05-27 13:51:20,186 - phase-viz - INFO - plot_metric:220 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 13:51:20,187 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:51:20,282 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/final.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 13:51:20,289 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/30000.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 13:51:20,298 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/40000.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 13:51:20,297 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/20000.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 13:51:20,304 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/0.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 13:51:20,317 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:51:20,390 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:51:20,391 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:51:20,391 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:51:20,391 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_135120_0bjmddjn.html
2025-05-27 13:51:20,391 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_135120_0bjmddjn.html
2025-05-27 13:51:20,391 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_135120_0bjmddjn.html
2025-05-27 13:51:20,391 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_135120_0bjmddjn.html
2025-05-27 13:51:23,171 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_135120_0bjmddjn.html
2025-05-27 13:51:23,171 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_135120_0bjmddjn.html
2025-05-27 13:51:23,171 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_135120_0bjmddjn.html
2025-05-27 13:51:23,171 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 17:05:21,578 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 17:05:21,579 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:05:21,579 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 17:05:21,719 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 17:05:21,719 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 17:05:23,418 - phase-viz - INFO - plot_metric:128 - User input: l2
2025-05-27 17:05:23,419 - phase-viz - INFO - plot_metric:211 - Added metric: L2 Norm
2025-05-27 17:05:25,138 - phase-viz - INFO - plot_metric:128 - User input: done
2025-05-27 17:05:25,139 - phase-viz - INFO - plot_metric:220 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 17:05:25,139 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 17:05:25,244 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/0.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 17:05:25,245 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/20000.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 17:05:25,252 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/final.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 17:05:25,252 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/30000.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 17:05:25,253 - phase-viz - ERROR - _process_checkpoint_cpu:233 - Worker error on examples/transformer_checkpoints/40000.pt: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 223, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 175, in compute_metric_batch
    model = wrap_model_for_metrics(model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/compatible_wrapper.py", line 136, in wrap_model_for_metrics
    logger.info("Model has non-standard parameters, wrapping for metrics compatibility")
    ^^^^^^
NameError: name 'logger' is not defined
2025-05-27 17:05:25,268 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 17:05:25,346 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 17:05:25,346 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 17:05:25,346 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 17:05:25,346 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170525_74yja8m0.html
2025-05-27 17:05:25,347 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170525_74yja8m0.html
2025-05-27 17:05:25,347 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170525_74yja8m0.html
2025-05-27 17:05:25,347 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170525_74yja8m0.html
2025-05-27 17:05:46,121 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 17:05:46,122 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170525_74yja8m0.html
2025-05-27 17:06:16,156 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 17:06:21,893 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 17:06:21,894 - phase-viz - INFO - load_dir:52 - Loading directory: examples/trgrokking_checkpoints
2025-05-27 17:06:21,894 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokkingy
2025-05-27 17:06:21,894 - phase-viz - INFO - load_dir:54 - Class name: GrMLP
2025-05-27 17:06:48,674 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 17:06:48,674 - phase-viz - INFO - load_dir:52 - Loading directory: examples/trgrokking_checkpoints
2025-05-27 17:06:48,674 - phase-viz - INFO - load_dir:53 - Model file: examples/grokking.py
2025-05-27 17:06:48,674 - phase-viz - INFO - load_dir:54 - Class name: MLP
2025-05-27 17:06:48,674 - phase-viz - ERROR - load_dir:61 - The path 'examples/trgrokking_checkpoints' is not a directory.
2025-05-27 17:06:54,885 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 17:06:54,886 - phase-viz - INFO - load_dir:52 - Loading directory: examples/grokking_checkpoints
2025-05-27 17:06:54,886 - phase-viz - INFO - load_dir:53 - Model file: examples/grokking.py
2025-05-27 17:06:54,886 - phase-viz - INFO - load_dir:54 - Class name: MLP
2025-05-27 17:06:54,886 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 17:06:54,886 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 17:06:58,370 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 17:06:58,371 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:06:58,371 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 17:06:58,508 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 17:06:58,508 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:128 - User input: all
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: L2 Norm
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Entropy
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Layer Connectivity
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Parameter Variance
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Activation Capacity
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Dead Neuron Percentage
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Rank
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Gradient Flow Score
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Effective Rank
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Avg Condition Number
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Flatness Proxy
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Mean Weight
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Skew
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Kurtosis
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Isotropy
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Norm
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Spectral Norm
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Participation Ratio
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Sparsity
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:199 - Added metric: Max Activation
2025-05-27 17:07:00,055 - phase-viz - INFO - plot_metric:220 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:07:00,056 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 17:07:00,714 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 17:07:00,761 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 17:07:00,762 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 17:07:00,762 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 17:07:00,762 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170700_50hklx5z.html
2025-05-27 17:07:00,762 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170700_50hklx5z.html
2025-05-27 17:07:00,762 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170700_50hklx5z.html
2025-05-27 17:07:00,763 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170700_50hklx5z.html
2025-05-27 17:07:04,895 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170700_50hklx5z.html
2025-05-27 17:07:04,895 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170700_50hklx5z.html
2025-05-27 17:07:04,895 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170700_50hklx5z.html
2025-05-27 17:07:04,895 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 17:07:12,311 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:07:12,311 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:07:12,311 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:07:12,450 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:07:12,451 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 17:07:14,498 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:07:14,498 - phase-viz - INFO - compute_metrics_over_checkpoints:328 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 17:07:15,157 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:07:15,205 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:07:15,205 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:07:15,205 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:07:15,205 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170715_29kckhje.html
2025-05-27 17:07:15,205 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170715_29kckhje.html
2025-05-27 17:07:15,206 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170715_29kckhje.html
2025-05-27 17:07:15,206 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170715_29kckhje.html
2025-05-27 17:07:22,092 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170715_29kckhje.html
2025-05-27 17:07:22,092 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170715_29kckhje.html
2025-05-27 17:07:22,092 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_170715_29kckhje.html
2025-05-27 17:07:22,092 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:16:59,523 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:16:59,524 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:16:59,524 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:16:59,663 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:16:59,663 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:17:02,248 - phase-viz - INFO - plot_metric:129 - User input: exit
2025-05-27 17:17:02,248 - phase-viz - INFO - plot_metric:138 - User exited
2025-05-27 17:17:08,318 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:17:08,319 - phase-viz - INFO - load_dir:53 - Loading directory: examples/transformer_checkpoints
2025-05-27 17:17:08,319 - phase-viz - INFO - load_dir:54 - Model file: examples/transformer_grokking.py
2025-05-27 17:17:08,319 - phase-viz - INFO - load_dir:55 - Class name: GrokkingMLP
2025-05-27 17:17:08,319 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 17:17:08,320 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 17:17:11,259 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:17:11,260 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:17:11,260 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:17:11,399 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:17:11,399 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:17:11,867 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 17:17:11,867 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 17:17:12,497 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:17:12,498 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 17:17:12,627 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:17:12,701 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:17:12,702 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:17:12,702 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:17:12,702 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171712_wk9g0zcn.html
2025-05-27 17:17:12,702 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171712_wk9g0zcn.html
2025-05-27 17:17:12,702 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171712_wk9g0zcn.html
2025-05-27 17:17:12,702 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171712_wk9g0zcn.html
2025-05-27 17:17:17,216 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171712_wk9g0zcn.html
2025-05-27 17:17:17,216 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171712_wk9g0zcn.html
2025-05-27 17:17:17,217 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171712_wk9g0zcn.html
2025-05-27 17:17:17,217 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:17:29,150 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:17:29,150 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:17:29,151 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:17:29,291 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:17:29,291 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:17:30,418 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 17:17:30,418 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 17:17:30,419 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:17:31,007 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:17:31,022 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:17:31,023 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:17:31,023 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:17:31,023 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171731_em8blpdm.html
2025-05-27 17:17:31,023 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171731_em8blpdm.html
2025-05-27 17:17:31,023 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171731_em8blpdm.html
2025-05-27 17:17:31,023 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171731_em8blpdm.html
2025-05-27 17:17:38,707 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171731_em8blpdm.html
2025-05-27 17:17:38,707 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171731_em8blpdm.html
2025-05-27 17:17:38,707 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_171731_em8blpdm.html
2025-05-27 17:17:38,707 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:20:58,070 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:20:58,071 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:20:58,071 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:20:58,210 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:20:58,210 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 17:20:59,997 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:21:00,509 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:21:00,607 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:21:00,607 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:21:00,607 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:21:00,607 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172100_mdlozwbz.html
2025-05-27 17:21:00,608 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172100_mdlozwbz.html
2025-05-27 17:21:00,608 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172100_mdlozwbz.html
2025-05-27 17:21:00,608 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172100_mdlozwbz.html
2025-05-27 17:21:12,293 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172100_mdlozwbz.html
2025-05-27 17:21:12,293 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172100_mdlozwbz.html
2025-05-27 17:21:12,293 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172100_mdlozwbz.html
2025-05-27 17:21:12,294 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:23:49,479 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:23:49,479 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:23:49,479 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:23:49,616 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:23:49,617 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 17:23:53,367 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:23:53,900 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:23:53,982 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:23:53,982 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:23:53,982 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:23:53,982 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172353_2w4aqg20.html
2025-05-27 17:23:53,983 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172353_2w4aqg20.html
2025-05-27 17:23:53,983 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172353_2w4aqg20.html
2025-05-27 17:23:53,983 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172353_2w4aqg20.html
2025-05-27 17:24:45,160 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172353_2w4aqg20.html
2025-05-27 17:24:45,160 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172353_2w4aqg20.html
2025-05-27 17:24:45,161 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172353_2w4aqg20.html
2025-05-27 17:24:45,161 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:25:43,816 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:25:43,816 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:25:43,817 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:25:43,955 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:25:43,955 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 17:25:44,687 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 17:25:44,688 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:25:45,205 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:25:45,296 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:25:45,296 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:25:45,296 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:25:45,296 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172545_n5v90pqn.html
2025-05-27 17:25:45,297 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172545_n5v90pqn.html
2025-05-27 17:25:45,297 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172545_n5v90pqn.html
2025-05-27 17:25:45,297 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172545_n5v90pqn.html
2025-05-27 17:25:56,692 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172545_n5v90pqn.html
2025-05-27 17:25:56,692 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172545_n5v90pqn.html
2025-05-27 17:25:56,692 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_172545_n5v90pqn.html
2025-05-27 17:25:56,692 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:33:37,057 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:33:37,057 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:33:37,058 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:33:37,194 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:33:37,194 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:33:39,348 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 17:33:39,349 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:33:39,907 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:33:39,960 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:33:39,960 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:33:39,960 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:33:39,960 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173339_lsfw111y.html
2025-05-27 17:33:39,961 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173339_lsfw111y.html
2025-05-27 17:33:39,961 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173339_lsfw111y.html
2025-05-27 17:33:39,961 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173339_lsfw111y.html
2025-05-27 17:33:47,773 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173339_lsfw111y.html
2025-05-27 17:33:47,773 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173339_lsfw111y.html
2025-05-27 17:33:47,773 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173339_lsfw111y.html
2025-05-27 17:33:47,773 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:34:29,435 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:34:29,435 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:34:29,435 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:34:29,573 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:34:29,573 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:34:32,792 - phase-viz - INFO - plot_metric:129 - User input: spectral
2025-05-27 17:34:32,792 - phase-viz - INFO - plot_metric:212 - Added metric: Spectral Norm
2025-05-27 17:34:33,698 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:34:33,698 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 17:34:33,846 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:34:33,905 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:34:33,906 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:34:33,906 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:34:33,906 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173433_a58q59nt.html
2025-05-27 17:34:33,906 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173433_a58q59nt.html
2025-05-27 17:34:33,906 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173433_a58q59nt.html
2025-05-27 17:34:33,906 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173433_a58q59nt.html
2025-05-27 17:34:54,373 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173433_a58q59nt.html
2025-05-27 17:34:54,373 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173433_a58q59nt.html
2025-05-27 17:34:54,373 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173433_a58q59nt.html
2025-05-27 17:34:54,373 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:35:23,294 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:35:23,295 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:35:23,295 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:35:23,435 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:35:23,436 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:35:25,954 - phase-viz - INFO - plot_metric:129 - User input: spectral
2025-05-27 17:35:25,954 - phase-viz - INFO - plot_metric:212 - Added metric: Spectral Norm
2025-05-27 17:35:26,944 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:35:26,944 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 17:35:31,150 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:35:31,174 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:35:31,174 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:35:31,174 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:35:31,174 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173531_0c7jzm69.html
2025-05-27 17:35:31,175 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173531_0c7jzm69.html
2025-05-27 17:35:31,175 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173531_0c7jzm69.html
2025-05-27 17:35:31,175 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173531_0c7jzm69.html
2025-05-27 17:35:35,900 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173531_0c7jzm69.html
2025-05-27 17:35:35,900 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173531_0c7jzm69.html
2025-05-27 17:35:35,900 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173531_0c7jzm69.html
2025-05-27 17:35:35,900 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:35:49,402 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:35:49,403 - phase-viz - INFO - load_dir:53 - Loading directory: examples/grokking_checkpoints
2025-05-27 17:35:49,403 - phase-viz - INFO - load_dir:54 - Model file: examples/grokking.py
2025-05-27 17:35:49,403 - phase-viz - INFO - load_dir:55 - Class name: MLP
2025-05-27 17:35:49,403 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 17:35:49,403 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 17:35:52,579 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:35:52,580 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:35:52,580 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:35:52,720 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:35:52,720 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:35:55,385 - phase-viz - INFO - plot_metric:129 - User input: spectral
2025-05-27 17:35:55,385 - phase-viz - INFO - plot_metric:212 - Added metric: Spectral Norm
2025-05-27 17:35:56,381 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:35:56,381 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 17:35:56,734 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:35:56,787 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:35:56,788 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:35:56,788 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:35:56,788 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173556_1ur0zmn0.html
2025-05-27 17:35:56,788 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173556_1ur0zmn0.html
2025-05-27 17:35:56,788 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173556_1ur0zmn0.html
2025-05-27 17:35:56,789 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173556_1ur0zmn0.html
2025-05-27 17:35:59,720 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173556_1ur0zmn0.html
2025-05-27 17:35:59,720 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173556_1ur0zmn0.html
2025-05-27 17:35:59,721 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173556_1ur0zmn0.html
2025-05-27 17:35:59,721 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:36:06,740 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:36:06,740 - phase-viz - INFO - load_dir:53 - Loading directory: examples/transformer_checkpoints
2025-05-27 17:36:06,740 - phase-viz - INFO - load_dir:54 - Model file: examples/transformer_grokking.py
2025-05-27 17:36:06,740 - phase-viz - INFO - load_dir:55 - Class name: GrokkingMLP
2025-05-27 17:36:06,741 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 17:36:06,741 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 17:37:08,205 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:37:08,206 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:37:08,206 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:37:08,347 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:37:08,348 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:37:11,901 - phase-viz - INFO - plot_metric:129 - User input: layer
2025-05-27 17:37:11,901 - phase-viz - WARNING - plot_metric:217 - Unknown metric: layer
2025-05-27 17:37:14,331 - phase-viz - INFO - plot_metric:129 - User input: connectivity
2025-05-27 17:37:14,331 - phase-viz - INFO - plot_metric:212 - Added metric: Layer Connectivity
2025-05-27 17:37:21,269 - phase-viz - INFO - plot_metric:129 - User input: weight rank
2025-05-27 17:37:21,269 - phase-viz - WARNING - plot_metric:217 - Unknown metric: weight rank
2025-05-27 17:37:22,552 - phase-viz - INFO - plot_metric:129 - User input: rank
2025-05-27 17:37:22,552 - phase-viz - INFO - plot_metric:212 - Added metric: Weight Rank
2025-05-27 17:37:28,186 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:37:28,186 - phase-viz - INFO - plot_metric:221 - Starting calculation of 2 metrics across 5 checkpoints
2025-05-27 17:37:32,170 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:37:32,224 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:37:32,224 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:37:32,225 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:37:32,225 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173732_9dwzrfwz.html
2025-05-27 17:37:32,225 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173732_9dwzrfwz.html
2025-05-27 17:37:32,225 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173732_9dwzrfwz.html
2025-05-27 17:37:32,225 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173732_9dwzrfwz.html
2025-05-27 17:37:57,903 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173732_9dwzrfwz.html
2025-05-27 17:37:57,903 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173732_9dwzrfwz.html
2025-05-27 17:37:57,903 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173732_9dwzrfwz.html
2025-05-27 17:37:57,903 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:39:13,594 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:39:13,594 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:39:13,595 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:39:13,733 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:39:13,733 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:39:17,420 - phase-viz - INFO - plot_metric:129 - User input: condition
2025-05-27 17:39:17,420 - phase-viz - INFO - plot_metric:212 - Added metric: Avg Condition Number
2025-05-27 17:39:23,308 - phase-viz - INFO - plot_metric:129 - User input: effective
2025-05-27 17:39:23,309 - phase-viz - WARNING - plot_metric:217 - Unknown metric: effective
2025-05-27 17:39:27,779 - phase-viz - INFO - plot_metric:129 - User input: metrics
2025-05-27 17:39:46,643 - phase-viz - INFO - plot_metric:129 - User input: effective_rank
2025-05-27 17:39:46,643 - phase-viz - INFO - plot_metric:212 - Added metric: Effective Rank
2025-05-27 17:39:47,991 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:39:47,991 - phase-viz - INFO - plot_metric:221 - Starting calculation of 2 metrics across 5 checkpoints
2025-05-27 17:39:51,086 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:39:51,114 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:39:51,114 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:39:51,114 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:39:51,115 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173951_jxp6t4pm.html
2025-05-27 17:39:51,115 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173951_jxp6t4pm.html
2025-05-27 17:39:51,115 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173951_jxp6t4pm.html
2025-05-27 17:39:51,115 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173951_jxp6t4pm.html
2025-05-27 17:40:11,381 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173951_jxp6t4pm.html
2025-05-27 17:40:11,381 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173951_jxp6t4pm.html
2025-05-27 17:40:11,381 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_173951_jxp6t4pm.html
2025-05-27 17:40:11,381 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:41:43,910 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:41:43,911 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:41:43,911 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:41:44,051 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:41:44,051 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:41:49,754 - phase-viz - INFO - plot_metric:129 - User input: actiovation
2025-05-27 17:41:49,754 - phase-viz - WARNING - plot_metric:217 - Unknown metric: actiovation
2025-05-27 17:41:51,325 - phase-viz - INFO - plot_metric:129 - User input: activation
2025-05-27 17:41:51,325 - phase-viz - WARNING - plot_metric:217 - Unknown metric: activation
2025-05-27 17:41:54,067 - phase-viz - INFO - plot_metric:129 - User input: metrics
2025-05-27 17:41:59,800 - phase-viz - INFO - plot_metric:129 - User input: max_activation
2025-05-27 17:41:59,800 - phase-viz - INFO - plot_metric:212 - Added metric: Max Activation
2025-05-27 17:42:02,944 - phase-viz - INFO - plot_metric:129 - User input: isotropy
2025-05-27 17:42:02,944 - phase-viz - INFO - plot_metric:212 - Added metric: Isotropy
2025-05-27 17:42:11,894 - phase-viz - INFO - plot_metric:129 - User input: condition_number
2025-05-27 17:42:11,894 - phase-viz - WARNING - plot_metric:217 - Unknown metric: condition_number
2025-05-27 17:42:13,652 - phase-viz - INFO - plot_metric:129 - User input: condition
2025-05-27 17:42:13,652 - phase-viz - INFO - plot_metric:212 - Added metric: Avg Condition Number
2025-05-27 17:42:14,773 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:42:14,773 - phase-viz - INFO - plot_metric:221 - Starting calculation of 3 metrics across 5 checkpoints
2025-05-27 17:42:19,618 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:42:19,704 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:42:19,705 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:42:19,705 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:42:19,705 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174219_tv4y1h0n.html
2025-05-27 17:42:19,705 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174219_tv4y1h0n.html
2025-05-27 17:42:19,705 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174219_tv4y1h0n.html
2025-05-27 17:42:19,705 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174219_tv4y1h0n.html
2025-05-27 17:42:28,740 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 17:42:28,740 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174219_tv4y1h0n.html
2025-05-27 17:42:30,675 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:42:30,676 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:42:30,676 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:42:30,813 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:42:30,813 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:42:33,929 - phase-viz - INFO - plot_metric:129 - User input: isostropy
2025-05-27 17:42:33,929 - phase-viz - WARNING - plot_metric:217 - Unknown metric: isostropy
2025-05-27 17:42:35,572 - phase-viz - INFO - plot_metric:129 - User input: isotropy
2025-05-27 17:42:35,572 - phase-viz - INFO - plot_metric:212 - Added metric: Isotropy
2025-05-27 17:42:40,391 - phase-viz - INFO - plot_metric:129 - User input: condition_number
2025-05-27 17:42:40,391 - phase-viz - WARNING - plot_metric:217 - Unknown metric: condition_number
2025-05-27 17:42:42,582 - phase-viz - INFO - plot_metric:129 - User input: condition
2025-05-27 17:42:42,582 - phase-viz - INFO - plot_metric:212 - Added metric: Avg Condition Number
2025-05-27 17:42:44,871 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:42:44,871 - phase-viz - INFO - plot_metric:221 - Starting calculation of 2 metrics across 5 checkpoints
2025-05-27 17:42:55,540 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:42:55,564 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:42:55,564 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:42:55,564 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:42:55,564 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174255_evgin69j.html
2025-05-27 17:42:55,565 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174255_evgin69j.html
2025-05-27 17:42:55,565 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174255_evgin69j.html
2025-05-27 17:42:55,565 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174255_evgin69j.html
2025-05-27 17:42:56,177 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174255_evgin69j.html
2025-05-27 17:42:56,177 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174255_evgin69j.html
2025-05-27 17:42:56,177 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174255_evgin69j.html
2025-05-27 17:42:56,177 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:45:25,091 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:45:25,092 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:45:25,092 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:45:25,234 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:45:25,234 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:45:29,346 - phase-viz - INFO - plot_metric:129 - User input: aall
2025-05-27 17:45:29,346 - phase-viz - WARNING - plot_metric:217 - Unknown metric: aall
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 17:45:31,059 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:45:48,092 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:45:48,163 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:45:48,163 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:45:48,163 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:45:48,163 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174548_c08sxqbw.html
2025-05-27 17:45:48,164 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174548_c08sxqbw.html
2025-05-27 17:45:48,164 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174548_c08sxqbw.html
2025-05-27 17:45:48,164 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174548_c08sxqbw.html
2025-05-27 17:47:09,565 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 17:47:09,565 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174548_c08sxqbw.html
2025-05-27 17:49:46,423 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:49:46,423 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:49:46,424 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:49:46,563 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:49:46,563 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:49:49,032 - phase-viz - INFO - plot_metric:129 - User input: weight_rank
2025-05-27 17:49:49,033 - phase-viz - WARNING - plot_metric:217 - Unknown metric: weight_rank
2025-05-27 17:49:51,920 - phase-viz - INFO - plot_metric:129 - User input: weight_rank
2025-05-27 17:49:51,920 - phase-viz - WARNING - plot_metric:217 - Unknown metric: weight_rank
2025-05-27 17:49:53,455 - phase-viz - INFO - plot_metric:129 - User input: rank
2025-05-27 17:49:53,455 - phase-viz - INFO - plot_metric:212 - Added metric: Weight Rank
2025-05-27 17:49:54,405 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:49:54,405 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 17:49:57,439 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:49:57,522 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:49:57,522 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:49:57,522 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:49:57,522 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174957_6p1htrfl.html
2025-05-27 17:49:57,523 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174957_6p1htrfl.html
2025-05-27 17:49:57,523 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174957_6p1htrfl.html
2025-05-27 17:49:57,523 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174957_6p1htrfl.html
2025-05-27 17:50:06,503 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174957_6p1htrfl.html
2025-05-27 17:50:06,503 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174957_6p1htrfl.html
2025-05-27 17:50:06,503 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_174957_6p1htrfl.html
2025-05-27 17:50:06,503 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:50:32,911 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 17:50:32,912 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:50:32,912 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 17:50:33,051 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 17:50:33,051 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 17:50:33,680 - phase-viz - INFO - plot_metric:129 - User input: dead
2025-05-27 17:50:33,681 - phase-viz - WARNING - plot_metric:217 - Unknown metric: dead
2025-05-27 17:50:36,204 - phase-viz - INFO - plot_metric:129 - User input: dead_neurons
2025-05-27 17:50:36,205 - phase-viz - INFO - plot_metric:212 - Added metric: Dead Neuron Percentage
2025-05-27 17:50:37,806 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 17:50:37,806 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 17:50:37,979 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 17:50:38,016 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 17:50:38,017 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 17:50:38,017 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 17:50:38,017 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175038_zlkalp0h.html
2025-05-27 17:50:38,017 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175038_zlkalp0h.html
2025-05-27 17:50:38,017 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175038_zlkalp0h.html
2025-05-27 17:50:38,018 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175038_zlkalp0h.html
2025-05-27 17:50:40,804 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175038_zlkalp0h.html
2025-05-27 17:50:40,804 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175038_zlkalp0h.html
2025-05-27 17:50:40,804 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175038_zlkalp0h.html
2025-05-27 17:50:40,804 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 17:51:12,832 - phase-viz - INFO - <module>:297 - Starting phase-viz CLI
2025-05-27 17:51:12,833 - phase-viz - INFO - plot_metric:94 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:51:12,833 - phase-viz - INFO - plot_metric:97 - State loaded successfully
2025-05-27 17:51:12,972 - phase-viz - WARNING - plot_metric:105 - CUDA requested but not available, falling back to CPU
2025-05-27 17:51:12,972 - phase-viz - INFO - plot_metric:115 - Running on CPU
2025-05-27 17:51:21,744 - phase-viz - INFO - plot_metric:130 - User input: activation
2025-05-27 17:51:21,744 - phase-viz - WARNING - plot_metric:218 - Unknown metric: activation
2025-05-27 17:51:25,502 - phase-viz - INFO - plot_metric:130 - User input: capacity
2025-05-27 17:51:25,503 - phase-viz - INFO - plot_metric:213 - Added metric: Activation Capacity
2025-05-27 17:51:26,468 - phase-viz - INFO - plot_metric:130 - User input: done
2025-05-27 17:51:26,469 - phase-viz - INFO - plot_metric:222 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 17:51:28,970 - phase-viz - INFO - plot_metric:254 - Successfully computed all metrics
2025-05-27 17:51:28,985 - phase-viz - INFO - plot_metric:264 - Cleared model and metric caches
2025-05-27 17:51:28,986 - phase-viz - INFO - plot_metric:267 - Saved metrics data to state
2025-05-27 17:51:28,986 - phase-viz - INFO - plot_metric:277 - Generating interactive plot
2025-05-27 17:51:28,986 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175128_acyqmnsk.html
2025-05-27 17:51:28,986 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175128_acyqmnsk.html
2025-05-27 17:51:28,986 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175128_acyqmnsk.html
2025-05-27 17:51:28,986 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175128_acyqmnsk.html
2025-05-27 17:51:40,562 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175128_acyqmnsk.html
2025-05-27 17:51:40,562 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175128_acyqmnsk.html
2025-05-27 17:51:40,563 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175128_acyqmnsk.html
2025-05-27 17:51:40,563 - phase-viz - INFO - plot_metric:284 - Plot generation completed
2025-05-27 17:51:53,193 - phase-viz - INFO - <module>:297 - Starting phase-viz CLI
2025-05-27 17:51:53,194 - phase-viz - INFO - plot_metric:94 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:51:53,194 - phase-viz - INFO - plot_metric:97 - State loaded successfully
2025-05-27 17:51:53,334 - phase-viz - WARNING - plot_metric:105 - CUDA requested but not available, falling back to CPU
2025-05-27 17:51:53,334 - phase-viz - INFO - plot_metric:115 - Running on CPU
2025-05-27 17:51:54,227 - phase-viz - INFO - plot_metric:130 - User input: all
2025-05-27 17:51:54,227 - phase-viz - INFO - plot_metric:201 - Added metric: L2 Norm
2025-05-27 17:51:54,227 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Entropy
2025-05-27 17:51:54,227 - phase-viz - INFO - plot_metric:201 - Added metric: Layer Connectivity
2025-05-27 17:51:54,227 - phase-viz - INFO - plot_metric:201 - Added metric: Parameter Variance
2025-05-27 17:51:54,227 - phase-viz - INFO - plot_metric:201 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:51:54,227 - phase-viz - INFO - plot_metric:201 - Added metric: Activation Capacity
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Dead Neuron Percentage
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Rank
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Gradient Flow Score
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Effective Rank
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Avg Condition Number
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Flatness Proxy
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Mean Weight
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Skew
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Kurtosis
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Isotropy
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Norm
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Spectral Norm
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Participation Ratio
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Sparsity
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:201 - Added metric: Max Activation
2025-05-27 17:51:54,228 - phase-viz - INFO - plot_metric:222 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:52:16,828 - phase-viz - INFO - plot_metric:254 - Successfully computed all metrics
2025-05-27 17:52:16,873 - phase-viz - INFO - plot_metric:264 - Cleared model and metric caches
2025-05-27 17:52:16,874 - phase-viz - INFO - plot_metric:267 - Saved metrics data to state
2025-05-27 17:52:16,874 - phase-viz - INFO - plot_metric:277 - Generating interactive plot
2025-05-27 17:52:16,874 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175216_zvruga91.html
2025-05-27 17:52:16,874 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175216_zvruga91.html
2025-05-27 17:52:16,874 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175216_zvruga91.html
2025-05-27 17:52:16,874 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175216_zvruga91.html
2025-05-27 17:52:43,606 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175216_zvruga91.html
2025-05-27 17:52:43,606 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175216_zvruga91.html
2025-05-27 17:52:43,606 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175216_zvruga91.html
2025-05-27 17:52:43,606 - phase-viz - INFO - plot_metric:284 - Plot generation completed
2025-05-27 17:52:50,134 - phase-viz - INFO - <module>:297 - Starting phase-viz CLI
2025-05-27 17:52:50,135 - phase-viz - INFO - load_dir:54 - Loading directory: examples/grokking_checkpoints
2025-05-27 17:52:50,135 - phase-viz - INFO - load_dir:55 - Model file: examples/grokking.py
2025-05-27 17:52:50,135 - phase-viz - INFO - load_dir:56 - Class name: MLP
2025-05-27 17:52:50,135 - phase-viz - INFO - load_dir:69 - Found 5 checkpoints
2025-05-27 17:52:50,135 - phase-viz - INFO - load_dir:82 - State saved successfully
2025-05-27 17:52:52,994 - phase-viz - INFO - <module>:297 - Starting phase-viz CLI
2025-05-27 17:52:52,995 - phase-viz - INFO - plot_metric:94 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:52:52,995 - phase-viz - INFO - plot_metric:97 - State loaded successfully
2025-05-27 17:52:53,132 - phase-viz - WARNING - plot_metric:105 - CUDA requested but not available, falling back to CPU
2025-05-27 17:52:53,132 - phase-viz - INFO - plot_metric:115 - Running on CPU
2025-05-27 17:52:54,040 - phase-viz - INFO - plot_metric:130 - User input: all
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: L2 Norm
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Entropy
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Layer Connectivity
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Parameter Variance
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Activation Capacity
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Dead Neuron Percentage
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Rank
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Gradient Flow Score
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Effective Rank
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Avg Condition Number
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Flatness Proxy
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Mean Weight
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Skew
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Kurtosis
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Isotropy
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Norm
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Spectral Norm
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Participation Ratio
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Sparsity
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:201 - Added metric: Max Activation
2025-05-27 17:52:54,041 - phase-viz - INFO - plot_metric:222 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:52:55,485 - phase-viz - INFO - plot_metric:254 - Successfully computed all metrics
2025-05-27 17:52:55,558 - phase-viz - INFO - plot_metric:264 - Cleared model and metric caches
2025-05-27 17:52:55,559 - phase-viz - INFO - plot_metric:267 - Saved metrics data to state
2025-05-27 17:52:55,559 - phase-viz - INFO - plot_metric:277 - Generating interactive plot
2025-05-27 17:52:55,559 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175255_pp8ji4xp.html
2025-05-27 17:52:55,559 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175255_pp8ji4xp.html
2025-05-27 17:52:55,559 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175255_pp8ji4xp.html
2025-05-27 17:52:55,559 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175255_pp8ji4xp.html
2025-05-27 17:53:27,644 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 17:53:27,644 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175255_pp8ji4xp.html
2025-05-27 17:54:00,909 - phase-viz - INFO - <module>:297 - Starting phase-viz CLI
2025-05-27 17:54:00,910 - phase-viz - INFO - load_dir:54 - Loading directory: ../checkpoints
2025-05-27 17:54:00,910 - phase-viz - INFO - load_dir:55 - Model file: arithmetic.py
2025-05-27 17:54:00,910 - phase-viz - INFO - load_dir:56 - Class name: ArithmeticNet
2025-05-27 17:54:00,910 - phase-viz - INFO - load_dir:69 - Found 4 checkpoints
2025-05-27 17:54:00,910 - phase-viz - INFO - load_dir:82 - State saved successfully
2025-05-27 17:54:03,844 - phase-viz - INFO - <module>:297 - Starting phase-viz CLI
2025-05-27 17:54:03,845 - phase-viz - INFO - plot_metric:94 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:54:03,845 - phase-viz - INFO - plot_metric:97 - State loaded successfully
2025-05-27 17:54:03,983 - phase-viz - WARNING - plot_metric:105 - CUDA requested but not available, falling back to CPU
2025-05-27 17:54:03,983 - phase-viz - INFO - plot_metric:115 - Running on CPU
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:130 - User input: all
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: L2 Norm
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Entropy
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Layer Connectivity
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Parameter Variance
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Activation Capacity
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Dead Neuron Percentage
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Rank
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Gradient Flow Score
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Effective Rank
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Avg Condition Number
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Flatness Proxy
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Mean Weight
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Skew
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Kurtosis
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Isotropy
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Norm
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Spectral Norm
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Participation Ratio
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Sparsity
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:201 - Added metric: Max Activation
2025-05-27 17:54:04,942 - phase-viz - INFO - plot_metric:222 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-27 17:54:08,224 - phase-viz - INFO - plot_metric:254 - Successfully computed all metrics
2025-05-27 17:54:08,265 - phase-viz - INFO - plot_metric:264 - Cleared model and metric caches
2025-05-27 17:54:08,265 - phase-viz - INFO - plot_metric:267 - Saved metrics data to state
2025-05-27 17:54:08,265 - phase-viz - INFO - plot_metric:277 - Generating interactive plot
2025-05-27 17:54:08,266 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175408_yohkwxh7.html
2025-05-27 17:54:08,266 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175408_yohkwxh7.html
2025-05-27 17:54:08,266 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175408_yohkwxh7.html
2025-05-27 17:54:08,266 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175408_yohkwxh7.html
2025-05-27 17:54:09,052 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175408_yohkwxh7.html
2025-05-27 17:54:09,053 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175408_yohkwxh7.html
2025-05-27 17:54:09,053 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175408_yohkwxh7.html
2025-05-27 17:54:09,053 - phase-viz - INFO - plot_metric:284 - Plot generation completed
2025-05-27 17:55:25,360 - phase-viz - INFO - <module>:297 - Starting phase-viz CLI
2025-05-27 17:55:25,360 - phase-viz - INFO - load_dir:54 - Loading directory: examples/DLN_checkpoints
2025-05-27 17:55:25,360 - phase-viz - INFO - load_dir:55 - Model file: examples/DLN.py
2025-05-27 17:55:25,361 - phase-viz - INFO - load_dir:56 - Class name: DLN
2025-05-27 17:55:25,361 - phase-viz - INFO - load_dir:69 - Found 5 checkpoints
2025-05-27 17:55:25,361 - phase-viz - INFO - load_dir:82 - State saved successfully
2025-05-27 17:55:28,084 - phase-viz - INFO - <module>:297 - Starting phase-viz CLI
2025-05-27 17:55:28,085 - phase-viz - INFO - plot_metric:94 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 17:55:28,085 - phase-viz - INFO - plot_metric:97 - State loaded successfully
2025-05-27 17:55:28,221 - phase-viz - WARNING - plot_metric:105 - CUDA requested but not available, falling back to CPU
2025-05-27 17:55:28,221 - phase-viz - INFO - plot_metric:115 - Running on CPU
2025-05-27 17:55:28,888 - phase-viz - INFO - plot_metric:130 - User input: all
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: L2 Norm
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Entropy
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Layer Connectivity
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Parameter Variance
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Layer Wise Norm Ratio
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Activation Capacity
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Dead Neuron Percentage
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Rank
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Gradient Flow Score
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Effective Rank
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Avg Condition Number
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Flatness Proxy
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Mean Weight
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Skew
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Kurtosis
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Isotropy
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Weight Norm
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Spectral Norm
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Participation Ratio
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Sparsity
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:201 - Added metric: Max Activation
2025-05-27 17:55:28,889 - phase-viz - INFO - plot_metric:222 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 17:55:33,976 - phase-viz - INFO - plot_metric:254 - Successfully computed all metrics
2025-05-27 17:55:34,019 - phase-viz - INFO - plot_metric:264 - Cleared model and metric caches
2025-05-27 17:55:34,020 - phase-viz - INFO - plot_metric:267 - Saved metrics data to state
2025-05-27 17:55:34,020 - phase-viz - INFO - plot_metric:277 - Generating interactive plot
2025-05-27 17:55:34,020 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175534_dj5fhx06.html
2025-05-27 17:55:34,020 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175534_dj5fhx06.html
2025-05-27 17:55:34,020 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175534_dj5fhx06.html
2025-05-27 17:55:34,021 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175534_dj5fhx06.html
2025-05-27 17:57:50,698 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 17:57:50,698 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_175534_dj5fhx06.html
