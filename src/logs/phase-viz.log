2025-05-27 08:03:11,682 - phase-viz - INFO - load_dir:54 - Model file: examples/grokking.py
2025-05-27 08:03:11,682 - phase-viz - INFO - load_dir:55 - Class name: MLP
2025-05-27 08:03:11,683 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:03:11,683 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:03:14,242 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:03:14,243 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:03:14,243 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:03:14,386 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:03:14,386 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:03:15,376 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:03:15,377 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 08:03:15,377 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:03:16,063 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:03:16,088 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:03:16,088 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:03:16,088 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:03:16,088 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:03:16,089 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:03:16,089 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:03:16,089 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:05:34,265 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:05:34,266 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:05:34,266 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_080316_50mmap9s.html
2025-05-27 08:05:34,266 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:10:51,974 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:53 - Loading directory: examples/DLN_checkpoints
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:54 - Model file: examples/DLN.py
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:55 - Class name: DLN
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:10:51,975 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:10:55,423 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:10:55,424 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:10:55,424 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:10:55,562 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:10:55,562 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:10:57,367 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:10:57,368 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 08:10:57,368 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,408 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:10:57,424 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:10:57,468 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:10:57,468 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:10:57,469 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:10:57,469 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:10:57,469 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:10:57,469 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:10:57,469 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:11:04,602 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:11:04,602 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:11:04,602 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081057_lqd8srej.html
2025-05-27 08:11:04,603 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:13:14,387 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:13:14,388 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:13:14,388 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:13:14,527 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:13:14,527 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:13:15,252 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:13:15,253 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:13:18,895 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:13:18,895 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:13:18,895 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,937 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 269, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 271, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:13:18,947 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:13:18,995 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:13:18,996 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:13:18,996 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:13:18,996 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:18,996 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:18,996 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:18,997 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:21,511 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:21,511 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:21,511 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081318_2ri0lxkw.html
2025-05-27 08:13:21,511 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:14:46,911 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:14:46,912 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:14:46,912 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:14:47,051 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:14:47,052 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:14:48,008 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:14:48,008 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:14:48,548 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:14:48,548 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:14:48,548 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,587 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 270, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 272, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:14:48,597 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:14:48,648 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:14:48,648 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:14:48,649 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:14:48,649 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:14:48,649 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:14:48,649 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:14:48,649 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:15:25,199 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 08:15:25,199 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081448_jy6qqdnk.html
2025-05-27 08:15:27,335 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:15:27,335 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:15:27,335 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:15:27,474 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:15:27,475 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:15:28,816 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:15:28,816 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:15:29,508 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:15:29,508 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:15:29,508 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,557 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 306, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 247, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize DLN. Available config: {'init_variance': 1.0, 'teacher_matrix': [[10.0, 0.0, 0.0, 0.0, 0.0], [0.0, 20.0, 0.0, 0.0, 0.0], [0.0, 0.0, 30.0, 0.0, 0.0], [0.0, 0.0, 0.0, 40.0, 0.0], [0.0, 0.0, 0.0, 0.0, 50.0]], 'gamma': 1.0, 'w': 100, 'L': 4, 'seed': 0, 'noise_level': 0.0, 'num_training_samples': 1024, 'batch_size': 128, 'num_steps': 10000, 'device': 'cuda:0', 'lr': 0.001, 'momentum': 0.9, 'weight_decay': 0.001}, Model parameters: ['self', 'dims', 'init_variance']
2025-05-27 08:15:29,568 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:15:29,609 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:15:29,609 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:15:29,609 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:15:29,609 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:29,609 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:29,609 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:29,610 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:30,194 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:30,194 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:30,194 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_081529_4o2upd97.html
2025-05-27 08:15:30,194 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:34:48,829 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:53 - Loading directory: examples/DLN_checkpoints
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:54 - Model file: examples/DLN.py
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:55 - Class name: DLN
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:34:48,830 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:34:51,050 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:34:51,050 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:34:51,050 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:34:51,189 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:34:51,189 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:34:51,949 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:34:51,949 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:34:52,554 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:34:52,554 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:34:52,555 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:34:52,591 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_2448.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_2448.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,591 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_7551.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_7551.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,591 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_5102.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_5102.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,591 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_0.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_0.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,592 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/DLN_checkpoints/checkpoint_step_10000.pt: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 371, in load_model_from_checkpoint
    checkpoint = torch.load(path, map_location=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 373, in load_model_from_checkpoint
    raise RuntimeError(f"Failed to load checkpoint from {path}: {e}")
RuntimeError: Failed to load checkpoint from examples/DLN_checkpoints/checkpoint_step_10000.pt: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL numpy._core.multiarray.scalar was not an allowed global by default. Please use `torch.serialization.add_safe_globals([numpy._core.multiarray.scalar])` or the `torch.serialization.safe_globals([numpy._core.multiarray.scalar])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-05-27 08:34:52,602 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:34:52,655 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:34:52,655 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:34:52,655 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:34:52,655 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:34:52,655 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:34:52,655 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:34:52,656 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:35:40,921 - phase-viz - INFO - _signal_handler:162 - Received signal 2, cleaning up...
2025-05-27 08:35:40,921 - phase-viz - INFO - cleanup_all_html_files:154 - Cleaned up HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083452_3n3r4uy7.html
2025-05-27 08:35:43,970 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:53 - Loading directory: examples/DLN_checkpoints
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:54 - Model file: examples/DLN.py
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:55 - Class name: DLN
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:35:43,971 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:35:46,572 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:35:46,572 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:35:46,572 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:35:46,713 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:35:46,714 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:35:49,390 - phase-viz - INFO - plot_metric:129 - User input: l2
2025-05-27 08:35:49,390 - phase-viz - INFO - plot_metric:212 - Added metric: L2 Norm
2025-05-27 08:35:49,913 - phase-viz - INFO - plot_metric:129 - User input: done
2025-05-27 08:35:49,913 - phase-viz - INFO - plot_metric:221 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 08:35:49,913 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:35:49,975 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:35:50,013 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:35:50,013 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:35:50,014 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:35:50,014 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,014 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,014 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,014 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,604 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,604 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,604 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083550_dw23s35s.html
2025-05-27 08:35:50,604 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:36:02,681 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:36:02,682 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:36:02,682 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:36:02,817 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:36:02,817 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:36:03,831 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 08:36:03,831 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:36:06,542 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:36:06,544 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:36:06,545 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:36:06,545 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:36:06,545 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:06,545 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:06,545 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:06,545 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:15,424 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:15,425 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:15,425 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083606_0qvepc5y.html
2025-05-27 08:36:15,425 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:36:24,361 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:53 - Loading directory: examples/grokking_checkpoints
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:54 - Model file: examples/grokking.py
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:55 - Class name: MLP
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:68 - Found 5 checkpoints
2025-05-27 08:36:24,362 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:36:26,855 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:36:26,856 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:36:26,856 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:36:26,998 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:36:26,998 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:36:28,161 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 08:36:28,161 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 08:36:28,822 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:36:28,871 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:36:28,871 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:36:28,871 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:36:28,871 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:28,872 - phase-viz - INFO - start:240 - Started cleanup server on port 8002 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:28,872 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8002 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:28,872 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:37,624 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:37,624 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:37,624 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083628_8wpi9r9t.html
2025-05-27 08:36:37,624 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 08:37:48,209 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:37:54,806 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:37:54,806 - phase-viz - INFO - load_dir:53 - Loading directory: ../checkpoints
2025-05-27 08:37:54,807 - phase-viz - INFO - load_dir:54 - Model file: arithemtic.py
2025-05-27 08:37:54,807 - phase-viz - INFO - load_dir:55 - Class name: ArithmeticNet
2025-05-27 08:38:08,513 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:53 - Loading directory: ../checkpoints
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:54 - Model file: arithmetic.py
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:55 - Class name: ArithmeticNet
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:68 - Found 4 checkpoints
2025-05-27 08:38:08,514 - phase-viz - INFO - load_dir:81 - State saved successfully
2025-05-27 08:38:11,388 - phase-viz - INFO - <module>:296 - Starting phase-viz CLI
2025-05-27 08:38:11,389 - phase-viz - INFO - plot_metric:93 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 08:38:11,389 - phase-viz - INFO - plot_metric:96 - State loaded successfully
2025-05-27 08:38:11,530 - phase-viz - WARNING - plot_metric:104 - CUDA requested but not available, falling back to CPU
2025-05-27 08:38:11,530 - phase-viz - INFO - plot_metric:114 - Running on CPU
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:129 - User input: all
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: L2 Norm
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Entropy
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Connectivity
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Parameter Variance
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Layer Wise Norm Ratio
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Activation Capacity
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Dead Neuron Percentage
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Rank
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Gradient Flow Score
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Effective Rank
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Avg Condition Number
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Flatness Proxy
2025-05-27 08:38:12,881 - phase-viz - INFO - plot_metric:200 - Added metric: Mean Weight
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Skew
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Kurtosis
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Isotropy
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Weight Norm
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Spectral Norm
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Participation Ratio
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Sparsity
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:200 - Added metric: Max Activation
2025-05-27 08:38:12,882 - phase-viz - INFO - plot_metric:221 - Starting calculation of 21 metrics across 4 checkpoints
2025-05-27 08:38:12,882 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 4 processes on CPU
2025-05-27 08:38:18,049 - phase-viz - INFO - plot_metric:253 - Successfully computed all metrics
2025-05-27 08:38:18,102 - phase-viz - INFO - plot_metric:263 - Cleared model and metric caches
2025-05-27 08:38:18,102 - phase-viz - INFO - plot_metric:266 - Saved metrics data to state
2025-05-27 08:38:18,102 - phase-viz - INFO - plot_metric:276 - Generating interactive plot
2025-05-27 08:38:18,102 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:18,102 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:18,102 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:18,103 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:25,527 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:25,527 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:25,528 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_083818_uevwuacr.html
2025-05-27 08:38:25,528 - phase-viz - INFO - plot_metric:283 - Plot generation completed
2025-05-27 13:08:17,970 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:08:17,971 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:08:17,971 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:08:17,971 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:08:29,342 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:08:29,343 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:08:29,343 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:08:29,343 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:08:29,482 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:08:29,483 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:08:44,379 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:08:44,379 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:08:44,379 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:08:44,518 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:08:44,518 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:08:46,060 - phase-viz - INFO - plot_metric:128 - User input: l2
2025-05-27 13:08:46,060 - phase-viz - INFO - plot_metric:211 - Added metric: L2 Norm
2025-05-27 13:08:47,586 - phase-viz - INFO - plot_metric:128 - User input: done
2025-05-27 13:08:47,586 - phase-viz - INFO - plot_metric:220 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 13:08:47,587 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/20000.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/0.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/40000.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/final.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,629 - phase-viz - ERROR - _process_checkpoint_cpu:229 - Worker error on examples/transformer_checkpoints/30000.pt: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
Traceback (most recent call last):
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 219, in _process_checkpoint_cpu
    checkpoint_results = compute_metric_batch(metric_funcs, path, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/metrics.py", line 171, in compute_metric_batch
    model = load_model_from_checkpoint(checkpoint_path, device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 425, in load_model_from_checkpoint
    model = initialize_model_with_config(_model_class, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sam/Documents/phase-viz/phase-viz/src/load_models.py", line 349, in initialize_model_with_config
    raise RuntimeError(
RuntimeError: Failed to initialize GrokkingMLP. Available config: {}, Model parameters: ['self', 'cfg']
2025-05-27 13:08:47,639 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:08:47,687 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:08:47,687 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:08:47,687 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:08:47,687 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:08:47,688 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:08:47,688 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:08:47,688 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:09:22,415 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:09:22,415 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:09:22,415 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_130847_u27hf6vy.html
2025-05-27 13:09:22,415 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 13:13:16,871 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:13:16,871 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:13:16,871 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:13:16,871 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:13:17,010 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:13:17,010 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:13:23,164 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:13:23,164 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:13:23,165 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:13:23,302 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:13:23,302 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:13:24,578 - phase-viz - INFO - plot_metric:128 - User input: l3
2025-05-27 13:13:24,578 - phase-viz - WARNING - plot_metric:216 - Unknown metric: l3
2025-05-27 13:13:25,691 - phase-viz - INFO - plot_metric:128 - User input: l2
2025-05-27 13:13:25,692 - phase-viz - INFO - plot_metric:211 - Added metric: L2 Norm
2025-05-27 13:13:27,157 - phase-viz - INFO - plot_metric:128 - User input: done
2025-05-27 13:13:27,157 - phase-viz - INFO - plot_metric:220 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 13:13:27,157 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:13:27,208 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:13:27,257 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:13:27,258 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:13:27,258 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:13:27,258 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:27,258 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:27,258 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:27,258 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:48,371 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:48,371 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:48,372 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_131327_d0wv7x0h.html
2025-05-27 13:13:48,372 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 13:20:57,295 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:20:57,296 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:20:57,296 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:20:57,296 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:20:57,297 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:20:57,297 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:21:04,351 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:21:04,352 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:21:04,352 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:21:04,490 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:21:04,490 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:21:05,034 - phase-viz - INFO - plot_metric:128 - User input: l2
2025-05-27 13:21:05,034 - phase-viz - INFO - plot_metric:211 - Added metric: L2 Norm
2025-05-27 13:21:06,604 - phase-viz - INFO - plot_metric:128 - User input: done
2025-05-27 13:21:06,604 - phase-viz - INFO - plot_metric:220 - Starting calculation of 1 metrics across 5 checkpoints
2025-05-27 13:21:06,605 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:21:06,743 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:21:06,810 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:21:06,811 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:21:06,811 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:21:06,811 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:06,811 - phase-viz - INFO - start:240 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:06,811 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8000 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:06,811 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:12,458 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:12,459 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:12,459 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132106_nbgkckxd.html
2025-05-27 13:21:12,459 - phase-viz - INFO - plot_metric:282 - Plot generation completed
2025-05-27 13:21:19,349 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:21:19,349 - phase-viz - INFO - load_dir:52 - Loading directory: examples/transformer_checkpoints
2025-05-27 13:21:19,349 - phase-viz - INFO - load_dir:53 - Model file: examples/transformer_grokking.py
2025-05-27 13:21:19,349 - phase-viz - INFO - load_dir:54 - Class name: GrokkingMLP
2025-05-27 13:21:19,350 - phase-viz - INFO - load_dir:67 - Found 5 checkpoints
2025-05-27 13:21:19,350 - phase-viz - INFO - load_dir:80 - State saved successfully
2025-05-27 13:21:24,862 - phase-viz - INFO - <module>:295 - Starting phase-viz CLI
2025-05-27 13:21:24,863 - phase-viz - INFO - plot_metric:92 - Starting plot-metric command with device=cuda, parallel=True
2025-05-27 13:21:24,863 - phase-viz - INFO - plot_metric:95 - State loaded successfully
2025-05-27 13:21:25,003 - phase-viz - WARNING - plot_metric:103 - CUDA requested but not available, falling back to CPU
2025-05-27 13:21:25,003 - phase-viz - INFO - plot_metric:113 - Running on CPU
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:128 - User input: all
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: L2 Norm
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Entropy
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Layer Connectivity
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Parameter Variance
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Layer Wise Norm Ratio
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Activation Capacity
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Dead Neuron Percentage
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Rank
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Gradient Flow Score
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Effective Rank
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Avg Condition Number
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Flatness Proxy
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Mean Weight
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Skew
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Kurtosis
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Isotropy
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Weight Norm
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Spectral Norm
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Participation Ratio
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Sparsity
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:199 - Added metric: Max Activation
2025-05-27 13:21:25,957 - phase-viz - INFO - plot_metric:220 - Starting calculation of 21 metrics across 5 checkpoints
2025-05-27 13:21:25,957 - phase-viz - INFO - compute_metrics_over_checkpoints:324 - Using ProcessPoolExecutor with 5 processes on CPU
2025-05-27 13:21:26,452 - phase-viz - INFO - plot_metric:252 - Successfully computed all metrics
2025-05-27 13:21:26,464 - phase-viz - INFO - plot_metric:262 - Cleared model and metric caches
2025-05-27 13:21:26,464 - phase-viz - INFO - plot_metric:265 - Saved metrics data to state
2025-05-27 13:21:26,465 - phase-viz - INFO - plot_metric:275 - Generating interactive plot
2025-05-27 13:21:26,465 - phase-viz - INFO - register_html_for_cleanup:139 - Registered HTML file for cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:21:26,465 - phase-viz - INFO - start:240 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:21:26,465 - phase-viz - INFO - plot_metric_interactive:79 - Started cleanup server on port 8001 for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:21:26,465 - phase-viz - INFO - plot_metric_interactive:1817 - Created HTML file: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:22:25,184 - phase-viz - INFO - unregister_html_from_cleanup:145 - Unregistered HTML file from cleanup: /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:22:25,185 - phase-viz - INFO - do_POST:197 - Browser requested cleanup of /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:22:25,185 - phase-viz - INFO - plot_metric_interactive:1826 - Cleanup completed for /home/sam/Documents/phase-viz/phase-viz/src/metrics_over_checkpoints_20250527_132126_13dnwnzn.html
2025-05-27 13:22:25,185 - phase-viz - INFO - plot_metric:282 - Plot generation completed
